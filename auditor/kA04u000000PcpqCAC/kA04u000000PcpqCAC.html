<?xml version="1.0" encoding="UTF-8"?>
<html>
  <head>
    <meta charset="utf-8" />
    <title>How to disable outgoing NTLM authentication traffic</title>
    <meta name="label" content="auditor" />
    <meta name="label" content="ct_monitoringplans" />
    <meta name="label" content="employees_v" />
    <meta name="label" content="skb" />
    <meta name="KnowledgeArticleId" content="kA04u000000PcpqCAC" />
    <meta name="Id" content="ka04u000000HdEUAA0" />
    <meta name="LastPublishedDate" content="2021-11-12T12:14:38.000+0000" />
    <meta name="LastModifiedDate" content="2023-05-08T10:19:32.000+0000" />
    <meta name="FirstPublishedDate" content="2020-07-20T11:56:08.000+0000" />
    <meta name="Language" content="en_US" />
    <meta name="UrlName" content="5807" />
    <meta name="ArticleNumber" content="000005807" />
    <meta name="description" content="How to disable outgoing NTLM authentication traffic" />
  </head>
  <body>
    <article class="kb-articles">
      <div class="Content__c">
        Security researches revealed that NTLM and NTLMv2 authentication is vulnerable to a variety
        of malicious attacks, including SMB replay, man-in-the-middle attacks, and brute force
        attacks. To make the Windows operating system use more secure protocols (e.g. Kerberos
        version 5), it is recommended to disable outgoing NTLM authentication traffic for the
        machine where you plan to deploy Netwrix products. (See also
        <a
          href="https://docs.microsoft.com/en-us/windows/win32/secauthn/microsoft-negotiate"
          target="_blank"
          >this Microsoft article</a
        >.)<br />For that, you will need to set the<b>
          Network Security: Restrict NTLM: Outgoing NTLM traffic to remote servers</b
        >
        policy setting to <b>Deny All</b>Â for the target machine. This can be done locally on the
        target machine, or via Group Policy.
        <p><b>To disable outgoing NTLM authentication traffic locally:</b></p>
        1. Run <i>secpol.msc</i>.<br />2. Browse to
        <b>Security Settings\Local Policies\Security Options</b>.<br />3. Set the
        <b>Network Security: Restrict NTLM: Outgoing NTLM traffic to remote servers</b> setting to
        <b>Deny All</b>.

        <p><b>To disable outgoing NTLM authentication traffic via Group Policy:</b></p>
        1. Open <i>gpmc.msc</i>.<br />2. Find the Group Policy Object (GPO) that is applied to the
        target machine.<br />3. Edit this GPO. Browse to
        <b
          >Computer Configuration\Windows Settings\Security Settings\Local Policies\Security
          Options</b
        >.<br />4. Set the
        <b>Network Security: Restrict NTLM: Outgoing NTLM traffic to remote servers</b> setting to
        <b>Deny All</b>.<br />5. On the target machine, run the following command via the command
        prompt: <span>gpupdate /force</span>
      </div>
    </article>
  </body>
</html>
