<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>How to Configure Local Administrator Password Solution (LAPS) Integration</title><meta name="label" content="skb"/><meta name="label" content="privilege_secure"/><meta name="KnowledgeArticleId" content="kA04u0000000HbRCAU"/><meta name="Id" content="ka04u000000Hca2AAC"/><meta name="LastPublishedDate" content="2021-11-18T15:22:42.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T09:57:49.000+0000"/><meta name="FirstPublishedDate" content="2021-11-18T15:22:42.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="5924"/><meta name="ArticleNumber" content="000005924"/><meta name="description" content="How to Configure Local Administrator Password Solution (LAPS) Integration"/></head><body><article class=" kb-articles"><div class="Content__c"><h2 id="summary">Summary</h2>
This article outlines how to integrate SbPAM activities with the Microsoft Local Administrator Password Solution (LAPS) solution, enabling SbPAM activities to access Windows resources using the built-in Administrator being managed by LAPS.

<h2 id="instructions">Instructions</h2>
LAPS should already be installed on the desired Windows workstations and servers. It's presumed these computers are located in specific Organizational Units (OUs) in Active Directory.<br/><br/>A service account will need to be created, or an existing account can be used, that will be used by SbPAM to integrate with LAPS. This service account will need the ability to read and reset LAPS passwords, delegated via the following PowerShell cmdlets from Microsoft (available via the <a href="https://www.microsoft.com/en-us/download/details.aspx?id=46899" target="_blank">LAPS UI fat client installer</a>):<br/> 
<pre class="ckeditor_codeblock">Set-AdmPwdReadPasswordPermission -OrgUnit "&lt;laps_ou&gt;" -AllowedPrincipals "&lt;service_account&gt;"</pre>

<pre class="ckeditor_codeblock">Set-AdmPwdResetPasswordPermission -OrgUnit "&lt;laps_ou&gt;" -AllowedPrincipals "&lt;service_account&gt;"</pre>
<br/>In the commands above, &lt;laps_ou&gt; should be replaced with the OU containing the computers being managed by LAPS, and &lt;service_account&gt; should be replaced by the service account that will be used during LAPS integration configuration in SbPAM.<br/><br/>For example, if all computers managed by LAPS are in a "LAPS PCs" OU in Active Directory, and the desired service account is "svc_sbpam@lab.local", then the commands would look like:<br/> 
<pre class="ckeditor_codeblock">Set-AdmPwdReadPasswordPermission -OrgUnit "LAPS PCs" -AllowedPrincipals "lab\svc_sbpam"</pre>

<pre class="ckeditor_codeblock">Set-AdmPwdResetPasswordPermission -OrgUnit "LAPS PCs" -AllowedPrincipals "lab\svc_sbpam"</pre>
<br/>The LAPS integration can now be configured in SbPAM.<br/><br/>Log-in to SbPAM as an admin. If the service account used in the LAPS PowerShell commands has not been added to SbPAM, then that will be the first step via <b>Configuration &gt; Service Accounts</b>.<br/><br/>Next, navigate to <b>Configuration &gt; Integration Connectors</b>. Create a new connector, and select <b>LAPS</b> from the <b>Connector Template </b>dropdown. Select the service account that has read and reset permissions for the LAPS OU(s) from the <b>ServiceAccount</b> dropdown. Finally, add the <b>DomainName</b> (ex. lab.local) and click <b>Save</b>.<br/><br/><img alt="Screenshot demonstrating LAPS connector configuration in SbPAM's web application interface." height="233" src="kA04u0000000HbRCAU_e19e5513-a133-4859-9dcf-bb58ec0a37e4.png" width="500"/><br/><br/>Next, navigate to <b>Activities</b> so an activity can be created that provides built-in Administrator access to a Windows resource that's managed by LAPS.<br/><br/>Create a new activity and change the <b>Login Account</b> dropdown to <b>Vault</b>. For the <b>Vault Connector</b>, select the name of the LAPS connector create in the previous step. Finally, set the <b>Platform </b>to <b>Windows</b> and make sure the <b>Login Account Template</b> matches the expected built-in admin account name (in most cases this will be the default value of "Administrator").<br/><br/><img alt="Screenshot demonstrating an SbPAM activity definition that's configured to use a LAPS connector." height="259" src="kA04u0000000HbRCAU_dbbf8513-45d2-4650-9649-918a47f66fc2.png" width="500"/><br/><br/>Add any other desired actions to the activity. The last step is to create an <b>Access Policy</b> that determines which SbPAM users can provision this activity session for which resources. Simply create as many <b>Access Policies</b> as desired with combinations of SbPAM users, the previously created LAPS activity, and Windows resources managed by LAPS.<br/><br/>The LAPS activity can now be provisioned by users added to the aforementioned <b>Access Policies</b>, which will allow users to RDP to Windows resources managed by LAPS as the built-in admin account.<br/><br/>When a LAPS-integrated session ends, SbPAM will trigger a password rotation via LAPS, ensuring the built-in admin account for the accessed resource is secure.</div>
</article></body></html>