<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Add  Microsoft Entra ID as an Authentication Connector (SAML)</title><meta name="label" content="privilege_secure"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000HRHCA2"/><meta name="Id" content="ka0Qk0000003IQDIA2"/><meta name="LastPublishedDate" content="2023-12-12T11:19:11.000+0000"/><meta name="LastModifiedDate" content="2024-04-30T08:31:03.000+0000"/><meta name="FirstPublishedDate" content="2021-10-12T13:39:23.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="5911"/><meta name="ArticleNumber" content="000005911"/><meta name="description" content="Add Azure Active Directory as an Authentication Connector (SAML)"/></head><body><article class=" kb-articles"><div class="Content__c"><h2 id="summary">Summary</h2>

<p>This article outlines the process of adding Microsoft Entra ID (formerly Azure AD) to Privilege Secure as an Authentication Connector via SAML. The article is split into two sections, <em><a href="#Steps-for-Azure"><strong>Steps for Microsoft Entra ID</strong></a> </em>and <em><a href="#Steps-for-SbPAM"><strong>Steps for Privilege Secure</strong></a>. </em>The Azure section must be completed first.</p>

<h2 id="instructions">Instructions</h2>

<h3 id="Steps-for-Azure">Steps for Microsoft Entra ID</h3>

<ol><li>In a web browser, navigate to <a href="https://portal.azure.com/" target="_blank">https://portal.azure.com/</a> and sign-in as an admin. You'll need to create an Enterprise Application and gather several pieces of information to complete the Privilege Secure <strong>Configuration Wizard </strong>steps later in this article.</li><li>In Azure, click <strong>Azure Active Directory</strong> from the left sidebar. Then, click <strong>Enterprise Applications</strong> from the left sidebar.<br/>	 </li><li>Click <strong>New Application </strong>near the top of the <strong>Enterprise Applications</strong> page, followed by <strong>Create Your Own Application</strong> on the page that follows.<br/>	<br/>	Give the app any name, and set the radio button to <strong>Integrate any other application you don't find in the gallery (Non-gallery)</strong>. Click <strong>Create</strong>.<br/>	<br/>	<img alt="User-added image" height="220" src="kA04u0000000HRHCA2_e81704d1-6f77-44bb-85d3-a99ee6173bd5.png" width="500"/></li><li>You'll be redirected to the new app's <strong>Overview</strong> page.<br/>	<br/>	In the left sidebar, select <strong>Single sign-on, </strong>then select <strong>SAML</strong>.<br/>	<br/>	<img alt="User-added image" height="192" src="kA04u0000000HRHCA2_c0a1946a-7b57-4902-a529-556859fd6162.png" width="500"/><br/>	 </li><li>For Step 1 in this wizard (<strong>Basic SAML Configuration</strong>), click <strong>Edit</strong>.<br/>	<br/>	Change the <strong>Identifier (Entity ID)</strong> to <strong>sbpamsaml.stealthbits.com</strong>, and set it to be the default.<br/>	<br/>	For the <strong>Reply URL (Assertion Consumer Service URL), </strong>use the following URL (changing the hostname to the hostname used to access Privilege Secure via a web browser):<br/>	 
	<pre>https://&lt;sbpam-hostname&gt;:6500/samlSigninCallback</pre>
	<br/>	<img alt="User-added image" height="179" src="kA04u0000000HRHCA2_0731788c-5409-4023-89a2-232eb73a431a.png" width="500"/><br/>	<br/>	Click <strong>Save </strong>after making changes, and then close the editor for <strong>Basic SAML Configuration</strong>.<br/>	 </li><li>Scroll down to section 3, and download the <strong>Certificate (Base64)</strong>.<br/>	<br/>	<img alt="User-added image" height="190" src="kA04u0000000HRHCA2_dfc64c1e-3d51-4ea4-acf3-9d09374bb5a7.png" width="500"/><br/>	 </li><li>Scroll down to section 4, and copy the <strong>Login URL </strong>for later use.<br/>	<br/>	<img alt="User-added image" height="101" src="kA04u0000000HRHCA2_858888c4-bf7c-4ab2-952c-d51fa6d86f01.png" width="500"/><br/>	 </li><li>In the left sidebar, click on <strong>Users and Groups</strong>. Add an Microsoft Entra ID user to this page (<strong>Add user/group</strong> button near the top).<br/>	<br/>	This user should be accessible to whoever will complete the <a href="#h_01F9CMXKQER3T8AYNJYHK01WCB" target="_self"><em><strong>Steps for Privilege Secure</strong></em></a>, as they need to be able to log-in to this user to complete the Authentication Connector Configuration Wizard for SAML in Privilege Secure.</li><li>Sign-out of Microsoft Entra ID.</li><li>At this point, you should have the following pieces of information for use in the <a href="#h_01F9CMXKQER3T8AYNJYHK01WCB" target="_self"><em><strong>Steps for Privilege Secure</strong></em></a><em>:</em><br/>	<br/>	<strong>- Certificate (Base64)</strong><br/>	<strong>- Login URL</strong><br/>	<strong>- Microsoft Entra ID user</strong> (associated with the Enterprise Application and can be logged-in to by whoever will complete the Privilege Secure portion of this article)</li></ol>

<h3 id="Steps-for-SbPAM">Steps for Privilege Secure</h3>

<ol><li>As a Privilege Secure Admin, navigate in Privilege Secure to <strong>Configuration &gt; Authentication</strong>, and click the green <strong>"+" </strong>button to add a new Authentication Connector.<br/>	 </li><li>Give the new connector a name, description (optional), and a Connector Type of "SAML".<br/>	<br/>	<img alt="User-added image" height="151" src="kA04u0000000HRHCA2_9c8db3a3-042c-4c11-ae38-950d5c4e9b08.png" width="500"/><br/>	 </li><li>Click on <strong>Configuration Wizard</strong>.<br/>	 </li><li>On the <strong>Configure Client </strong>page of that wizard, use the <strong>Login URL </strong>in the <strong>Signin URI </strong>field (the <strong>Login URL</strong> was obtained in the <a href="#h_01F9CMY2Q31PEQEY3CZC2274Z0" target="_self"><em><strong>Steps for Microsoft Entra ID</strong></em></a>). All fields should now be filled in.<br/>	<br/>	<img alt="User-added image" height="205" src="kA04u0000000HRHCA2_10f43640-5ca1-4319-ae60-d49ca66b3ed1.png" width="500"/><br/>	 </li><li>Click <strong>Test Connection</strong>.<br/>	<br/>	On the page that loads (Microsoft Entra ID sign-in page), <span class="wysiwyg-color-red110"><strong>DO NOT SIGN-IN</strong></span>. Instead, once you've verified that the sign-in page loaded property, click the back button in the browser to return to Privilege Secure (the connection test was successful if Microsoft Entra ID didn't display an error).</li><li>Click <strong>Next </strong>to advance in the Authentication Connector Configuration Wizard. You'll now be on the wizard's <strong>Test Login </strong>page.<br/>	 </li><li>Open the certificate obtained during the <a href="#h_01F9CMY2Q31PEQEY3CZC2274Z0" target="_self"><em><strong>Steps for Microsoft Entra ID</strong></em></a>. Copy the text between <strong>-----BEGIN CERTIFICATE-----</strong> and <strong>-----END CERTIFICATE-----</strong> into the <strong>Certificate </strong>field in the Authentication Connector Configuration Wizard.<br/>	 </li><li>Click <strong>Login</strong>, and log-in as the Microsoft Entra ID user associated with the Enterprise Application from Step 8 in the <a href="#h_01F9CMY2Q31PEQEY3CZC2274Z0" target="_self"><em><strong>Steps for Microsoft Entra ID</strong></em></a>. Upon successful sign-in, you'll be redirected back to the wizard in Privilege Secure.<br/>	<br/>	If the sign-in was successful, the Provider User Name/Id will display. This is passed to the UserTokenController so that the user information can be extracted. Click <strong>Next</strong>.</li><li>You will now be on the <strong>Configure Id Mapping</strong> page.<br/>	<br/>	SpPAM will use the access token to retrieve user data from the SAML provider. The SAML provider requires a User Id Field for sign-in. It is necessary to specify which field in Active Directory should map to that User Id Field, so that Privilege Secure can automatically fill in the required credentials at log-in. The value provided is used to sign-in to the multi-factor authenticator (MFA) when a user logs-in to the Privilege Secure Console.<br/>	<br/>	The table displays the retrieved data that can be used for the host user lookup. The user must select from the displayed records a field that corresponds to a value in their AD configuration. For example, if the AD data contains email addresses, they can select any of the fields which contain email addresses.<br/>	<br/>	<strong>In simple terms, there needs to be a property for each user in on-prem Active Directory and Microsoft Entra ID that matches. Often, this is an email address.</strong><br/>	<br/>	<img alt="User-added image" height="194" src="kA04u0000000HRHCA2_a64c7549-32ee-44d8-a0d7-837c48432c22.png" width="500"/><br/>	<br/>	<span class="wysiwyg-color-black">Once the desired field has been found, click on it and then click <strong>Select </strong>(you may need to scroll down in the modal to see this button).</span></li><li><span class="wysiwyg-color-black">You will now be back in the Authentication Connector Configuration Wizard, on the <strong>Configure Id Mapping </strong>page. Make sure the <strong>Login Format</strong> dropdown is for a format that will match the ID Token field selected from Microsoft Entra ID in the previous step.<br/>	<br/>	For example, if you chose <strong>Email</strong> for the field in the previous step then this dropdown should also be <strong>Email Address</strong>.<br/>	<br/>	<img alt="User-added image" src="kA04u0000000HRHCA2_388f49f3-da11-4e48-9704-e0e924901362.png"/></span></li><li><span class="wysiwyg-color-black">Click <strong>Next</strong>. On the next page, enter the following for the <strong>Signout URI</strong>:</span><br/>	 
	<pre>https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri</pre>
	<br/>	Click <strong>Test Log Out</strong> to sign out of the SAML provider. If the log out was performed correctly, click <strong>Finish </strong>then <strong>Okay</strong>, otherwise confirm the settings and try again.<br/>	<br/>	<img alt="User-added image" src="kA04u0000000HRHCA2_facd3e04-fdb6-4f95-86f3-0f298a9040b2.png"/><br/>	 </li><li><span class="wysiwyg-color-black">You can now assign this authentication connector to a user via the <strong>Authentication Connector </strong>tab for a user accessed in Privilege Secure's <strong>Users &amp; Groups</strong> page.<br/>	<br/>	<img alt="User-added image" height="235" src="kA04u0000000HRHCA2_b1725b9e-afc0-43b3-bf29-43d64be92e42.png" width="500"/><br/>	<br/>	Users with this authentication connector assignment can now use this authentication connector option on the Privilege Secure log-in screen.<br/>	<br/>	<img alt="User-added image" src="kA04u0000000HRHCA2_dad667ea-e132-4764-8d12-6cb08bc99fbb.png"/><br/>	<br/>	When using the SAML log-in option, the user will be redirected to sign-in to Microsoft Entra ID. Upon successful authentication, the user will be redirected to the Privilege Secure UI as their now signed-in user.</span></li></ol></div>
</article></body></html>