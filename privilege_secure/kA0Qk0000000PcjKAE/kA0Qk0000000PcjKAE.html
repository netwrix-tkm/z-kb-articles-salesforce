<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Onboarding Mac devices for VNC via RDS (Remote Desktop Services)</title><meta name="label" content="privilege_secure"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA0Qk0000000PcjKAE"/><meta name="Id" content="ka0Qk0000006UkzIAE"/><meta name="LastPublishedDate" content="2024-10-10T20:51:19.000+0000"/><meta name="LastModifiedDate" content="2024-10-10T20:51:19.000+0000"/><meta name="FirstPublishedDate" content="2024-01-24T23:53:18.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="9021"/><meta name="ArticleNumber" content="000009021"/><meta name="description" content="Onboarding Mac devices for VNC via RDS (Remote Desktop Services)"/></head><body><article class=" kb-articles"><div class="Content__c"><h2 id="overview">Overview</h2>
This article provides instructions for onboarding MacOS devices into Netwrix Privilege Secure (NPS) so that VNC connections can be established by way of an RDS server. The VNC session will leverage RealVNC, run as a RemoteApp. The target resource will automatically be selected, and the user will enter credential information as part of the login process.<br/><br/><strong><em>Note: This article applies only for Privilege Secure 4.2 or higher, as it requires the %token% variable for the "Application to Launch" activity setting.<br/><br/>Note: The nps_realvnc file used in these instructions must be obtained from Netwrix Support.</em></strong>

<h2 id="before_you_begin">Before You Begin</h2>

<p>Ensure that VNC access to the target host works. <a href="https://support.apple.com/en-au/guide/remote-desktop/apdbed09830/mac" target="_blank">This documentation</a> offers some general instructions.</p>

<h2 id="instructions">Instructions</h2>

<h3 id="creating_the_macos_platform">Creating the macOS Platform</h3>

<p>    1. In Netwrix Privilege Secure, navigate to the Policy &gt; Platforms page.<br/>    2. Select the "Windows" platform, and click the Copy icon.<br/><img alt="001.png" src="kA0Qk0000000PcjKAE_8ce8c995-9242-4394-969f-cffb5dc237eb.png"/><br/>    3. Change the name of the new platform to "macOS". Ensure that the schedules are all set to "&lt;none&gt;". Then click "Save".<br/><img alt="002.png" src="kA0Qk0000000PcjKAE_a151636b-54f1-48e0-a47e-17b424774d42.png"/><br/> </p>

<h3 id="creating_service_accounts">Creating Service Accounts</h3>

<p>    1. On the "Configuration &gt; Service Accounts" page, click the "+" icon and create a "macOS" service account. Note that the username and password do not matter - the macOS devices cannot be scanned, but a service account must be supplied to onboard the macOS resources.<br/><img alt="003.png" src="kA0Qk0000000PcjKAE_02ee98df-1364-40c4-b2d9-cf9c8cc07811.png"/></p>

<h3 id="onboarding_macos_resources"><br/>Onboarding macOS Resources</h3>

<p>   1. Navigate to "Resources". Click the "Add" button, and click "New Server". On the "Add Resources" page, click the "Import from CSV" radio button, and click the "Download CSV Template" button. This will download a CSV template, which you can then populate with macOS resources, as in this example - <br/><img alt="004.png" src="kA0Qk0000000PcjKAE_9ea9ef86-73f2-4f9e-90a5-d3e13eb812a7.png"/><br/>    2. Note that it is crucial that the Platform exactly matches the Platform configured earlier, and that the Credential exactly matches the Service Account name configured earlier. The Operating System value is for informational purposes only, and will not be matched to any other values.<br/>    3. Return to the "Add Resources" page in step 1 of this section. Click the "Import CSV" button and upload the CSV file that was just configured. The resources will be displayed on the Add Resources page.<br/><img alt="005.png" src="kA0Qk0000000PcjKAE_e6c606f0-0626-4153-8344-6689f9236852.png"/><br/>    4. Select the desired resources (the Select All checkbox may be used) and click "Add".<br/>    5. The dialogue will show that a scan is Pending on all of the resources - this scan will end in an Error. This is expected as macOS cannot be scanned by NPS, and this error will only occur during initial onboarding.<br/><img alt="006.png" src="kA0Qk0000000PcjKAE_c7a27db4-d62e-4f7f-b1dc-a56048a682eb.png"/><br/>    6. Navigate to the Resources page and observe that the onboarded macOS resources are present.<br/><img alt="007.png" src="kA0Qk0000000PcjKAE_8e3ade81-79fa-4293-a5f1-895fff9f17ba.png"/><br/> </p>

<h3 id="registering_the_npsrealvnc_remoteapp">Registering the nps_realvnc RemoteApp</h3>

<p>    1. Copy the nps_realvnc.zip file to the desktop of the RDS host where the RemoteApp will be published. Copy the contents to a folder where they can be accessed, for example "C:\npslaunchers".<br/><img alt="Picture8.png" src="kA0Qk0000000PcjKAE_219eeff8-098f-46da-a634-3a0875d98ff2.png"/><br/>    2. Edit the appsettings.json file and specify the address(es) of your NPS App Server(s).<br/><img alt="Picture9.png" src="kA0Qk0000000PcjKAE_e4baf2fc-3465-4455-8841-e491ddb1156c.png"/><br/>    3. Open Server Manager on the RDS host where the RemoteApp will be published and select the "Publish RemoteApp Programs" option as indicated.<br/><img alt="Picture10.png" src="kA0Qk0000000PcjKAE_fd636120-de3b-4b4c-9d49-ee7ac6660dda.png"/><br/>    4. Select the indicated option to Add a RemoteApp program<br/><img alt="Picture11.png" src="kA0Qk0000000PcjKAE_c6163581-c7be-4089-811b-d9b97889c530.png"/><br/>    5. Navigate to the location where the nps_realvnc launcher was installed, and publish the RemoteApp.<br/><img alt="Picture12.png" src="kA0Qk0000000PcjKAE_79885471-f4cb-4a58-8efc-9172847111a7.png"/><br/>    6. In Server Manager, right-click the published RemoteApp and select "Edit Properties".<br/><img alt="Picture13.png" src="kA0Qk0000000PcjKAE_1e65c24a-c370-41bb-a93b-c95f78b47b88.png"/><br/>    7. Select "Parameters" and choose "Allow any command-line parameters". The RemoteApp will be published.<br/><img alt="Picture14.png" src="kA0Qk0000000PcjKAE_c02f2bd4-3232-4361-8c47-404a0d9377b8.png"/></p>

<h3 id="creating_an_activity_for_vnc_access">Creating an Activity for VNC Access</h3>

<p>    1. Navigate to the Activities page and click the "+" icon to create a new Activity. The "Activity Type" of this activity must be set to "Interactive App Launch", as this will allow VNC sessions to be launched through the realvnc.exe launcher configured in RDS.<br/>    2. Ensure that the following values are configured:</p>

<ul><li>Activity Type - Interactive App Launch </li><li>Login Account Template – the account that will be used to connect to the RDS host, <em>not</em> the target macOS resource. Be sure to specify a domain, as %targetdomain% will not always work. (For example, mydomain\managedaccountname)</li><li>Application to Launch – Specify the same path and filename you used to publish the RemoteApp, and append the %token% and %sessionid% parameters. For example:</li></ul>

<pre class="ckeditor_codeblock">C:\npslaunchers\nps_realvnc.exe %token% %sessionid%</pre>

<p>    3. If the above steps have been followed, your activity configuration should resemble the following:<br/><img alt="Picture15.png" src="kA0Qk0000000PcjKAE_0eff46c4-750f-45ad-81d1-db069a13cfed.png"/></p>

<h3 id="running_the_activity">Running the Activity</h3>

<p>    1. Once your Activity is created and added to an access policy containing your onboarded macOS resources, you can provision a session as normal.<br/>    <img alt="Picture16.png" src="kA0Qk0000000PcjKAE_8e997cae-5e07-4f08-8cfd-2c5f76309f86.png"/><br/><img alt="Picture17.png" src="kA0Qk0000000PcjKAE_321943fe-6586-4566-bf81-6c0794669a48.png"/><br/>    2. Depending on whether you have installed VNC Connect on the MAC device, you may get a warning similar to the following:<br/><img alt="Picture18.png" src="kA0Qk0000000PcjKAE_4f00aa8f-7b90-4cb3-b4d9-90c2f3431ce3.png"/><br/>    3. Enter your credentials when prompted.<br/><img alt="Picture20.png" src="kA0Qk0000000PcjKAE_c4a0e149-4a41-462b-b7c0-3764ba284364.png"/><br/>    4. A VNC connection will now be established to the resource, and the session will be recorded by the NPS proxy service.<br/><img alt="Picture21.png" src="kA0Qk0000000PcjKAE_71a416be-3e31-4b1e-ad5b-b06ff06a5369.png"/></p></div>
</article></body></html>