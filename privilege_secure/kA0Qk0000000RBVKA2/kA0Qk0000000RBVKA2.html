<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Exporting and Importing the Database to a New Server</title><meta name="label" content="privilege_secure"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA0Qk0000000RBVKA2"/><meta name="Id" content="ka0Qk0000001hyzIAA"/><meta name="LastPublishedDate" content="2024-02-06T14:18:03.000+0000"/><meta name="LastModifiedDate" content="2024-02-06T14:18:03.000+0000"/><meta name="FirstPublishedDate" content="2024-02-06T14:18:03.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="9044"/><meta name="ArticleNumber" content="000009044"/><meta name="description" content="Exporting and Importing the Database to a New Server"/></head><body><article class=" kb-articles"><div class="Content__c"><h2 id="overview">Overview</h2>
This article outlines the process of exporting your Netwrix Privilege Secure database, and importing it to a new Privilege Secure server.

<p>The data transferred includes:</p>

<ol><li>PostgreSQL Database</li><li>RDP/SSH Recordings</li><li>Configuration files</li><li>Encryption keys</li></ol>

<h2 id="instructions">Instructions</h2>

<h3 id="on_the_new_server">On the new server</h3>
    1. Install Netwrix Privilege Secure on the new server.

<h3 id="user-content-on-existing-server">On the existing server</h3>

<ol><li>Stop the following services on the server by running the indicated PowerShell commands:
	<pre><code>Stop-Service SbPAM* -Force
Stop-Service W3SVC
Stop-Service postgresql-x64-12
</code></pre>
	</li><li>Create an archive of PostgreSQL database by running the indicated command:<br/>	<code>Compress-Archive -Path C:\ProgramData\Stealthbits\Postgres12 -DestinationPath C:\Temp\pg_data.zip -CompressionLevel Optimal</code></li><li>Export the NPS encryption keys, and capture the password generated by the export <em><strong>(note: the keys.exp file created in this step is sensitive and should be deleted after the import is complete)</strong></em>:<br/>	<code>"C:\Program Files\Stealthbits\PAM\KeyTools\SbPAM.RotateKey.exe" export -n c:\temp\keys.exp</code></li><li>Create an archive of the NPS configuration files:<br/>	<code>Compress-Archive -Path C:\ProgramData\Stealthbits\PAM -DestinationPath C:\Temp\nps_config.zip -CompressionLevel Optimal</code></li><li>Copy <code>pg_data.zip</code>, <code>keys.exp</code>, and <code>nps_config.zip</code> to the new server.</li></ol>

<h2 id="user-content-on-new-server">On new server</h2>

<ol><li>Stop the following services on the server by running the indicated PowerShell commands:
	<pre><code>Stop-Service SbPAM* -Force
Stop-Service W3SVC
Stop-Service postgresql-x64-12
</code></pre>
	</li><li>Decompress the configuration files from the original server:<br/>	<code>Expand-Archive -Path c:\temp\nps_config.zip -DestinationPath c:\ProgramData\Stealthbits -Force</code></li><li>Decompress the PostgreSQL files from the original server:<br/>	<code>Expand-Archive -Path C:\temp\pg_data.zip -DestinationPath c:\ProgramData\Stealthbits -Force</code></li><li>Import the key files from the original server <em><strong>(note: the keys.exp file is sensitive and should be deleted after the import is complete)</strong></em>:<br/>	<code>"C:\Program Files\Stealthbits\PAM\KeyTools\SbPAM.RotateKey.exe" import -f -n c:\temp\keys.exp</code></li><li>Start the following services on the server by running the indicatedPowerShell commands:
	<pre><code>Start-Service postgresql-x64-12
Start-Service W3SVC
Start-Service SbPAM* -Force</code></pre>
	</li></ol></div>
</article></body></html>