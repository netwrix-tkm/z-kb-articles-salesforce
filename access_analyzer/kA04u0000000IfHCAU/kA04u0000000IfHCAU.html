<?xml version="1.0" encoding="UTF-8"?>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Common SharePoint On-Prem Scanning Permission Errors</title>
    <meta name="label" content="enterprise_auditor" />
    <meta name="label" content="skb" />
    <meta name="KnowledgeArticleId" content="kA04u0000000IfHCAU" />
    <meta name="Id" content="ka0Qk0000004IKvIAM" />
    <meta name="LastPublishedDate" content="2024-06-20T14:43:48.000+0000" />
    <meta name="LastModifiedDate" content="2024-06-20T14:43:48.000+0000" />
    <meta name="FirstPublishedDate" content="2022-02-01T18:33:25.000+0000" />
    <meta name="Language" content="en_US" />
    <meta name="UrlName" content="7194" />
    <meta name="ArticleNumber" content="000007194" />
    <meta name="description" content="Common SharePoint On-Prem Scanning Permission Errors" />
  </head>
  <body>
    <article class="kb-articles">
      <div class="Content__c">
        <h2 id="overview">Overview</h2>

        <p>
          Getting the permissions right in SharePoint on-premise can be tricky, so here are the
          expected permission-related errors and what you should check when you see them.
        </p>

        <h2 id="instructions">Instructions</h2>

        <p>
          Based on the error, check to make sure that the user has the permission(s) associated with
          it.
        </p>

        <h3 id="spaa_against_sharepoint_20132016">SPAA against SharePoint 2013/2016</h3>
        Â 

        <div class="table-wrap">
          <table count-columns="2" border="1" cellpadding="0" cellspacing="0">
            <thead>
              <tr>
                <th colspan="1" rowspan="1">Missing Permission</th>
                <th colspan="1" rowspan="1">Expected Error</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="1" rowspan="1">Local Group Membership: Backup Operators</td>
                <td colspan="1" rowspan="1">
                  Unable to determine administrative site for (host URL) error accessing remote
                  registry. Requested registry access is not allowed
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">Local Group Membership: WSS_WPG Group</td>
                <td colspan="1" rowspan="1">
                  Unable to negotiate connection to SharePoint database server (host URL): Error:
                  Access is denied
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">Full Read Web Application Policy</td>
                <td colspan="1" rowspan="1">
                  Unable to negotiate connection to farm: Unable to negotiate connection to
                  SharePoint server sbpmlab-sp10
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                  Site Collection Admin on Central Administration Site Collection
                </td>
                <td colspan="1" rowspan="1">
                  Unable to retrieve site collection "URL" Error: Access denied. You do not have
                  permission to perform this action or access this resource.
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">No DB permissions at all</td>
                <td colspan="1" rowspan="1">
                  Unable to negotiate connection to SharePoint database server (host URL): Error
                  Connection Timeout Expired. The timeout period elapsed while attempting to consume
                  the pre-login handshake acknowledgement. This could be because the handshake
                  failed or the server was unable to respond back in time. The duration spent while
                  attempting to connect to this server was - [Pre-Login] initialization=4943;
                  handshake=1768;
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                  SP_DataAccess Role membership on SharePoint Content Databases
                </td>
                <td colspan="1" rowspan="1">
                  Unable to negotiate connection to SharePoint database server (host URL): Error
                  Connection Timeout Expired. The timeout period elapsed while attempting to consume
                  the pre-login handshake acknowledgement. This could be because the handshake
                  failed or the server was unable to respond back in time. The duration spent while
                  attempting to connect to this server was - [Pre-Login] initialization=4943;
                  handshake=1768;
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                  SP_DataAccess Role membership on SharePoint Config Database
                </td>
                <td colspan="1" rowspan="1">
                  Error enumerating ISharePointSiteCollection children of ISharePointWebApplication.
                  The EXECUTE permission was denied on the object 'proc_getSiteNames', database
                  'SharePoint_Config'
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                  Public membership to SharePoint_Config, Owner on the content DB
                </td>
                <td colspan="1" rowspan="1">
                  Unable to negotiate connection to SharePoint database server sbnjqasp01: Error:
                  The EXECUTE permission was denied on the object 'proc_getObject', database
                  'SharePoint_Config', schema 'dbo'
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3 id="spaa_against_sharepoint_2010">SPAA against SharePoint 2010</h3>

        <div class="table-wrap">
          <table count-columns="2" border="1" cellpadding="0" cellspacing="0">
            <thead>
              <tr>
                <th colspan="1" rowspan="1">Missing Permission</th>
                <th colspan="1" rowspan="1">Expected Error</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="1" rowspan="1">Local Group Membership: Backup Operators</td>
                <td colspan="1" rowspan="1">
                  Unable to determine administrative site for (host URL) error accessing remote
                  registry. Requested registry access is not allowed
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">Local Group Membership: WSS_WPG Group</td>
                <td colspan="1" rowspan="1">
                  Unable to negotiate connection to SharePoint database server (host URL): Error:
                  Access is denied
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">Full Read Web Application Policy</td>
                <td colspan="1" rowspan="1">
                  Unable to negotiate connection to farm: Unable to negotiate connection to
                  SharePoint server sbpmlab-sp10
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                  Site Collection Admin on Central Administration Site Collection
                </td>
                <td colspan="1" rowspan="1">
                  Unable to retrieve site collection "URL" Error: Access denied. You do not have
                  permission to perform this action or access this resource.
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">No DB permissions at all</td>
                <td colspan="1" rowspan="1">
                  Unable to negotiate connection to SharePoint database server (host URL): Error
                  Connection Timeout Expired. The timeout period elapsed while attempting to consume
                  the pre-login handshake acknowledgement. This could be because the handshake
                  failed or the server was unable to respond back in time. The duration spent while
                  attempting to connect to this server was - [Pre-Login] initialization=4943;
                  handshake=1768;
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                  SP_DataAccess Role membership on SharePoint Content Databases
                </td>
                <td colspan="1" rowspan="1">
                  Unable to negotiate connection to SharePoint database server (host URL): Error
                  Connection Timeout Expired. The timeout period elapsed while attempting to consume
                  the pre-login handshake acknowledgement. This could be because the handshake
                  failed or the server was unable to respond back in time. The duration spent while
                  attempting to connect to this server was - [Pre-Login] initialization=4943;
                  handshake=1768;
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                  SP_DataAccess Role membership on SharePoint Config Database
                </td>
                <td colspan="1" rowspan="1">
                  Error enumerating ISharePointSiteCollection children of ISharePointWebApplication.
                  The EXECUTE permission was denied on the object 'proc_getSiteNames', database
                  'SharePoint_Config'
                </td>
              </tr>
              <tr>
                <td colspan="1" rowspan="1">
                  Public membership to SharePoint_Config, Owner on the content DB
                </td>
                <td colspan="1" rowspan="1">
                  Unable to negotiate connection to SharePoint database server sbnjqasp01: Error:
                  The EXECUTE permission was denied on the object 'proc_getObject', database
                  'SharePoint_Config', schema 'dbo'
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </article>
  </body>
</html>
