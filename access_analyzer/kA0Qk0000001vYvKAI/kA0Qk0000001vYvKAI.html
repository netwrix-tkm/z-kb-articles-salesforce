<?xml version="1.0" encoding="UTF-8"?>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Netwrix Threat Prevention Agent Not Processing Events</title>
    <meta name="label" content="enterprise_auditor" />
    <meta name="label" content="threat_prevention" />
    <meta name="label" content="f_stealthbits" />
    <meta name="label" content="skb" />
    <meta name="KnowledgeArticleId" content="kA0Qk0000001vYvKAI" />
    <meta name="Id" content="ka0Qk000000Co13IAC" />
    <meta name="LastPublishedDate" content="2025-03-04T22:30:34.000+0000" />
    <meta name="LastModifiedDate" content="2025-03-13T20:52:15.000+0000" />
    <meta name="FirstPublishedDate" content="2025-03-04T22:30:34.000+0000" />
    <meta name="Language" content="en_US" />
    <meta name="UrlName" content="9382" />
    <meta name="ArticleNumber" content="000009382" />
    <meta name="description" content="Netwrix Threat Prevention Agent Not Processing Events" />
  </head>
  <body>
    <article class="kb-articles">
      <div class="Content__c">
        <h2 id="related_query">Related Query</h2>
        <div>
          <ul>
            <li>
              <p>
                At 6:13 am Monday, around 10,000 computers got deleted. SI is not showing these
                events, but Netwrix Enterprise Auditor (NEA) is showing them. <br />Then, on Jan
                2nd, they deleted another 5,300 computers at around 10:37 am, and a lot of those are
                not showing up either, but NEA is able to see them.
              </p>
            </li>
          </ul>
        </div>
        <h2 id="symptoms">Symptoms</h2>
        <div>
          <p>The following symptoms are present in your environment:</p>
          <ul>
            <li>
              <p>
                An influx of events occurs during high event traffic hours on any given Netwrix
                Threat Prevention (NTP) agent causing adverse performance issues.
              </p>
            </li>
            <li>
              <p>
                This results in the NTP agent not responding, leading to the agent either processing
                some events and losing others, or completely failing to process events altogether.
              </p>
            </li>
            <li>
              <p>
                You may also discover <strong>Agent Heartbeat</strong> alerts generating on the
                affected agent under the Alerts node in the NTP admin console.
              </p>
            </li>
          </ul>
        </div>
        <h2 id="cause">Cause</h2>
        <div>
          <p>This issue may be caused by any one of the following:</p>
          <ul>
            <li>
              <p>Large LDAP Trace logs</p>
            </li>
            <li>
              <p>Agents/Admin console left in Debug Mode</p>
            </li>
            <li>
              <p>A large quantity of events and types of events being captured by the NTP agent</p>
            </li>
            <li>
              <p>Machine performance and other operational loads occurring on the target machine</p>
            </li>
            <li>
              <p>
                Unfiltered LDAP Policies or other high event count generating policies, such as
                unfiltered Logon policies
              </p>
            </li>
            <li>
              <p>
                EM/SQL server performance that can hinder the events from being processed and cause
                events to pile up on the agent, leading to an agent queue overflow
              </p>
            </li>
          </ul>
          <blockquote>
            <p>
              <strong>NOTE:Â </strong>If the agent is generating large LDAP Trace Logs, verify that
              the <code>LdapTrace</code> is set to <strong>False</strong>. This can be found in the
              <code>logging.ini</code> file at this file path:
            </p>
            <p><code>C:\Program Files\Netwrix\Netwrix Threat Prevention\SIWindowsAgent</code></p>
            <p>
              <img
                src="kA0Qk0000001vYvKAI_b1523410-272c-4ccd-8855-543ab347a67b.png"
                alt="Screenshot of logging ini file"
              />
            </p>
          </blockquote>
        </div>
        <h2 id="resolution">Resolution</h2>
        <div>
          <p>To resolve this issue, refer to the following steps:</p>
          <ol>
            <li>
              <p>
                Tune the NTP policies to collect and monitor only data that is considered important,
                while excluding anything that is not. Begin by following the below Best Practices
                documentation.
              </p>
              <ul>
                <li>
                  <p>
                    <a
                      href="https://helpcenter.netwrix.com/bundle/ThreatPrevention_7.4/page/Content/ThreatPrevention/Troubleshooting/Overview.htm"
                      target="_blank"
                      >Best Practices and Troubleshooting</a
                    >
                  </p>
                </li>
              </ul>
            </li>
            <li>
              <p>
                Perform mass deletion of AD objects in batches to mitigate the probability of an
                agent not responding or entering into an event queue overflow.
              </p>
            </li>
            <li>
              <p>
                Schedule tasks that result in an abnormal amount of event traffic to be performed
                during off hours or low traffic periods.
              </p>
            </li>
            <li>
              <p>Verify that the EM and agent log settings are set to <strong>WARN</strong>.</p>
            </li>
            <li>
              <p>Verify that the <code>LdapTrace</code> is set to <strong>False</strong>.</p>
            </li>
          </ol>
        </div>
        <h2 id="related_article">Related Article</h2>
        <div>
          <ul>
            <li>
              <a
                href="https://helpcenter.netwrix.com/bundle/ThreatPrevention_7.4/page/Content/ThreatPrevention/Troubleshooting/Overview.htm"
                target="_blank"
                >Best Practices and Troubleshooting</a
              >
            </li>
          </ul>
        </div>
      </div>
    </article>
  </body>
</html>
