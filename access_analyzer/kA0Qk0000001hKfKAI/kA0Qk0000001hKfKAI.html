<?xml version="1.0" encoding="UTF-8"?>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Error C:38 - Unable to Connect to SharePoint Online</title>
    <meta name="label" content="employees_v" />
    <meta name="label" content="enterprise_auditor" />
    <meta name="label" content="skb" />
    <meta name="KnowledgeArticleId" content="kA0Qk0000001hKfKAI" />
    <meta name="Id" content="ka0Qk000000BTMrIAO" />
    <meta name="LastPublishedDate" content="2024-12-05T20:04:59.000+0000" />
    <meta name="LastModifiedDate" content="2024-12-09T17:56:15.000+0000" />
    <meta name="FirstPublishedDate" content="2024-12-05T20:04:59.000+0000" />
    <meta name="Language" content="en_US" />
    <meta name="UrlName" content="9324" />
    <meta name="ArticleNumber" content="000009324" />
    <meta name="description" content="Error C:38 - Unable to Connect to SharePoint Online" />
  </head>
  <body>
    <article class="kb-articles">
      <div class="Content__c">
        <blockquote>
          <p>
            <span><strong>IMPORTANT: </strong></span>This is a work-in-progress article. The product
            R&amp;D team has yet to review some or all of the information below.
          </p>
        </blockquote>
        <h2 id="symptoms">Symptoms</h2>
        <div>
          <p>
            When running the SharePoint Job Group and attempting a connection to SharePoint Online,
            the following issues appear:
          </p>
          <ul>
            <li>
              <p>There is a failure in the connection attempt.</p>
            </li>
            <li>
              <p>The system generates the following error message:</p>
              <pre class="has-inner-focus">
Error C:38 - Unable to Connect to SharePoint Online
</pre
              >
            </li>
          </ul>
        </div>
        <h2 id="cause">Cause</h2>
        <div>
          <p>
            The PowerShell (PS) script used in the SP_RegisterAzureAppAuth Job was not configured to
            use the password associated with the temporary connection profile.
          </p>
        </div>
        <h2 id="resolution">Resolution</h2>
        <div>
          <p>To resolve this error, please refer to the following steps:</p>
          <ol>
            <li>
              <p>
                Replace the app password value within the PS script with the password associated
                with the Azure AD connection profile.
              </p>
              <img
                src="kA0Qk0000001hKfKAI_e7afa91f-d4d9-4da2-8655-afbb2cbdb12f.png"
                alt="SP_PSscript.png"
              />
            </li>
            <li>
              <p>
                After updating these lines within the PS script and the connection profile, you
                should then be able to successfully run the SP_RegisterAzureAppAuth Job that
                generates a new connection profile and automatically opens a browser to confirm
                permissions.
              </p>
              <blockquote>
                <p>
                  <span><strong>NOTE: </strong></span>For more information about the
                  SP_RegisterAzureAppAuth Job, please see the following article:
                  <a
                    href="https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Admin/Jobs/InstantJobs/SP_RegisterAzureAppAuth.htm"
                    title="SP_RegisterAzureAppAuth Job"
                    target="_blank"
                    >SP_RegisterAzureAppAuth Job</a
                  >.
                </p>
              </blockquote>
            </li>
            <li>
              <p>
                Once the new profile is created, add the
                <strong>newly generated .pfx file</strong> into the generated file path along with
                the password for the connection profile into the SharePoint connection profile.
              </p>
            </li>
            <li>
              <p>
                You should then apply the <strong>newly generated connection profile</strong> to the
                SPAA system scans job. This should successfully connect you to the SharePoint site.
              </p>
            </li>
          </ol>
        </div>
        <h2 id="related_articles">Related Articles</h2>
        <div>
          <ul>
            <li>
              <a
                href="https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Admin/Jobs/InstantJobs/SP_RegisterAzureAppAuth.htm"
                title="SP_RegisterAzureAppAuth Job"
                target="_self"
                >SP_RegisterAzureAppAuth Job</a
              >
            </li>
          </ul>
        </div>
      </div>
    </article>
  </body>
</html>
