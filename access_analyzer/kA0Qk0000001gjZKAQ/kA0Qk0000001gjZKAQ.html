<?xml version="1.0" encoding="UTF-8"?>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Error: Length of Access Control List Exceed Allowed Maximum</title>
    <meta name="label" content="enterprise_auditor" />
    <meta name="label" content="f_stealthbits" />
    <meta name="label" content="skb" />
    <meta name="KnowledgeArticleId" content="kA0Qk0000001gjZKAQ" />
    <meta name="Id" content="ka0Qk000000Bzo9IAC" />
    <meta name="LastPublishedDate" content="2025-01-28T19:18:27.000+0000" />
    <meta name="LastModifiedDate" content="2025-01-28T19:22:38.000+0000" />
    <meta name="FirstPublishedDate" content="2025-01-28T19:18:27.000+0000" />
    <meta name="Language" content="en_US" />
    <meta name="UrlName" content="9319" />
    <meta name="ArticleNumber" content="000009319" />
    <meta
      name="description"
      content="User Exceeds Maximum Access Control List error during a full ADI scan in the Netwrix Enterprise Auditor application."
    />
  </head>
  <body>
    <article class="kb-articles">
      <div class="Content__c">
        <h2 id="symptoms">Symptoms</h2>
        <div>
          <p>Both of the following symptoms are present in your environment:</p>
          <ul>
            <li>
              <p>
                There is a user that exceeds the access control list (ACL) maximum threshold when
                running an Active Directory Inventory\1-AD_Scan job in the Netwrix Enterprise
                Auditor application.
              </p>
            </li>
            <li>
              <p>The system generates the following error message:</p>
              <pre class="has-inner-focus">
Error on the Active Directory Inventory\1-AD_Scan: REDACTED USER DN 'Length of the access control list exceed the allowed maximum.
</pre
              >
            </li>
          </ul>
        </div>
        <h2 id="cause">Cause</h2>
        <div>
          <p>
            This error is caused when the ACL reaches its maximum size. The size of an ACL varies
            with the number and size of its access control entries (ACEs). The maximum size of an
            ACL is 64 kilobytes (KB), or approximately 1,820 ACEs. However, reaching the maximum
            size can sometimes degrade performance.
          </p>
          <p>
            <span class="Note"><strong>NOTE: </strong></span>For more information on ACL
            Limitations, refer to the official Microsoft documentation: <a
              href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/error-add-user-to-security-permissions"
              target="_blank"
              >Maximum number of access control entries in the access control list</a
            >.
          </p>
        </div>
        <h2 id="resolution">Resolution</h2>
        <div>
          <p>
            To prevent the error from immediately terminating the scan when the ACL maximum size is
            reached, refer to the following steps:
          </p>
          <ol>
            <li>
              <p>
                Perform a cumulative update to Netwrix Enterprise Auditor version 11.6.0.114 or
                later.
              </p>
            </li>
            <li>
              <p>
                Follow the steps in this document to perform the upgrade process: <a
                  href="https://helpcenter.netwrix.com/bundle/EnterpriseAuditor_11.6/page/Content/EnterpriseAuditor/Install/Application/Upgrade/Overview.htm"
                  target="_blank"
                  >Enterprise Auditor Console Upgrade</a
                >.
              </p>
            </li>
          </ol>
          <blockquote>
            <p>
              <span class="Caution"><strong>IMPORTANT: </strong></span>This hotfix changes the
              exception handling so that instead of terminating the scan, a warning is logged about
              the user not being scanned.
            </p>
          </blockquote>
        </div>
      </div>
    </article>
  </body>
</html>
