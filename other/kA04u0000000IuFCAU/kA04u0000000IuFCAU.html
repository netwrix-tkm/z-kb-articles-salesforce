<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Script to Report on OWA Hits Per User for the Last 30 Days</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000IuFCAU"/><meta name="Id" content="ka04u000000Hcy8AAC"/><meta name="LastPublishedDate" content="2022-02-01T18:40:40.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:12:26.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:40:40.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7306"/><meta name="ArticleNumber" content="000007306"/><meta name="description" content="360008408371"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Just a simple script that was put together because a customer wanted to see how many OWA hits a user was generating over a 30 day period instead of seeing total OWA hits for the full 6 month period of history retention Customers who are looking to check the performance of their CAS Load Balancing may find this useful as OWA Hit Count indicates how often a user us creating RPC traffic on a CAS (Client Access Server) by accessing their email via Outlook Web Access (OWA)</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> The issue that the customer was having is that they were seeing an extreme amount of RPC Traffic on their CAS server and they couldn't determine where it was coming from. They wanted to know if it was coming from a specific user or if it was spread out across their entire organization.</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong></p>
<ol><li>Before running this analysis task the customer must already be running the CAS Metrics Job Group</li><li>The attached job can be run from the sandbox or from within the out of the box Exchange Solution as part of the CAS Metrics Group</li></ol>
<p><span><span><span>if</span></span></span><span><span> <span>object_ID</span><span>(</span><span>'SA_EX_OWATrafficStats_UserHits30Days'</span><span>,</span><span>'table'</span><span>)</span> <span>is</span> <span>not</span> <span>null</span></span></span><br/><span><span><span>Drop</span></span></span><span><span> <span>table</span> SA_EX_OWATrafficStats_UserHits30Days</span></span><br/> <br/><span><span><span>Select</span></span></span><br/><span><span>  [User]</span></span><br/><span><span><span>,</span></span></span><span><span> <span>SUM</span><span>(</span>Hits<span>)</span> <span>as</span> [UserHits]</span></span><br/><span><span><span>,</span></span></span><span><span> <span>cast</span> <span>(</span><span>min</span> <span>(</span><span>date</span><span>)</span> <span>AS</span> <span>varchar </span><span>(</span>60<span>))</span> <span>+</span> <span>'  to  '</span> <span>+</span> <span>CAST</span><span>(</span> <span>MAX</span><span>(</span><span>date</span><span>)</span> <span>AS</span> <span>varchar </span><span>(</span>60<span>))</span> <span>AS</span> [Activity Range]</span></span><br/><span><span><span>into</span></span></span><span><span> SA_EX_OWATrafficStats_UserHits30Days</span></span><br/><span><span><span>from</span></span></span><span><span> sa_ex_OWATraffic_Details</span></span><br/><span><span><span>where</span></span></span><span><span> [date] <span>&gt;=</span> <span>DATEADD</span><span>(</span><span>day</span><span>,-</span>30<span>,</span><span>Getdate</span><span>())</span></span></span><br/><span><span><span>group</span></span></span><span><span> <span>by</span> [USER]</span></span><br/> </p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - ExchangeMailbox<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 8.1+<br/><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 2250</p></div>
</article></body></html>