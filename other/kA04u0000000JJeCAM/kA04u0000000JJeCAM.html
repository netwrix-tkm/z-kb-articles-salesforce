<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Hotfix: SA_8.0_057</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000JJeCAM"/><meta name="Id" content="ka04u000000Hd6nAAC"/><meta name="LastPublishedDate" content="2022-02-01T18:54:40.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:16:11.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:54:40.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="8017"/><meta name="ArticleNumber" content="000008017"/><meta name="description" content="360012326291"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Teck Resources -This fix introduces support for Host Name Site Collections in local mode scan.  Prior to this fix, we support host name site collections only in agent mode scan.</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <b>YouTrack/Escalations</b><br/>SASP-2391 21490 - Teck Resources | Host Name site collections<br/>SASP-2309 18958 - SPAA Unable to negotiate connection to SharePoint Server<br/> <br/><b>Cumulative List of fixes included since Release:</b><br/><b>RMT/YouTrack                                                                                                     Description</b><br/>SASP-1347                                                                                                           BOX DC BI Fixes<br/>SASP-1344                                                                                                           SPAA fix for error:System.UriFormatException<br/>SASP-1329                                                                                                           SPAA CSOM fix for trustee type determination and BI treustee key violation<br/>SASP-1399                                                                                                           SPAA 2010 on-prem fixes<br/>SASP-1395                                                                                                           SPAA merge of tier 1 trustee table<br/>SAP-1442                                                                                                             SPAA onprem SP2013 bulk import bug fixes - fix for null reference in bug extract base<br/>SASP-1446                                                                                                           SPAA enhancement to force accoutn as site admin for inaccessible personal sites<br/>SASP-1505                                                                                                           SPAA identify SPO version distinct from 2016<br/>SASP-1507                                                                                                          collect title of personal site collections<br/>SASP-1307                                                                                                          SPAA .net 4 version of common assemblies.<br/>SASP-1389                                                                                                          SPAA missing domain groups<br/>SASP-1532                                                                                                          SPAA fix for SPO scans, fix for .net versions bug.<br/>SPAA-1457                                                                                                          SPAA document tag scanning<br/>SASP-1580                                                                                                          SPAA adding logging to Query assemblies.<br/>SASP-1572                                                                                                          Add Personal Sites Web App to SPO, SASP-1563 Roll back SPO version prefix.<br/>SASP-1593                                                                                                          SPAA sanitization of CSOM query assembly URLs<br/>SASP-1512                                                                                                          SPAA fix for trustee bug with web applications<br/>SASP-1606                                                                                                          SPAA add support for Everyone Except External Users role<br/>SASP-1446                                                                                                          fix personal site force admin bug<br/>SASP-1604                                                                                                          SPAA fix for un-named site collections<br/>SASP-1625                                                                                                          SPAA fix for 7.2-&gt;8.0 upgrade errors during bulk import<br/>SASP-1642                                                                                                          SPAA document libraries missing from SPO<br/>SASP-1641                                                                                                          SPAA SPO missing one drive content for personal sites<br/>SASP-1663                                                                                                          SPAA fix web app scoping in CSOM query assembly<br/>SASP-1681                                                                                                          SPAA SPO bug fix duplicate sites under personal site collections<br/>SPAA-1671                                                                                                          SPAA fix for enumeraton of folders under generic lists<br/>SASP-1716                                                                                                          SPAA fix tag parsing in agent.<br/>SASP-1765                                                                                                          16440 - SPAA Memory consumption<br/>SASP-1780                                                                                                          16590 - SPAA fix bug in agent communication error handling code<br/>SASP-1736                                                                                                          SPAA improvements to tag error logging<br/>SASP-1795                                                                                                          fix for SPAA fix Site Collection SPObjectID bug in 7.2, 8.0, and 8.1<br/>SASP-1767                                                                                                          SPAA agent service auto-reset<br/>SASP-1782                                                                                                          improved agent wcf error  handling<br/>SASP-1704                                                                                                          Improvements to NULL handling in SPAA database.<br/>SASP-1827                                                                                                          SPAA fix for bug with files without authors<br/>SASP-1809                                                                                                          SPAA fix for bug with DLP scan loosing TAG scan data.<br/>SASP-1807                                                                                                          SPAA improvements to timeouts and stream memory management copying remote files for DLP and tag parsing.<br/>SASP-1796                                                                                                          SPAA minor improvements to tag parsing related logging<br/>SASP-1414                                                                                                          addresses a bug in the code where an error in the sql server transaction rollback could "eat" an error which caused the scan to abort - now both errors will be logged. Also                                                increases the rollback timeout to 15 minutes from 15 seconds.<br/>SASP-1796                                                                                                          SPAA update assembly version for tag parser logging changes.<br/>SASP-1874                                                                                                          SPO DC fix SBSPOSvr communication error due to callbacks on disconnected sessions.<br/>SASP-1895                                                                                                          Support for forms authentication at the site collection level<br/>SASP-1885                                                                                                          SPAA bulk import fox for null role definitions<br/>SASP-1861                                                                                                          fix SID related claim parsing error is server query assembly, SASP-1900  fix concurrently issue loading query assemblies<br/>SASP-1916                                                                                                          SASP fix dlp initialization errors not being logged<br/>SASP-1796                                                                                                          16977 - SPAA Local-Mode Scans | Tags partially collected with SATagParser.dll: 80 or 110 errors<br/>SASP-1823                                                                                                          8.0 agentless SPAA scans not collecting AD Groups<br/>                                                                                                                                       Updated the CAML query to collect both users and groups for 2010 SharePoint farms.  <br/>SASP-1874                                                                                                          SPO DC fix SBSPOSvr communication error due to callbacks on disconnected sessions.<br/>SASP-1895                                                                                                          Support for forms authentication at the site collection level<br/>SASP-1885                                                                                                          SPAA bulk import fox for null role definitions<br/>SASP-1936                                                                                                          Fix connection errors and improve connection logging                                                                                                                <br/>SASP-1949                                                                                                          added error message text to logging of "connection retry" errors.<br/>SASP-1984                                                                                                          SPAA Sharing &amp; SharingUsers ResourceID Bug<br/>SASP-1991                                                                                                           SPAA Fix for User cannot be found Error at SPFile.get_Author<br/>SASP-2001                                                                                                           DLP db file copy bug fix<br/>SASP-2003                                                                                                           Agent SharePont File and folder path bug fix<br/>SASP-2008                                                                                                           Swisscom &amp; Allstate SSL Port URL number fixes for negotiation<br/>SASP-2029                                                                                                           bug fix for multi-scan sdd error - finalize scanner was being called multiple times<br/>SASP-2030                                                                                                           bug fix handle missing authros in csom query assembly<br/>                                                                                                                                       SPAA minor improvements to error handling in post scan DLP finalization<br/>SASP-1978                                                                                                           SPAA AIC | Onlyshortcuts are listed for paths we are going to trim any trailing backslash to Web App URLS<br/>SASP-2048                                                                                                           Make changes to SPAA to ignore Limited Access Removed "UseRemoteAPI's" SPBasePermision from "Read" RightsMapping With this Limited Access role will get 0 rights instead of                                 Read rights.<br/>SASP-2053                                                                                                           SPAA COM Interop Performance improvement<br/>SASP-2058                                                                                                           adding support for the "i:0#.w|nt authority\authenticated users" claim<br/>SASP-2073                                                                                                          -SPAA  fix for "User cannot be found" error in CSOM GetObjectSharingInformation<br/>SASP-2071                                                                                                          SPAA fix missing LoginName property in CSOM AddFileDocumentMetaData<br/>SASP-2011                                                                                                          19039             SPSEEK | Scan misses sensitive data hits in files<br/>SASP-2012                                                                                                          19044             SPSEEK| Access denied to URLs in Open Sites Report<br/>SASP-2084                                                                                                          Fix user not found in CSOM role assignments query<br/>SASP-2087                                                                                                          improved general "user not found" error handling in CSOM query assembly.  SASP-1967 merged 8.1 improvements to On Prem determination.<br/>SASP-2052                                                                                                          SASP-2053 performance changes merged down to 8.0<br/>SASP-2079                                                                                                          SPAA list level concurrency performance improvements<br/>SASP-2079                                                                                                          fix for compiler bug due to missing #if DEBUG conditional<br/>SASP-2124                                                                                                          SPAA fix for NullReferenceException if list level concurrency<br/>SASP-1872                                                                                                          fix for UNIQUE constraint failed: TagProxies.ID, TagProxies.TagId<br/>SASP-2011                                                                                                          SPAA support for 4 new DLP scan program options. (TxtForAccess, TxtForAllFiles, SavePerfStats, and DetailedPerfStats)<br/>SASP-2117                                                                                                          memory and performance improvements &amp; logging in CSOM query dll<br/>SASP-2139                                                                                                          Fix null reference error in memory improvement code<br/>SASP-2056                                                                                                          Improve SQLite database write speed<br/>SASP-2157                                                                                                          (merged from 8.1) added DLPScanOptions to job XML, changed default MaxCutOffFilesForPattern to 0<br/>SASP-2134                                                                                                          SPSEEK Scans Aborting<br/>SASP-2137                                                                                                          Update SP_OpenAccess job to include configuratble parameter for high risk groups<br/>SASP-2262                                                                                                          19009 - SharePoint Scan OOM errors<br/>SASP-2080 19562 - SA-SPAA/SPSEEK unable to negotiate after upgrade to 8.0<br/>SASP-2380   Merge Support for all List Types to 8.0<br/>SASP-2378   SPAA fix missing user criteria in tier 2 agent scans<br/><a title="Belongs to project 'StealthAUDIT - SP, Sensitive Data, DropBox'" href="https://stealthbits.myjetbrains.com/youtrack/issue/SASP-2297" target="_blank"><span>SASP-2297</span></a><span> 14859 </span>- SPAA: Add support for all List Types.<br/>SASP-2391 21490 -                    Support  Host Name site collections<br/>SASP-2309 18958 -                     Add support for TLS 1.2</p><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> 1. Exit StealthAUDIT console<br/>2. Update all DC files in your StealthAUDIT\DC directory<br/>3. Update all PrivateAssemblies files in your StealthAUDIT\PrivateAssemblies director<br/>4. if you require TLS 1.2 support , Update the file 'PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.Query.CSOM.dll.config' to set the SslProtocol value to 3072. i.e ( 3072)<br/>If you require SSL support , Update the file 'PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.Query.CSOM.dll.config' to set the SslProtocol value to 48. i.e (48)<br/>If you require TLS 1.0 support , Update the file 'PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.Query.CSOM.dll.config' to set the SslProtocol value to 192. i.e (192)<br/>If you require TLS 1.1 support , Update the file 'PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.Query.CSOM.dll.config' to set the SslProtocol value to 798. i.e (768)<br/>5. Stop Agent service on SharePoint Server<br/>6. If updating an agent on SharePoint 2010: update the files in Agent installation directory with the DLLs in the NET35 Folder<br/>If updating an agent on SharePoint 2013: update the files in Agent installation directory with the DLLs in the NET40 Folder<br/>7. Restart the Agent service on the SharePoint Server<br/> <br/> <br/> <br/> <br/> <br/> <br/><br/><br/>  
</p><div class="table-wrap"><table count-columns="1" cellspacing="0" cellpadding="0" width="64" border="0"><tbody><tr height="77"><td colspan="1" rowspan="1" height="77" width="64"><a href="https://downloads.stealthbits.com/access/files/SAHotFixes/8.0/SA_8.0_057.zip" target="_blank">https://downloads.stealthbits.com/access/files/SAHotFixes/8.0/SA_8.0_057.zip</a></td></tr></tbody></table></div><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - SPAA - Permissions<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 8.0<br/><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SASP-2391<br/><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 1768<br/></p></div>
</article></body></html>