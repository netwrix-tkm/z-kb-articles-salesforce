<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Can't Communicate with FSAA Applet (Error "Access is denied")</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000IstCAE"/><meta name="Id" content="ka04u000000HcxfAAC"/><meta name="LastPublishedDate" content="2022-02-01T18:39:18.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:12:17.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:39:18.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7286"/><meta name="ArticleNumber" content="000007286"/><meta name="description" content="360008408371"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Special security settings are required for FSAA to work in applet or proxy mode. NOTE: These settings are in place by default in Windows 7 OS.</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> Running the FSAA applet is not technically supported on all target/proxy Windows operating systems. Against some OSes (e.g., Windows 7), when running FSAA against a target host in applet mode, or when running FSAA as a service without Secure RPC enabled, the applet process will start, but will deny access to the StealthAUDIT job trying to communicate with the applet process (StealthAUDITRPC.exe). Firewall is open and for requisite ports, but FSAA System Scan job log indicates "Access Denied":<br/><br/><img alt="User-added image" src="kA04u0000000IstCAE_36fea42e-23c8-44e8-9846-afbae32e12b9.jpg" width="500" height="109"/><br/><br/>Even though trace log on applet indicates that it's listening:<br/><br/><img alt="User-added image" src="kA04u0000000IstCAE_5d3c381d-9936-44d4-8bc6-b112e7947c92.jpg" width="500" height="328"/><br/>No applet log gets created, and the scan eventually fails (after about 5 minutes, the default applet communication timeout). Messages for host:<br/>Error in TAppletRPCHelper.GetSessions: (0x00000005) Access is denied"<br/><img alt="User-added image" src="kA04u0000000IstCAE_1e7c683e-0cb6-4a19-addc-0f5f38ac75ec.jpg" width="500" height="100"/><br/> </p><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> This behavior is because of a security feature introduced in Windows 2003 SP1 called RPC Interface Restriction (<a href="https://technet.microsoft.com/en-us/library/aa995844(v=exchg.80).aspx" target="_blank"><span>https://technet.microsoft.com/en-us/library/aa995844(v=exchg.80).aspx</span></a><span>).</span> This prevents unsecured RPC calls. The setting requires that you create a registry entry to change from the default.<br/> <br/>There are two ways around this:<br/> <br/>Change the setting on the target/proxy host in via the registry (tested) 
</p><ol><li>Create the following registry key:</li></ol>HKEY_LOCAL_MACHINE\ Software\Policies\Microsoft\Windows NT\RPC 
<ol><li>Create a DWORD value called "RestrictRemoteClients"
</li><li>Set the value to 0
</li><li>End the StealthAUDITRPC.exe process, if it's still running, and kick off a new scan. </li></ol> Run the applet securely (untested, but referenced TechNet article indicates that it should work) 
<ol><li>Install the FSAA Applet as a Service and configure it to run with SecureRPC, per FSAA instructions.
</li><li>Restart FSAA service (StealthAUDITRPC.exe)</li></ol><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - FSAA - Activity;SA - DC - FSAA - DFS;SA - DC - FSAA - Sensitive Data<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> V7.x<br/><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 1492<br/></p></div>
</article></body></html>