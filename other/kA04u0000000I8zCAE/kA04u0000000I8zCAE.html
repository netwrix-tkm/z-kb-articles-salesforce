<?xml version="1.0" encoding="UTF-8"?>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Hotfix: SA_10.0_071</title>
    <meta name="label" content="employees_v" />
    <meta name="label" content="skb" />
    <meta name="KnowledgeArticleId" content="kA04u0000000I8zCAE" />
    <meta name="Id" content="ka04u000000HcgcAAC" />
    <meta name="LastPublishedDate" content="2022-02-01T18:04:04.000+0000" />
    <meta name="LastModifiedDate" content="2023-05-08T10:03:36.000+0000" />
    <meta name="FirstPublishedDate" content="2022-02-01T18:04:04.000+0000" />
    <meta name="Language" content="en_US" />
    <meta name="UrlName" content="6243" />
    <meta name="ArticleNumber" content="000006243" />
    <meta name="description" content="360012326391" />
  </head>
  <body>
    <article class="kb-articles">
      <div class="Content__c">
        <p>
          <strong>Summary: </strong>  Failed to import SA_FSDLP_Matches: Violation of PRIMARY KEY
          constraint 'PK_SA_FSDLP_Matches'. (Remediation)
        </p>
        <p>
          <strong>Before Fix: </strong>In a situation where an SDD scan was abruptly killed, the
          subsequent scan would not clear out SDD matches for resources that were being scanned.
          This could result in duplicate SDD matches in the DLPEX databases and a PK error on the
          next bulk import.
        </p>
        <p>
          <strong>After Fix: </strong>The built-in FSAA Repair tool has been updated to remediate
          this situation if it arises. Repair tool will clean up any duplicate SDD matches, which
          should allow bulk import to complete.
        </p>
        <p><strong>Submitted by: </strong></p>
        <p>Michael Burrofato</p>
        <p><strong>Affected Versions:</strong></p>
        <p>10.0</p>
        <p><strong>Affected Module:</strong></p>
        <p>SA – DC – FSAA</p>
        <p><strong> </strong></p>
        <p><strong>Dev Ticket:</strong></p>
        <ul>
          <li>SAFS-20792</li>
        </ul>
        <p><strong>Resolved in Version:</strong></p>
        <ul>
          <li>DC\DCFSAA.dll              10.0.1269</li>
          <li>DC\FSAASrv.dll              10.0.1269</li>
          <li>PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.FSAA.dll 10.0.1269</li>
          <li>PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.FSAA.UI.dll 10.0.1269</li>
        </ul>
        <p><strong>Other dependencies included:</strong></p>
        <ul>
          <li>DC\AIPHelper.dll</li>
          <li>DC\FSAAnetApp.dll</li>
          <li>DC\FSAATagHelper.exe</li>
          <li>DC\libnfs.dll</li>
          <li>DC\SDDScanAPI32.dll</li>
          <li>DC\sqlite3.dll</li>
          <li>DC\StealthAUDITRPC.exe</li>
          <li>DC\StealthAUDITRPCClient.dll</li>
          <li>DC\UpdateFSAAService.exe</li>
          <li>PrivateAssemblies\StealthAUDITRPCClient.dll</li>
          <li>PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.FSAA.RPCClient.dll</li>
          <li>SensitiveData\DLPCommon.dll</li>
        </ul>
        <p><strong>KB Type: </strong></p>
        <p>               Hotfix</p>
        <p><strong> </strong></p>
        <p><strong>YouTrack/Escalations</strong></p>
        <p><strong> </strong></p>
        <p><strong>-              SAFS-20792/56701</strong></p>
        <p> </p>
        <p><strong>Cumulative List of fixes included since Service Pack:</strong></p>
        <p>
          <strong>-              SAFS-18439 42338 - Update FSAC to support UCS2 encoding</strong>
        </p>
        <p>
          <strong
            >-              SAFS-18737 471 - FSAA Unable to start scan: Could not initialize scan
            session for "SERVER" with "SCANNER"</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-18771 50592 - FSAA Bulk import errors "UNIQUE constraint failed" on
            Turkish console.</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-18795 50703/50855 - FSAA "...not a valid date and time" Error
            scanning after Upgrading to 10.0</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-18975 Add logging to the FSAA repair tool in maintenance
            wizard</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19025 51346 - FSAA Bulk Import error: SqlDateTime overflow</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19092 SDD: Dont start file extractor when only text extractor is
            needed (10.0 Implementation)</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19100 FSAA: Improve performance in bulk import around
            SetDeletedUSN</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19180 FSAA: T2 Query for resources can result in fragmented IDs
            importing, hurting performance</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19211 51931 - Unable to upgrade FSAA proxy using maintenance
            query</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19009 Update FSAA to store null values in the SA_FSAA_FileAges
            table for folders that do not have files in them. (10.0+)</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19375 Update duplicate removal tool to fix GatesProxyMap (10.0
            Merge)</strong
          >
        </p>
        <p>
          -              SAFS-19370 FSAA DC: Repair tool looking in wrong location for Suspend.xml
        </p>
        <p>
          -              SAFS-19270 51453 - FSAC: Impersonation issue when targeting Windows
          Clusters
        </p>
        <p>
          -              SAFS-18990 FSAA: Repair tool throws SQL logic error if multiple DLPEX
          databases exist
        </p>
        <p>
          <strong
            >-              SAFS-19358 52688 - FSAA DC: Repair tool timeout is hardcoded to 30
            minutes</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-18786 FS DC: Maintenace task 'RESET' on a host in T1 that has no T2
            folder shows obscure error</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19498 Error after Repair Tool 10.0 - SQL logic error database
            DLPEX0 is already in use</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19499 FSAA Repair Tool: Saying path doesn't exist when it
            does</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19280 1164 - FS DC: Improve proxy host list selection in FSAA DC
            scan config.</strong
          >
        </p>
        <p><strong>-              SAFS-19488 Update FSAA to support IPv6 for NFS scans.</strong></p>
        <p>
          <strong
            >-              SAFS-19425 52817 - PK_SA_FSAC_PermissionChanges after Dup
            Removal</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19553 FSAA: Remove reference to HostStatus.pas in FSAA
            Project</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19671 FSAA Repair tool: SQL logic error no such table:
            TBL_FSAC_PermissionChanges</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19353 52576 - Add tool to mark children of deleted parents as
            deleted in tier 1 to the repair tool</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19693 53538 - FS scans do not respect scoping rules when folder is
            a substring of filter</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-18673 53120 - FSAA SDD: Scans fail to start when there is too much
            custom criteria configured.</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-19695 53546 - FSAC Bulk Import Errors
            "System.NullReferenceException: Object reference not set to an instance of an
            object"</strong
          >
        </p>
        <p> </p>
        <p><strong>List of changes since last Hotfix</strong></p>
        <p><strong>-              SAFS-18566 FSAA SDD: Progress reporting not working</strong></p>
        <p><strong>-              SAFS-20082 54480 - FS Maint Wiz Limit on DLP Tier 2</strong></p>
        <p><strong>-              SAFS-20128 SDD: Issue with long path handling</strong></p>
        <p>
          <strong
            >-              SAFS-20337 SDD: Bulk import error importing MatchHits of corrupt zip
            files</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-18993 SDD: Error initiating DLP scan of file with temp path of 260
            characters</strong
          >
        </p>
        <p>
          <strong>-              SAFS-20276 SA 10.0 365 day limit on file activity (UI).</strong>
        </p>
        <p><strong>-              SAFS-19954 FSAA SDD: Batch deleting old SDD matches</strong></p>
        <p>
          <strong
            >-              SAFS-20378 55122 - Disabling OCR automatically excludes image files from
            SDD scans</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-20593 FSAA SDD: SEEK Bulk Import Results table shows inaccurate
            counts for Matches and MatchHits when using SDD Parallelism</strong
          >
        </p>
        <p>
          <strong
            >-              SAFS-20792 56701 - Failed to import SA_FSDLP_Matches: Violation of
            PRIMARY KEY constraint 'PK_SA_FSDLP_Matches'. (Remediation)</strong
          >
        </p>
        <p> </p>
        <p><strong>Comments:</strong></p>
        <p>
          <strong
            >THIS HOTFIX REQUIRES SDD ADD-ON VERSION 10.0.0.66 OR LATER TO BE INSTALLED (IF LICENSED
            FOR SDD).</strong
          >
        </p>
        <p><strong>Instructions:</strong></p>
        <ol>
          <li>
            Unblock the hotfix zip file in the windows property dialog, if an unblock button exists
            there. 
          </li>
          <li>
            Close all instances of StealthAUDIT (check task manager under processes for all users)
          </li>
          <li>Update all DC files in your %SAInstallDir%DC folder</li>
          <li>Update all PrivateAssemblies in your %SAInstallDir%PrivateAssemblies folder.</li>
          <li>Update all SensitiveData files in your %SAInstallDir%SensitiveData folder.</li>
          <li>
            Install SDD add-on version 10.0.0.66 or later (this step only applies to customers that
            are licensed for Sensitive Data)
          </li>
          <li>
            Run the ‘Update Proxy Service’ query under the Maintenance tab in the FSAA data
            collector against your proxy servers (if running proxy service).
            <ol>
              <li>
                <strong
                  >PLEASE NOTE THAT THIS HOTFIX INCLUDES A CHANGE THAT MAY REQUIRE YOU TO RUN THE
                  UPDATE PROXY SERVICE TWICE TO UPDATE SDD COMPONENTS ON THE PROXY SERVER. YOU
                  SHOULD RECEIVE A WARNING ON THE FIRST RUN INDICATING THIS.</strong
                >
              </li>
            </ol>
          </li>
          <li>
            Use the Maintenance Repair Hosts tool within the FSAA data collector to repair the
            host(s) that has the error during bulk import.
          </li>
          <li>Run bulk import for the repaired hosts.</li>
          <li>
            After running the maintenance tool and successfully importing data, customers who were
            running a differential scan when the issue occurred should set their differential scan
            settings to before their previous scan (when the issue occurred). The next scan should
            also be a new scan and not a resumed scan.
          </li>
        </ol>
        <p>
          <strong
            ><a
              href="https://downloads.stealthbits.com/access/files/SAHotFixes/10.0/SA_10.0_071.zip"
              target="_blank"
            >
              https://downloads.stealthbits.com/access/files/SAHotFixes/10.0/SA_10.0_071.zip</a
            ></strong
          >
        </p>
        <p> </p>
      </div>
    </article>
  </body>
</html>
