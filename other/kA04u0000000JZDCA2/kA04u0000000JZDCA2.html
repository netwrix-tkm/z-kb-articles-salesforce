<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Change Tracker Info - Custom Planned Change Examples</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000JZDCA2"/><meta name="Id" content="ka04u000000Hd9cAAC"/><meta name="LastPublishedDate" content="2022-02-07T00:48:11.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:17:38.000+0000"/><meta name="FirstPublishedDate" content="2022-02-07T00:48:11.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="8193"/><meta name="ArticleNumber" content="000008193"/><meta name="description" content="HELPDESK"/></head><body><article class=" kb-articles"><div class="Content__c"><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="66" width="155" src="kA04u0000000JZDCA2_a0245be9-a550-4ea3-9d64-a5574695b5d4.png"/></span></p><p><br/></p><h3 id="ChangeTrackerInfo-CustomPlannedChangeExamples-_Toc475087766AppendixB-CustomPlannedChangeExamples"><span class="confluence-anchor-link conf-macro output-inline" id="ChangeTrackerInfo-CustomPlannedChangeExamples-_Toc475087766"><span class="confluence-anchor-link" id="_Toc475087766"> </span></span>Appendix B - Custom Planned Change Examples</h3><p><br/></p><p><strong>Accept a change made by a specified user (note the need to 'escape' the \ by using a second \ )</strong><br/>event.CurrentAttributes.GetString("fileusername") == "NT AUTHORITY\\System"</p><p><strong>Accept a change made by a specified process</strong><br/>event.CurrentAttributes.GetString("fileprocessname") == "SMEX_master.exe"</p><p><strong>Accept a change if it is anything other than a deletion</strong><br/>event.ChangeType != DeviceEventChangeType.Deleted</p><p><strong>Accept a change if it is a file length increase</strong><br/>event.CurrentAttributes.GetInt32("filelength") &gt; event.PreviousAttributes.GetInt32("filelength")</p><p><strong>Accept a change if fileattributes changes due to backup</strong> <br/>event.CurrentAttributes.GetInt32("fileattributes") &gt; 31</p><p><strong>Allow any filechange if the hash matches</strong><br/>event.CurrentAttributes.GetString("filehashsha1") == "AA5204D189CDD9410BC2B520560C5FE7DA5CB547"</p><p><strong>Accept a change to the Accounts: Rename administrator account setting if it contains EonAdmin</strong><br/>event.CurrentAttributes.GetString("se_newadministratorname").Contains("EonAdmin")                       <br/> <br/><strong>Accept any planned change which is an occurance of BadPasswordAttempts </strong><br/>event.CurrentAttributes.GetInt32("badpasswordattempts") != 0  </p><p><strong>Accept of an account's password expires (one rule for each).</strong><br/>event.CurrentAttributes. GetString("passwordexpired") != "False" <br/>event.CurrentAttributes.GetString("passwordexpired") != ("False") </p><p><strong>Accept is an account is enabled or disabled (one rule for each).</strong><br/>event.CurrentAttributes.GetString("enabled") == ("False")<br/>event.CurrentAttributes.GetString("enabled") == ("True")</p><p><strong>Accept a change to a registry key only if it has changed to a certain value (This uses only one rule).</strong></p><p>event.ItemName.StartsWith("hkey_local_machine\\system\\currentcontrolset\\control\\lsa\\test", StringComparison.InvariantCultureIgnoreCase) &amp; event.CurrentAttributes.GetInt32("regvalvalue") == 512</p><p><strong>Define a PC Rule to ignore changes in the inetpub folder, but any other filechanges will be processed by the regular WhiteListQuery match</strong><br/>(Note using the 'Rules for this planned change are combined using' AND, plus the rule order must be organised so that the file path check happens first, since we are aiming to head-off unnecessary FAST Cloud checks)<br/>The custom rule of 'Ignore Web File Changes' uses a Device Event, Filesystem tracker, File changes, and a Custom Match Type with the following expression (! applies the expression as a Not)<br/>!event.ItemName.StartsWith("C:\\inetpub<br class="atl-forced-newline"/>", StringComparison.InvariantCultureIgnoreCase)<br/><span class="confluence-anchor-link conf-macro output-inline" id="ChangeTrackerInfo-CustomPlannedChangeExamples-_GoBack"><span class="confluence-anchor-link" id="_GoBack"> </span></span><br class="atl-forced-newline"/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="131" width="631" src="kA04u0000000JZDCA2_578d23ad-941a-44b5-9c7f-3f287c104510.png"/></span> <br class="atl-forced-newline"/><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="231" width="588" src="kA04u0000000JZDCA2_4fd64f1e-b672-4b39-9013-b6a4f940f925.png"/></span></p><p><br/></p><p><strong>Create a planned change rule that accepts changes in multiple paths</strong></p><p>This change rule uses an OR ( In C++ | ) statement to accept changes from different paths which are being monitored. The below example will match all FIM changes made in the default CIS Windows templates</p><p>event.ItemName.StartsWith("C:\\windows\\system32", StringComparison.InvariantCultureIgnoreCase) | event.ItemName.StartsWith("C:\\windows\\syswow64", StringComparison.InvariantCultureIgnoreCase) | event.ItemName.StartsWith("C:\\Program Files", StringComparison.InvariantCultureIgnoreCase) | event.ItemName.StartsWith("C:\\Program Files (x86)", StringComparison.InvariantCultureIgnoreCase)</p><p>This rule can then be partnered with other rules such as fileusername or fileprocessname to provide more control over starts with path based planned changes.</p><p><br/></p></div>
</article></body></html>