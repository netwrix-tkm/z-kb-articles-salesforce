<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Use native multi-threading in Powershell DC</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000IuACAU"/><meta name="Id" content="ka04u000000Hcy6AAC"/><meta name="LastPublishedDate" content="2022-02-01T18:40:39.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:12:25.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:40:39.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7305"/><meta name="ArticleNumber" content="000007305"/><meta name="description" content="360008408371"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> In SMP 8.1, there is hidden functionality to enable multi-threading of powershell scripts. Here is how to use it:</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> Engineering has requested a way to allow for easy multi-threading in the powershell DC.  Development has created a hidden cmdlet named ForEach-Parallel that satisfies this request available in StealthAUDIT.</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> ForEach-Parallel<br/><br/>Takes in an input object and runs {ScriptBlock} on a configurable number of threads<br/><br/>Example:<br/>1..5 | ForEach-Parallel -Throttle 4 {<br/>    sleep(5);<br/>    "Time$_ is $(Get-Date)";<br/>}<br/>Time1 is 04/11/2017 17:09:59                                                                                <br/>Time2 is 04/11/2017 17:09:59                                                                                <br/>Time3 is 04/11/2017 17:09:59                                                                                <br/>Time4 is 04/11/2017 17:09:59                                                                                <br/>Time5 is 04/11/2017 17:10:04<br/><br/>In this example, we are instructing powershell to print the current system time.  Since we have limited it to running only 4 threads, you can see in the output that the first four timestamps are the same, followed later by the fifth after a 5 second sleep on all active threads.<br/><br/>Here is an additional example:<br/><img src="kA04u0000000IuACAU_07bc909e-3144-4fe1-a889-22eda7db41a8.png" alt="mceclip0.png" width="817" height="216"/><br/><br/></p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - PowerShell<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> All<br/><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SAT-1574<br/><strong><span class="wysiwyg-font-size-large">Resolved In:</span></strong> 8.1<br/><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 1563</p></div>
</article></body></html>