<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Hotfix:SIEntManager_SIWinConsole_4.1.0.678</title><meta name="label" content="skb"/><meta name="label" content="employees_v"/><meta name="KnowledgeArticleId" content="kA04u0000000ImMCAU"/><meta name="Id" content="ka04u000000HcvZAAS"/><meta name="LastPublishedDate" content="2022-02-01T18:31:01.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:11:08.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:31:01.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7138"/><meta name="ArticleNumber" content="000007138"/><meta name="description" content="360008877892"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> SIEM Integration issues; EM Errors seen at Capital One</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <strong><span>Summary:  </span></strong><br/>SI-3416 SIEM Integration issues<br/>SI-3417 EM Errors seen at Capital One<br/><strong><span>Before fix</span></strong><b>:</b>  <br/>SI-3416<br/>We currently terminate TCP based messages with 0x00 (vs 0x0a for UDP). This is not working for Capital one as they expect 0x0a. Also have problems with attribute data having embedded 0x0a such as for permission change events.<br/>SI-3417<br/>Errors in EM log:<br/>* Enterprise Manager recorded several, '. attributes can't be parsed messages .'<br/>*   Code assumes order old/new is same - may not be (why did order change?)<br/>*   ".Collection was modified; enumeration operation may not execute." messages which also look like a bug<br/>*     Async processing and multiple event consumers.<br/> <br/><strong><span>After fix:</span></strong><br/>SI-3416<br/><u>EOM:</u><br/>Previously it was impossible to set EndOfMessage bytes for SIEM messages sent by TCP or TCP/SSL. Now this can be configured inside SIEM template file using these lines in the template file:<br/>// ** For TCP and TCP/SSL protocols message buffer will be appended with bytes (in decimal format) enclosed in brackets. Value example: [13,10]. If this parameter is not set then by default it will use value [0]<br/>// TCP_EOM: [13,10]<br/> <br/><u>Line breaks:</u><br/>Previously all line break characters which can present in %ATTRIBUTE_VALUE% and %OLD_ATTRIBUTE_VALUE% were sent to SIEM Server without possibility to replace them with different string. Now this can be configured inside SIEM template file using these lines in the template file:<br/>// ** Line breaks in  %ATTRIBUTE_VALUE% and %OLD_ATTRIBUTE_VALUE% will be replaced with string enclosed in brackets. Value example: [some_separator]<br/>// LINEBREAK_REPLACEMENT: [!]<br/> <br/>SI-3417<br/>Two issues are fixed:<br/>1. Previously Enterprise Manager during preparing information for events with attributes for sending to SIEM used index of attribute in the list with new values and old values. This is incorrect, because soring of elements in these lists can be different. Now logic in this place changed to use name-based comparison instead of index-based.<br/>Also was identified and fixed place in SIAgent which can cause changes in the order of elements in attributes lists. But this is not required to use new Agent version because, as it was mentioned above, now EM will handle this case correctly.<br/>2. There was non thread-safe code in the copy constructor of NvMessageDict class. Now lock added to this place to avoid execution of this code by different threads simultaneously and use copy of the object as a parameter for creating another instance of the object before it will be fully initialized. <br/> <br/><strong><span>Submitted by: </span></strong><br/>Maxim Sidarau<br/><br/><strong><span>Affected Versions:</span></strong><br/>3.4.0      No Patch created at this time<br/>3.4.1      No Patch created at this time<br/>3.4.2      No Patch created at this time<br/>4.0.0      No Patch created at this time<br/>4.1.0      SIEntManager_SIWinConsole_4.1.0.678_SI-3416_SI-3417<br/> <br/><strong><span>Affected Module:</span></strong><br/>SI - Enterprise Manager<br/>SI - Win Console<br/> <br/><strong><span>Dev Ticket:</span></strong><br/>I-3050<br/>I-3051<br/><strong><span>Resolved in Version:</span></strong><br/>SI 4.1.0.678<br/><strong><span>KB Type: </span></strong><br/>Hotfix<br/> <br/><b>Escalations: </b>21884<br/><b>Customers: </b>Capital One<br/> </p><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> 1. Close the SI Win Console<br/>2. Stop 'SIEnterpriseManager' service.<br/>3. Extract files from attached 'SIWinConsole' folder to the C:\Program Files (x86)\STEALTHbits\StealthINTERCEPT\SIWinConsole folder<br/>4. Extract files from attached 'SIEnterpriseManager' folder to the C:\Program Files (x86)\STEALTHbits\StealthINTERCEPT\SIEnterpriseManager folder<br/>5. Start 'SIEnterpriseManager' service<br/>6. Start SI Win Console.<br/><br/><br/>  
</p><div class="table-wrap"><table count-columns="1" cellspacing="0" cellpadding="0" width="64" border="0"><tbody><tr height="20"><td colspan="1" rowspan="1" height="20" width="64"><a href="https://downloads.stealthbits.com/access/files/SIHotFixes/SI4.1.0/SIEntManager_SIWinConsole_4.1.0.678_SI-3416_SI-3417.zip" target="_blank">https://downloads.stealthbits.com/access/files/SIHotFixes/SI4.1.0/SIEntManager_SIWinConsole_4.1.0.678_SI-3416_SI-3417.zip</a></td></tr></tbody></table></div><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthINTERCEPT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SI - Admin Console;SI - Enterprise Manager<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 4.1.0<br/><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SI-3416, SI-3417<br/><strong><span class="wysiwyg-font-size-large">Resolved In:</span></strong> 4.1.0.678<br/><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 1744<br/></p></div>
</article></body></html>