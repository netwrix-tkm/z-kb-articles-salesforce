<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Hotfix: SA_8.1_128</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000IYeCAM"/><meta name="Id" content="ka04u000000HcqBAAS"/><meta name="LastPublishedDate" content="2022-02-01T18:26:09.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:08:20.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:26:09.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="6796"/><meta name="ArticleNumber" content="000006796"/><meta name="description" content="360012217852"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Fix Local Logged-on credentials being improperly used for SQL connections when credentials in the connection profile is denied access.</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <strong><span>Summary:</span></strong><br/><strong><span>Fix Local Logged-on credentials being improperly used for SQL connections when credentials in the connection profile is denied access.</span></strong><br/><strong><span>Behavior Before Fix: </span></strong><br/>When the credentials in the connection profile are not accepted, in some cases SA was reverting to the locally logged in credentials.<br/><strong><span>Behavior After Fix: </span></strong><br/>SA should now only use the credentials in the connection profile.<br/><strong><span>Submitted by: </span></strong><br/><strong><span>Rob Evert</span></strong><br/><strong><span>Affected Versions:</span></strong><br/><strong><span>8.1</span></strong><br/><strong><span>Affected Module:</span></strong><br/>SA - DC - SQL<br/>SA - Solution Set - SQL<br/> <br/><strong><span>Dev Ticket: </span></strong><br/><strong><span>SAT-4726/30961  SQL Permissions Query: Local Logged-on credentials improperly used for connections</span></strong><br/><strong><span>Resolved in Version:</span></strong><br/><strong><span>DCSQL.dll 8.1.309</span></strong><br/><strong><span>KB Type: </span></strong><br/><strong><i><span><span>Bug</span></span></i></strong><br/> <br/><strong><span><span><span>Modules Included</span></span></span></strong><br/> <br/>StealthAUDIT.exe                                                                                        8.1.848<br/> <br/>/DC<br/> -DCSQL.dll                                                                                                    8.1.309<br/> <br/>/Private Assemblies<br/> -Dapper.FluentMap.dll                                                                             1.6.0<br/> -Ninject.dll                                                                                                   3.3.3<br/> -SAJobEngine.dll                                                                                        8.1.320<br/> -Stealthbits.PowerShell.Common.dll                                                    8.1.46<br/> -Stealthbits.PowerShell.dll                                                                      8.1.46<br/> -Stealthbits.PowerShell.Server.exe                                                       8.1.46<br/> -Stealthbits.StealthAUDIT.ActionManager.dll                                    8.1.51<br/> -Stealthbits.StealthAUDIT.DataAnalysis.SqlScript.Core.dll              8.1.61<br/> -Stealthbits.StealthAUDIT.DataCollectors.dll                                     8.1.59<br/> -Stealthbits.StealthAUDIT.DataCollectors.PowerShell.dll               8.1.47<br/> -Stealthbits.StealthAUDIT.DataCollectors.PowerShell.UI.dll          8.1.47<br/> -Stealthbits.StealthAUDIT.DataCollectors.SQL.Common.dll           8.1.309<br/> -Stealthbits.StealthAUDIT.DataCollectors.SQL.dll                             8.1.309<br/> -Stealthbits.StealthAUDIT.DataCollectors.SQL.SQLServer.dll         8.1.309<br/> -Stealthbits.StealthAUDIT.DataCollectors.SQL.UI.dll                        8.1.309<br/> -Stealthbits.StealthAUDIT.DataCollectors.SQL.UI.SqlServer.dll  8.1.309<br/> -Stealthbits.StealthAUDIT.JobChanges.dll                                           8.1.11<br/> -Stealthbits.StealthAUDIT.Reporting.dll                                              8.1.210<br/> -Stealthbits.StealthAUDIT.RoleBasedAccess.dll                                 8.1.40<br/>/Jobs<br/> /GROUP_SQL<br/>  /GROUP_0.Collection<br/>   -Description<br/>   -GROUP_0.Collection<br/>   /JOB_0-SQL_InstanceDiscovery<br/>    -ActionsTasks.xml<br/>    -DataAnalysisTasks.XML<br/>    -Description.htm<br/>    -Description.txt<br/>    -JOB_0-SQL_InstanceDiscovery.XML<br/>   /JOB_1-SQL_ActivityScan<br/>    -ActionsTasks.xml<br/>    -DataAnalysisTasks.XML<br/>    -Description.htm<br/>    -Description.txt<br/>    -JOB_1-SQL_ActivityScan.XML<br/>    -Storage.ini<br/>   /JOB_1-SQL_PermissionsScan<br/>    -ActionsTasks.xml<br/>    -DataAnalysisTasks.XML<br/>    -Description.htm<br/>    -Description.txt<br/>    -JOB_1-SQL_PermissionsScan.XML<br/>   /JOB_1-SQL_SensitiveDataScan<br/>    -ActionsTasks.xml<br/>    -DataAnalysisTasks.XML<br/>    -Description.htm<br/>    -Description.txt<br/>    -JOB_1-SQL_SensitiveDataScan.XML<br/>   /JOB_1-SQL_ServerLogons<br/>    -DataAnalysisTasks.XML<br/>    -Description.htm<br/>    -Description.txt<br/>    -JOB_1-SQL_ServerLogons.XML<br/>    /Output<br/>     -Placeholder.txt<br/>   /JOB_1-SQL_ServerSettings<br/>    -ActionsTasks.xml<br/>    -DataAnalysisTasks.XML<br/>    -Description.htm<br/>    -Description.txt<br/>    -JOB_1-SQL_ServerSettings.XML<br/>    -RUNSTATS.INI<br/>    -RUNSTATS_PREV.INI<br/>    -Storage.ini<br/>    -VIEW_Configuration_Details.INI.xml<br/>    -VIEW_Messages.INI.xml<br/>    -VIEW_Server_Details.INI.xml<br/>    /Output<br/>     -Placeholder.txt<br/> <br/>/SP<br/> -SPSQLServer.DLL                                                                                       8.1.93<br/> /SQLScripts<br/>  -21_SaFixHostStatus.proc<br/>  -25_CleanupAndCompactJobLogs.proc<br/>  -EffectiveMembership.proc<br/>  -OneDcPerDomain.func<br/>  -OneGcPerDomain.func<br/>  -ProcessingHostListsTblTable.sql<br/>  -ProcessingMessagesTable.sql<br/>  -ProcessingSqlInstancesTable.sql<br/>  -SQLSchema.xml<br/> <br/>/Templates<br/> /*<br/> <br/>/Web<br/> -WebModules.dll                                                                                                      8.1.18<br/> -WebServer.exe                                                                                                         8.1.7     <br/> <br/><b>Customers</b><br/>Altria Client Services, LLC<br/> <br/><b>Cumulative List of fixes included since Service Pack:</b><br/><span><span><span>- SAT-3364  Fix for case sensitive Server Collation</span></span></span><br/><span><span><span>- SAT-3406  Remove query error from Instance removal utility</span></span></span><br/><span><span><span>- SAT-3311  Databases with locale id other than '1033' cause error</span></span></span><br/><span><span><span>- SAT-2905  SQL DC: Impersonation Issues </span></span></span><br/><span><span><span>- SAT-2779  Permissions / SDD will not work if the instance contains an offline db</span></span></span><br/><span><span><span>- SAT-2619  SQL SDD: UAC for File Operations causes scan failure</span></span></span><br/><span><span><span>- SAT-3143  SQL DC Uses Connection account to connect to SMP database</span></span></span><br/><span><span><span>- SAT-3532  SQL DC Custom queries not correctly handling columns names with spaces</span></span></span><br/><span><span><span>- SAT-3876  Sensitive Data and Permissions jobs blocking other SPIDs</span></span></span><br/><span><span><span>- SAT-4495  File not found error during SQL SEEK</span></span></span><br/><span><span><span>- SAT-4487  Backport SA 8.2 changes - refactored SQL DC and SQL UI</span></span></span><br/><span><span><span>- SAT-4462  SQL solution set reports contains deleted users</span></span></span><br/><span><span><span>- SAT-4549  Fix for SQL Server Audit Collection when Domain Groups are added as a SQL login</span></span></span><br/><span><span><span>- SAT-4021  Invalid Column name 'last_Scanned' upgrading from 8.1</span></span></span><br/> <br/><strong><span><span><span>YouTrack/Escalations</span></span></span></strong><br/> <br/><strong><span>SAT-4726/30961</span></strong><br/> </p><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <span><span><span>1. Unblock the hotfix zip file in the windows property dialog if an unblock button exists there. </span></span></span><br/><span><span><span>2. Close all instances of StealthAUDIT (check task manager under processes for all users)</span></span></span><br/><span><span><span>3. Exit StealthAUDIT console</span></span></span><br/><span><span><span>4. Copy and replace files from the included folder into SA Install dir.</span></span></span><br/><span><span><span>5. Open the properties of the StealthAUDIT\Jobs\GROUP_SQL\GROUP_0.Collection folder and unset read-only to the contents of the folder, subfolders and files.</span></span></span><br/><span><span><span>6. Clear / Delete directory C:\Program Files (x86)\STEALTHbits\StealthAUDITV5\Applet\Powershell on Target server, if that folder exists.</span></span></span><br/><span><span><span>7. If access errors appear on SA start, using the unregister and register DLL scripts found in the SA install DIR should remove the issue.</span></span></span><br/><br/>  
</p><div class="table-wrap"><table count-columns="1" cellspacing="0" cellpadding="0" width="64" border="0"><tbody><tr height="77"><td colspan="1" rowspan="1" height="77" width="64"><a href="https://downloads.stealthbits.com/access/files/SAHotFixes/8.1/SA_8.1_128.zip" target="_blank">https://downloads.stealthbits.com/access/files/SAHotFixes/8.1/SA_8.1_128.zip</a></td></tr></tbody></table></div><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - SQL<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 8.1<br/><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SAT-4726<br/><strong><span class="wysiwyg-font-size-large">Resolved In:</span></strong> DCSQL.dll 8.1.309<br/><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 2273<br/></p></div>
</article></body></html>