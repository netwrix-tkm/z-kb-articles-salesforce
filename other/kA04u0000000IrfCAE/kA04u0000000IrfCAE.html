<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Update a collection from a database table</title><meta name="label" content="skb"/><meta name="label" content="employees_v"/><meta name="KnowledgeArticleId" content="kA04u0000000IrfCAE"/><meta name="Id" content="ka04u000000HcxLAAS"/><meta name="LastPublishedDate" content="2022-02-01T18:36:40.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:12:06.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:36:40.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7247"/><meta name="ArticleNumber" content="000007247"/><meta name="description" content="360008304132"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> How to update a collection from a database table in StealthINTERCEPT</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <span><span><span>We have a feature in StealthINTERCEPT that allows you to update a collection from a database table. It is rather simple code but a working example you can leverage in your lab. I had a customer that needed to update a collection from a list of email addresses.  The first part of the email address is the logon name.  So the sample script allows them to update a dynamic collection in SI by reading their input file.</span></span></span><br/><span><span> </span></span><br/><span><span><span>It is nothing magical but feel free to modify or use in any examples as I have heard this request a number of times.  I tried to comment the code so it is easy to read.</span></span></span><br/> </p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <span><span><span>Called out a couple variables you can edit at the top of the file</span></span></span><br/><img src="kA04u0000000IrfCAE_db422280-8bec-4479-a9e2-a1ba62badda2.png" alt="mceclip2.png"/><br/><span><span><span>The file with email addresses looks like </span></span></span><br/><span><span><span><a href="mailto:email@address.com" target="_blank">email@address.com</a></span></span></span><br/><span><span><span><a href="mailto:email2@address.com" target="_blank">email2@address.com</a></span></span></span><br/><span><span> </span></span><br/><span><span><span>The just input your server, database name should be the same and table name you can get from SQL or SI</span></span></span><br/><span><span><span>Configuration | Collections | Perpetrators</span></span></span><br/><span><span><span>Click Manage</span></span></span><br/><span><span><span>Choose or add a new collection click edit or add</span></span></span><br/><span><span><span>Ensure the collection has the option I want a list to come from a database table</span></span></span><br/><img src="kA04u0000000IrfCAE_56628feb-da0b-40ea-87be-99fe77c62df4.png" alt="mceclip0.png"/><br/><span><span> </span></span><br/><span><span> </span></span><span><span><span>The dynamic collection table can be automatically created and must have a couple fields</span></span></span></p>
<ol><li><span><span><span>Distinguished Name</span></span></span></li><li><span><span><span>Object SID</span></span></span></li><li><span><span><span>Account Type</span></span></span></li><li><span><span><span>Subtree</span></span></span></li></ol>
<p><span><span> </span></span><img src="kA04u0000000IrfCAE_7ebbe6aa-a450-4992-92ec-ebfca5db3046.png" alt="mceclip3.png"/><br/><span><span> </span></span><br/><span><span><span>I put together a sample script for a customer that would </span></span></span><span><span> </span></span><span><span> </span></span></p>
<ol><li><span><span><span>Based on a list of email addresses it parses the string and uses everything before the @ symbol to look up the user by SAMAccount Name.</span></span></span></li><li><span><span><span>If the user is found it checks the DB Table to see if the users is already in the collection</span></span></span></li><li><span><span><span>If the user is not in the collection they are added</span></span></span></li></ol>
<p><span><span> </span></span><span><span><span>It does log if the user is not found in AD</span></span></span><br/><span><span><span>It does log if the user if the user is already in the collection</span></span></span><br/><img src="kA04u0000000IrfCAE_a282aca8-103a-4058-ac13-392a0c3953bf.png" alt="mceclip4.png"/><br/><span><span><span>Above is an example shows updating the db where only one user in the file was not found in AD</span></span></span><br/><span><span><span>Below shows adding 2 items</span></span></span><br/><span><span><span>Detecting 3 existing items</span></span></span><br/><span><span><span>1 item was not found on the AD lookup</span></span></span><br/><img src="kA04u0000000IrfCAE_bf64e395-b17b-402e-99f0-14ca4037bd6c.png" alt="mceclip6.png"/><br/><span><span> </span></span><br/><a href="http://downloads.stealthbits.com/access/files/Utilities/StealthINTERCEPT/DB%20Collection%20Update.ps1.zip" target="_blank">http://downloads.stealthbits.com/access/files/Utilities/StealthINTERCEPT/DB%20Collection%20Update.ps1.zip</a></p>
<p> </p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthINTERCEPT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SI - Admin Console;SI - Enterprise Manager<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> All<br/><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 2458</p></div>
</article></body></html>