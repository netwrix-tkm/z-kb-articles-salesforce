<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Hotfix: SA_9.0_087</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000J6aCAE"/><meta name="Id" content="ka04u000000Hd2kAAC"/><meta name="LastPublishedDate" content="2022-02-01T18:48:09.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:14:23.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:48:09.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7570"/><meta name="ArticleNumber" content="000007570"/><meta name="description" content="360012217872"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong>Summary: </strong> Add SharePoint Server Health Monitoring to log files. SPAA will log the current status of the SharePoint Server’s Health at the beginning of the scan. SPAA will then log any changes in the health status throughout the scan. Warnings will be thrown if SharePoint status reaches 4 or higher.</p>
<p><strong>Submitted by: </strong></p>
<p>Michael Burrofato</p>
<p><strong>Affected Versions:</strong></p>
<p>9.0</p>
<p><strong>Affected Module:</strong></p>
<p>SA – DC – SPAA</p>
<p><strong> </strong></p>
<p><strong>Dev Ticket:</strong></p>
<ul><li>SAFS-17585</li></ul>
<p><strong>Resolved in Version:</strong></p>
<ul><li>SPAA build 0.0.990</li></ul>
<p><strong>KB Type: </strong></p>
<p>               Hotfix</p>
<p><strong> </strong></p>
<p><strong>YouTrack/Escalations</strong></p>
<p><strong> </strong></p>
<p><strong>-              SAFS-17585</strong></p>
<p><strong> </strong></p>
<p><strong>Customers</strong></p>
<p><strong>-              N/A</strong></p>
<p><strong> </strong></p>
<p><strong>Cumulative List of fixes included since Service Pack:</strong></p>
<p><strong>-              SAFS-16926 SP SDD: Limit Stored matches option value is not being saved properly</strong></p>
<p><strong>-              SAFS-16937 SPAA - Query Config UI doesn't save Agent Identity Settings</strong></p>
<p><strong>-              SAFS-16964 Fix SPAA DC's 'Force admin' options for scanning SharePoint Online</strong></p>
<p><strong>-              SAFS-16963 Remove code in SPAA bulk import that removes/adds constraints</strong></p>
<p><strong>-              SAFS-16861 SPAA: Agentless SDD scans that don't have Scan Document Metadata checked fails to imports Matches and Match hits</strong></p>
<p>-              SAFS-16954 Deleted Subsites cause scans to hang infinitely</p>
<p>-              SAFS-16952 Deleted Files are throwing a File not found error (but still marked as deleted in t2 and t1)</p>
<p>-              SAFS-16988 SPAA Support Hierarchical Deletion of Users</p>
<p>-              SAFS-17004 SPAA: Hierarchical Resource Deletions is not working</p>
<p>-              SAFS-17001 SPAA: New scoping logic causes misleading results in the AIC</p>
<p>-              SAFS-16774 Agent Database Sync</p>
<p>-              SAFS-16999 SPAA - Remove UI Agent Setting "Use default Service Principal Name when agent service use local machine credentials"</p>
<p>-              SAFS-17065 36955 - Add percent completed in job log for SharePoint scans</p>
<p>-              SAFS-17121 SPAA: Refactor SQLite Storage assembly to remove unused conditional compilation directives</p>
<p>-              SAFS-17134 SPAA Performance Improvement: Cache SP SC, Site &amp; List objects for thread reuse in agent query assembly</p>
<p>-              SAFS-17188 SPAA: Add appropriate indexes and use prepared statements in SQLite queries to increase performance</p>
<p>-              SAFS-17143 SPAA Performance Improvement: Update progress reporting to not query database</p>
<p>-              SAFS-17142 SPAA Performance Improvement: Update progress reporting to run once a minute instead of every 10 seconds</p>
<p>-              SAFS-17216 SPAA: Subsequent scans start at 100% completed (status message)</p>
<p>-              SAFS-17119 Enhance SPAA DC to support scoped scans which do not query the SPO Admin center</p>
<p>-              SAFS-17244 Improved SharePoint scoping - allow inclusion/exclusions of URLs down to files</p>
<p>-              SAFS-16951 38203 - SPAA Import error: Unable to perform Bulk Import due to duplicate key row (Duplicate SID error)</p>
<p>-              SAFS-17284 SPAA Scoping - Fix URL escapes in scoping options</p>
<p>-              SAFS-17289 SPAA: New file-level scan scoping does not properly exclude files</p>
<p>-              SAFS-17225 SPAA: Migrating from 8.2 to 9.0+ does not upgrade scoping options.</p>
<p>-              SAFS-17394 SPAC scans failing: Failed to get Trustee ID: SQL logic error cannot start a transaction within a transaction"</p>
<p>-              SAFS-17397 Upgrades within SA versions cause null pointer error</p>
<p>-              SAFS-17398 SPAA: Old scoping options not respected unless walk thru the DC wizard.</p>
<p>-              SAFS-17297 SPAA: 9.0 Performance Regression (agent improvements)</p>
<p>-              SAFS-17442 SPAA Performance: File content being retrieved when not required</p>
<p>-              SAFS-17479 SPAA Groups returning inconsistent TrusteeType values</p>
<p>-              SAFS-17498 SPAA - Add re-authentication capability in the event that a 500 error is thrown to get a new session token</p>
<p>-              SAFS-17534 Add debug logging for HTTP responses during SPO scans.</p>
<p>-              SAFS-17465 Improve SPAA's Logging: Short circuit logging</p>
<p>-              SAFS-17343 Improve SPAA's logging - logs are getting too big in customer environments.</p>
<p>-              SAFS-17447 SPAA: Performance - Combine sharing and sharing users queries in local mode scans</p>
<p>-              SAFS-17529 39586 - On-Prem SP ConnectTo Issues</p>
<p>-              SAFS-17631 Test SPAC with new ActivityTypes.dll in 9.0 and 10.0</p>
<p>-              SAFS-17573 SPAA: Scans hang indefinitely, only showing "Checkpoint" messages in logs</p>
<p>-              SAFS-16792 Enhance SPAA to use 'exponential back-off' to avoid SharePoint Online throttling</p>
<p>-              SAFS-17416 SPAA: Do not populate MatchHits if 'Store discovered sensitive data' option is turned off.</p>
<p>-              SAFS-17419 SPAC Scans are missing data and leaving behind Wal and Shm files.</p>
<p>-              SAFS-17739 Address flaws with modern auth scans</p>
<p>-              SAFS-17730 SPAA: Not marking children as deleted if parent DeletedUSN value not equal to current USN</p>
<p>-              SAFS-17904 40347/40574 - Bulk Import Error: Foreign Key Same Table Constraint</p>
<p>-              SAFS-17763 SPAA: Toggling Agent mode scans on/off should change AD/ADI setting (merging)</p>
<p>-              SAFS-17983 SPAA - Forms Based Auth Support Broken</p>
<p>-              SAFS-18098 41463 - SPSEEK - SPO - Scans hang at certain depth and have an issue restarting</p>
<p>-              SAFS-18082 SPAA: Fix local principals being marked as domain principals</p>
<p>-              SAFS-18221 SPAA: Bug found with Web-app policy collection</p>
<p>-              SAFS-18532 SPAA scans are marking web applications as deleted</p>
<p>-              SAFS-18637 SPAA: Add debug logging around SSL connection code</p>
<p><strong>-              </strong>SAFS-18788 SPAA: Add more logging around SSL connection</p>
<p>-              SAFS-18672 50188 - Unable to perform SP Bulk Import</p>
<p><strong>-              </strong>SAFS-18517 135 - Add option to enable or disable differential scans to the SPAA DC UI</p>
<p>-              SAFS-18716 SPAA: Duplicate key issues<br/> <strong>-              </strong>SAFS-18943 51078 - SPO scan errors: "Unable to establish connection for resource... ...ThreadID:XX"</p>
<p><strong>-              </strong>SAFS-19027 51375 - SP Activity BI errors</p>
<p>-              SAFS-18594 SPAC is rewriting resource types for document libraries to lists</p>
<p>-              SAFS-19207 51915 - SPSEEK bulk import fails with PK constraint: Cannot insert duplicate key in object 'dbo.SA_SPDLP_MatchHits'</p>
<p>-              SAFS-19223 51977 - SharePoint Tier 2 DB bulk imports performance decrease importing SA_SPDLP_Matches</p>
<p> </p>
<p><strong>Changes since last Hotfix:</strong></p>
<p><strong>-              </strong>SAFS-17585 SPAA - Add SharePoint Server Health Monitoring to log files</p>
<p> </p>
<p><strong>Comments:</strong></p>
<p><strong>THIS HOTFIX HAS A PREREQUISITE OF HOTFIX <u>SA_9.0_018</u>. PLEASE APPLY THAT HOTFIX PRIOR TO APPLYING THIS ONE. SEE KB FOR THAT HOTFIX FOR MORE DETAILS</strong></p>
<p><strong>Instructions:</strong></p>
<ol><li><strong>Unblock the hotfix zip file in the windows property dialog, if an unblock button exists there. </strong></li><li>Close all instances of StealthAUDIT (check task manager under processes for all users)</li><li><strong>Update all DC files in your %SAInstallDir%DC folder</strong></li><li><strong>Update all PrivateAssemblies in your %SAInstallDir%PrivateAssemblies folder.</strong></li><li><strong>Update all Agent files in your %SAInstallDir%Agent folder</strong></li><li><strong>If using Agent mode, please install SPAA Agent version 9.0.0.45 or later</strong></li></ol>
<p><strong><a href="https://downloads.stealthbits.com/access/files/SAHotFixes/9.0/SA_9.0_087.zip" target="_blank">https://downloads.stealthbits.com/access/files/SAHotFixes/9.0/SA_9.0_087.zip</a></strong></p>
<p> </p></div>
</article></body></html>