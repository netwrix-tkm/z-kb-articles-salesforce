<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>How to identify StealthINTERCEPT Events with known long string values that could be causing unexpected database growth.</title><meta name="label" content="skb"/><meta name="label" content="employees_v"/><meta name="KnowledgeArticleId" content="kA04u0000000Iw6CAE"/><meta name="Id" content="ka04u000000HcylAAC"/><meta name="LastPublishedDate" content="2022-02-01T18:42:52.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:12:39.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:42:52.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7341"/><meta name="ArticleNumber" content="000007341"/><meta name="description" content="360008304132"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> There are a few known attributes that generate very long string values. These can cause the StealthINTERCEPT database to grow very large and these events might not be needed\useful.</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <span>Unexpected SI DB Growth\Size due to NVMonitorData.dbo.AttributeValue growing very large.</span></p>
<pre><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <span><span><strong>:  </strong>If the NVMonitorData.dbo.AttributeValue is experiencing a lot of growth run the Sql script below to identify the attributes with known long strings values and which policies are responsible for collecting this information.  You can put  Attributes exclusions in these policies to stop StealthINTERCEPT from collecting these events.  This will stop us from collecting these events moving forward.  StealthINTERCEPT Maintenance should remove these events once the data retention period is reached.</span></span><br/><br/><br/><span><span><span><span><span>SELECT</span></span></span><span><span><span> Top 1000 </span></span></span></span></span><br/><span><span><span><span><span>A</span></span></span><span><span><span>.</span></span></span><span><span><span>[eventId]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>[attributeId]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>[attributeName]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>[formattedAttributeName]</span></span></span></span></span><br/><span><span>     <span><span><span>,</span></span></span><span><span><span>[operation]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>[isOld]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>[valueSyntax]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>DATALENGTH</span></span></span><span><span><span>(</span></span></span><span><span><span>formattedStringValue</span></span></span><span><span><span>)</span></span></span> <span><span><span>'String Length'</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>p</span></span></span><span><span><span>.</span></span></span><span><span><span>[name] </span></span></span><span><span><span>'Policy Name'</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>[stringValue]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>[formattedStringValue]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>[numericValue]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>[formattedNumericValue]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>[dateTimeValue]</span></span></span></span></span><br/><span><span>      <span><span><span>,</span></span></span><span><span><span>A</span></span></span><span><span><span>.</span></span></span><span><span><span>[utcTimeLogged]</span></span></span></span></span><br/><span><span><span><span><span>FROM</span></span></span><span><span><span> [NVMonitorData]</span></span></span><span><span><span>.</span></span></span><span><span><span>[dbo]</span></span></span><span><span><span>.</span></span></span><span><span><span>[AttributeValue] A</span></span></span></span></span><br/><span><span>  <span><span><span>join</span></span></span><span><span><span> [NVMonitorData]</span></span></span><span><span><span>.</span></span></span><span><span><span>[dbo]</span></span></span><span><span><span>.</span></span></span><span><span><span>[EventPolicy] E</span></span></span></span></span><br/><span><span>  <span><span><span>on</span></span></span><span><span><span> A</span></span></span><span><span><span>.</span></span></span><span><span><span>eventId </span></span></span><span><span><span>=</span></span></span><span><span><span> E</span></span></span><span><span><span>.</span></span></span><span><span><span>eventId</span></span></span></span></span><br/><span><span>  <span><span><span>join</span></span></span><span><span><span>  [NVMonitorConfig]</span></span></span><span><span><span>.</span></span></span><span><span><span>[dbo]</span></span></span><span><span><span>.</span></span></span><span><span><span>[Policy] p</span></span></span></span></span><br/><span><span>  <span><span><span>on</span></span></span><span><span><span> p</span></span></span><span><span><span>.</span></span></span><span><span><span>[policyId] </span></span></span><span><span><span>=</span></span></span><span><span><span> E</span></span></span><span><span><span>.</span></span></span><span><span><span>[policyId]</span></span></span></span></span><br/><span><span>  <span><span><span>--This script looks for attributes with known long string values.  The Section below can be commented out to look for all attribute lengths.</span></span></span></span></span><br/><span><span>  <span><span><span>Where</span></span></span><span><span><span> [attributeName] </span></span></span><span><span><span>in</span></span></span></span></span><br/><span><span>                                                       <span><span><span>(</span></span></span><span><span><span>'mSMQSignCertificates'</span></span></span></span></span><br/><span><span>                                                       <span><span><span>,</span></span></span><span><span><span>'mSMQDigests'</span></span></span>      </span></span><br/><span><span>                                                       <span><span><span>,</span></span></span><span><span><span>'msExchMailboxSecurityDescriptor'</span></span></span></span></span><br/><span><span>                                                       <span><span><span>,</span></span></span><span><span><span>'userCertificate'</span></span></span>  </span></span><br/><span><span>                                                       <span><span><span>,</span></span></span><span><span><span>'msExchSafeSendersHash'</span></span></span>  </span></span><br/><span><span>                                                       <span><span><span>,</span></span></span><span><span><span>'ProxyOverride (id: ProxyOverride)'</span></span></span>    </span></span><br/><span><span>                                                       <span><span><span>,</span></span></span><span><span><span>'msExchBlockedSendersHash'</span></span></span></span></span><br/><span><span>                                                       <span><span><span>,</span></span></span><span><span><span>'msDS-BridgeHeadServersUsed'</span></span></span>    </span></span><br/><span><span>                                                       <span><span><span>,</span></span></span><span><span><span>'Settings Page Visibility'</span></span></span></span></span><br/><span><span>                                                       <span><span><span>,</span></span></span><span><span><span>'gPLink'</span></span></span><span><span><span>)</span></span></span></span></span><br/><span><span><span><span><span>--</span></span></span><span><span><span>Comment out to here to look at all length name of all attributes</span></span></span></span></span><br/><span><span><span><span><span>Order</span></span></span> <span><span><span>by</span></span></span><span><span><span> [String Length] </span></span></span><span><span><span>desc</span></span></span></span></span><br/> </pre>
<p> </p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthINTERCEPT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SI - Admin Console;SI - Alerts;SI - Enterprise Manager;SI - Exchange Agent;SI - File System Agent;SI - Installer;SI - Policy;SI - SIEM Integration;SI - Web Reporting<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 6.0, 6.1, 7.0, 7.1<br/><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 2419</p></div>
</article></body></html>