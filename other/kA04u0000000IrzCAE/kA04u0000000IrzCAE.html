<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>'Select' errors with NetApp/fPolicy</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000IrzCAE"/><meta name="Id" content="ka04u000000HcxQAAS"/><meta name="LastPublishedDate" content="2022-02-01T18:37:09.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:12:09.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:37:09.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7262"/><meta name="ArticleNumber" content="000007262"/><meta name="description" content="360008408371"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Resolving 'select' errors on NetApp devices using network logging on the filer</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> An issue arose at a customer where it was possible to use FSAM to configure activity collection from a NetApp filer, everything appeared to work, except no events arrived. The StealthAUDIT logs showed that the StealthAUDIT components were connected and awaiting events, the NetApp logs showed error messages with the text <i>'select timed out'</i>. The SMP server and NetApp device were both checked and had no firewalls enables. The customer's storage representative was adamant that because this was a lab environment there were no other port blocking devices in the network and the issue was with StealthAUDIT.</p><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <span><span><span>In this instance the 'select' mentioned in the error text is a reference to the network socket API select function which is used by the NetApp device. Knowing this we were convinced that there must be additional network filtering in place external to both devices and blocking.</span><br/><span>With a little googling we found that NetApp devices have a command to create a network trace on the network side. The command is pktt, and KB articles for ontap 7 and 8 are below.</span></span></span><br/><span><span><span><a href="https://kb.netapp.com/support/s/article/ka31A0000000kT4QAI/how-to-collect-a-network-trace-with-pktt-in-data-ontap-7-mode?language=en_US" target="_blank"><span><span>https://kb.netapp.com/support/s/article/ka31A0000000kT4QAI/how-to-collect-a-network-trace-with-pktt-in-data-ontap-7-mode?language=en_US</span></span></a></span></span></span><br/><span><span><span><a href="https://kb.netapp.com/support/s/article/ka31A00000013MbQAI/how-to-capture-packet-traces-on-data-ontap-8-cluster-mode-systems?language=en_US" target="_blank"><span><span>https://kb.netapp.com/support/s/article/ka31A00000013MbQAI/how-to-capture-packet-traces-on-data-ontap-8-cluster-mode-systems?language=en_US</span></span></a></span></span></span><br/><br/><span><span><span><span>Using pktt on the </span></span></span>In this instance the 'select' mentioned in the error text is a reference to the network socket API select function which is used by the NetApp device. Knowing this we were convinced that there must be additional network filtering in place external to both devices and blocking.</span><br/><span><span>With a little googling we found that NetApp devices have a command to create a network trace on the network side. The command is pktt, and KB articles for ontap 7 and 8 are below.</span></span><br/><span><span><span><a href="https://kb.netapp.com/support/s/article/ka31A0000000kT4QAI/how-to-collect-a-network-trace-with-pktt-in-data-ontap-7-mode?language=en_US" target="_blank"><span><span>https://kb.netapp.com/support/s/article/ka31A0000000kT4QAI/how-to-collect-a-network-trace-with-pktt-in-data-ontap-7-mode?language=en_US</span></span></a></span></span></span><br/><span><span><span><a href="https://kb.netapp.com/support/s/article/ka31A00000013MbQAI/how-to-capture-packet-traces-on-data-ontap-8-cluster-mode-systems?language=en_US" target="_blank"><span><span>https://kb.netapp.com/support/s/article/ka31A00000013MbQAI/how-to-capture-packet-traces-on-data-ontap-8-cluster-mode-systems?language=en_US</span></span></a></span></span></span><br/><span><span>Using pktt on the NetApp device and wireshark on the StealthAUDIT host, we were able to trace and compare network activity at both ends of the wire and clearly show that the NetApp was sending packets that our host was not receiving. At this point the customer did some more research and discovered that there was a firewall in place that was passing some, but not all ports.</span></span><br/><br/><span><span>Hopefully most customers will accept the explanation that a select timeout error on the NetApp device is a network error, most likely caused by a firewall. For any that don't the technique described here should be convincing.</span></span><br/>Â </p><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> File Activity Monitor - NetApp;SA - Solution Set - File System<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> All versions<br/><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 1527<br/></p></div>
</article></body></html>