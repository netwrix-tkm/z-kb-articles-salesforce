<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Hotfix: SA_8.0_009</title><meta name="label" content="skb"/><meta name="label" content="employees_v"/><meta name="KnowledgeArticleId" content="kA04u0000000IZuCAM"/><meta name="Id" content="ka04u000000HcqbAAC"/><meta name="LastPublishedDate" content="2022-02-01T18:52:04.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:08:36.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:52:04.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7858"/><meta name="ArticleNumber" content="000007858"/><meta name="description" content="360012326291"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Unable to run SPAA scans</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <strong><span>Modules Included</span></strong><br/> <br/> <br/><strong><span>StealthAUDIT\SBSPOSvr.exe - 7.2.26.681</span></strong><br/><strong><span>StealthAUDIT\SBSPOSvr.exe.xml</span></strong><br/><strong><span>StealthAUDIT\Agent\*</span></strong><br/><strong><span>StealthAUDIT\DC\DCSPAA.dll - 8.0.134.626</span></strong><br/><strong><span>StealthAUDIT\DC\SPAAConfig.xml</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Microsoft.Online.SharePoint.Client.Tenant.dll - 15.0.4569.1506</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Microsoft.SharePoint.Client.dll - 15.0.4569.1000</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Microsoft.SharePoint.Client.Runtime.dll- 15.0.4569.1000</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Microsoft.SharePoint.Client.UserProfiles.dll - 15.0.4569.1000</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\SATagParser.dll - 8.0.9.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.SharePoint.dll - 1.2.79.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.Agent.dll - 8.0.4.624</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.Agent.Client.dll - 8.0.4.624</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.dll - 8.0.55.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.DLP.Common.dll - 8.0.18.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.Agent.Common.dll - 8.0.7.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.Common.dll - 8.0.15.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.dll - 8.0.160.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.Query.CSOM.dll - 8.0.22.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.Query.CSOM.dll.config -n/a</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.Query.Database.dll - 8.0.11.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.Storage.dll - 8.0.22.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.SPAA.UI.dll - 8.0.139.626</span></strong><br/><strong><span>StealthAUDIT\PrivateAssemblies\Stealthbits.StealthAUDIT.DataCollectors.UI.dll - 8.0.52.626</span></strong><br/> <br/><strong><span>YouTrack/Escalations</span></strong><br/> <br/><strong><span>SASP-1841 17122 - Unable to run SPAA scans</span></strong><br/> <br/> <br/><strong><span>Cumulative List of fixes included since Release:</span></strong><br/><strong><span>RMT/YouTrack     Description</span></strong><br/> <br/><strong><span>SASP-1347           BOX DC BI Fixes</span></strong><br/><strong><span>SASP-1344           SPAA fix for error:System.UriFormatException</span></strong><br/><strong><span>SASP-1329           SPAA CSOM fix for trustee type determination and BI treustee key violation</span></strong><br/><strong><span>SASP-1399           SPAA 2010 on-prem fixes</span></strong><br/><strong><span>SASP-1395           SPAA merge of tier 1 trustee table</span></strong><br/><strong><span>SAP-1442             SPAA onprem SP2013 bulk import bug fixes - fix for null reference in bug extract base</span></strong><br/><strong><span>SASP-1446           SPAA enhancement to force accoutn as site admin for inaccessible personal sites </span></strong><br/><strong><span>SASP-1505           SPAA identify SPO version distinct from 2016</span></strong><br/><strong><span>SASP-1507           collect title of personal site collections</span></strong><br/><strong><span>SASP-1307           SPAA .net 4 version of common assemblies.</span></strong><br/><strong><span>SASP-1389           SPAA missing domain groups</span></strong><br/><strong><span>SASP-1532           SPAA fix for SPO scans, fix for .net versions bug.</span></strong><br/><strong><span>SPAA-1457          SPAA document tag scanning</span></strong><br/><strong><span>SASP-1580           SPAA adding logging to Query assemblies.</span></strong><br/><strong><span>SASP-1572           Add Personal Sites Web App to SPO, SASP-1563 Roll back SPO version prefix.</span></strong><br/><strong><span>SASP-1593           SPAA sanitization of CSOM query assembly URLs</span></strong><br/><strong><span>SASP-1512           SPAA fix for trustee bug with web applications</span></strong><br/><strong><span>SASP-1606           SPAA add support for Everyone Except External Users role</span></strong><br/><strong><span>SASP-1446           fix personal site force admin bug</span></strong><br/><strong><span>SASP-1604           SPAA fix for un-named site collections</span></strong><br/><strong><span>SASP-1625           SPAA fix for 7.2-&gt;8.0 upgrade errors during bulk import</span></strong><br/><strong><span>SASP-1642           SPAA document libraries missing from SPO </span></strong><br/><strong><span>SASP-1641           SPAA SPO missing one drive content for personal sites</span></strong><br/><strong><span>SASP-1663           SPAA fix web app scoping in CSOM query assembly</span></strong><br/><strong><span>SASP-1681           SPAA SPO bug fix duplicate sites under personal site collections</span></strong><br/><strong><span>SPAA-1671          SPAA fix for enumeraton of folders under generic lists</span></strong><br/><strong><span>SASP-1716           SPAA fix tag parsing in agent.</span></strong><br/><strong><span>SASP-1765           16440 - SPAA Memory consumption</span></strong><br/><strong><span>SASP-1780           16590 - SPAA fix bug in agent communication error handling code</span></strong><br/><strong><span>SASP-1736           SPAA improvements to tag error logging</span></strong><br/><strong><span>SASP-1795           fix for SPAA fix Site Collection SPObjectID bug in 7.2, 8.0, and 8.1</span></strong><br/><strong><span>SASP-1767           SPAA agent service auto-reset</span></strong><br/><strong><span>SASP-1782           improved agent wcf error  handling</span></strong><br/><strong><span>SASP-1704           Improvements to NULL handling in SPAA database.</span></strong><br/><strong><span>SASP-1827           SPAA fix for bug with files without authors</span></strong><br/><strong><span>SASP-1809           SPAA fix for bug with DLP scan loosing TAG scan data.</span></strong><br/><strong><span>SASP-1807           SPAA improvements to timeouts and stream memory management copying remote files for DLP and tag parsing.</span></strong><br/><strong><span>SASP-1796           SPAA minor improvements to tag parsing related logging</span></strong><br/><strong><span>SASP-1414           addresses a bug in the code where an error in the sql server transaction rollback could "eat" an error which caused the scan to abort - now both errors will be logged. Also                                        increases the rollback timeout to 15 minutes from 15 seconds.</span></strong><br/><strong><span>SASP-1796           SPAA update assembly version for tag parser logging changes.</span></strong><br/><strong><span>SASP-1874           SPO DC fix SBSPOSvr communication error due to callbacks on disconnected sessions.</span></strong><br/><strong><span>SASP-1895           Support for forms authentication at the site collection level</span></strong><br/><strong><span>SASP-1885           SPAA bulk import fox for null role definitions</span></strong><br/><strong><span>SASP-1861           fix SID related claim parsing error is server query assembly, SASP-1900  fix concurrently issue loading query assemblies</span></strong><br/><strong><span>SASP-1916           SASP fix dlp initialization errors not being logged</span></strong><br/><strong><span>SASP-1796           16977 - SPAA Local-Mode Scans | Tags partially collected with SATagParser.dll: 80 or 110 errors</span></strong><br/><strong><span>SASP-1823           8.0 agentless SPAA scans not collecting AD Groups</span></strong><br/><strong><span>                                Updated the CAML query to collect both users and groups for 2010 SharePoint farms.   </span></strong><br/><strong><span>SASP-1874           SPO DC fix SBSPOSvr communication error due to callbacks on disconnected sessions.</span></strong><br/><strong><span>SASP-1895           Support for forms authentication at the site collection level</span></strong><br/><strong><span>SASP-1885           SPAA bulk import fox for null role definitions</span></strong><br/><strong><span>SASP-1936           Fix connection errors and improve connection logging</span></strong><br/><strong><span>SASP-1949           added error message text to logging of "connection retry" errors.</span></strong><br/> </p><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <strong><span>1. Exit StealthAUDIT console</span></strong><br/><strong><span>2. Update all DC files in your StealthAUDIT\DC directory</span></strong><br/><strong><span>3. Update all PrivateAssemblies files in your StealthAUDIT\PrivateAssemblies director</span></strong><br/><strong><span>4. Update the SBSPOSvr.exe and config files in the StealthAUDIT\ root directory</span></strong><br/><strong><span>5. Stop Agent service on SharePoint Server</span></strong><br/><strong><span>6. If updating an agent on SharePoint 2010: update the files in Agent installation directory with the DLLs in the NET35 Folder</span></strong><br/><strong><span>If updating an agent on SharePoint 2013: update the files in Agent installation directory with the DLLs in the NET40 Folder</span></strong><br/><strong><span>7. Restart the Agent service on the SharePoint Server</span></strong><br/><br/>  
</p><div class="table-wrap"><table count-columns="1" cellspacing="0" cellpadding="0" width="64" border="0"><colgroup><col width="64"/></colgroup><tbody><tr height="20"><td colspan="1" rowspan="1" class="xl64" height="20" width="64"><a href="http://downloads.stealthbits.com/access/files/SAHotFixes/8.0/SA_8.0_009.zip" target="_blank">http://downloads.stealthbits.com/access/files/SAHotFixes/8.0/SA_8.0_009.zip</a></td></tr></tbody></table></div><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - SPAA - Activity;SA - DC - SPAA - Permissions<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 8.0<br/><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SASP-1841<br/><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 1618<br/></p></div>
</article></body></html>