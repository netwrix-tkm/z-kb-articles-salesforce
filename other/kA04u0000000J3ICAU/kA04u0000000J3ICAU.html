<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Hotfix: SA_9.0_030</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000J3ICAU"/><meta name="Id" content="ka04u000000Hd1QAAS"/><meta name="LastPublishedDate" content="2022-02-01T18:50:43.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:13:51.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:50:43.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7769"/><meta name="ArticleNumber" content="000007769"/><meta name="description" content="360012217872"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Enhance SPAA to use 'exponential back-off' to avoid SharePoint Online throttling</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <span><span><span><strong><span>Summary: </span></strong> Enhance SPAA to use 'exponential back-off' to avoid SharePoint Online throttling</span></span></span><br/><span><span><span><strong><span>Before Fix: SPO scans will be throttled if you send a lot of requests at once.</span></strong></span></span></span><br/><span><span><span><strong><span>After fix: </span></strong><span><span><span><span><span>SPAA can recognize that a throttle is going to be hit and leverage the exponential backoff technique to avoid hitting a throttle.</span></span></span></span></span></span></span></span><br/><span><span><span><strong><span>Submitted by: </span></strong></span></span></span><br/><span><span><span><span><span class="MsoSubtleEmphasis"><span>Michael Burrofato</span></span></span></span></span></span><br/><span><span><span><strong><span>Affected Versions:</span></strong></span></span></span><br/><span><span><span>9.0</span></span></span><br/><span><span><span><strong><span>Affected Module:</span></strong></span></span></span><br/><span><span><span>SA - DC - SPAA</span></span></span><br/><br/><span><span><span><strong><span>Dev Ticket:</span></strong></span></span></span> 
</p><ul><li><span><span><span><span>SAFS-16792</span></span></span></span></li></ul><span><span><span><strong><span>Resolved in Version:</span></strong></span></span></span> 
<ul><li><span><span><span><span class="MsoSubtleEmphasis"><span>SPAA build                                  9.0.0.822</span></span></span></span></span></li></ul><span><span><span><strong><span>KB Type: </span></strong></span></span></span><br/><span><span><span class="MsoSubtleEmphasis"><span>                Hotfix</span></span></span></span><br/><br/><span><span><strong><span>YouTrack/Escalations</span></strong></span></span><br/><br/><span><span><strong><span>-              SAFS-16792, SAFS-17667 - 40328</span></strong></span></span><br/><br/><span><span><strong><span>Customers</span></strong></span></span><br/><span><span><strong><span>-              N/A</span></strong></span></span><br/><br/><span><span><strong><span>Cumulative List of fixes included since Service Pack:</span></strong></span></span><br/><span><span><span><strong><span>-              SAFS-16926 SP SDD: Limit Stored matches option value is not being saved properly</span></strong></span></span></span><br/><span><span><span><strong><span>-              SAFS-16937 SPAA - Query Config UI doesn't save Agent Identity Settings</span></strong></span></span></span><br/><span><span><span><strong><span>-              SAFS-16964 Fix SPAA DC's 'Force admin' options for scanning SharePoint Online</span></strong></span></span></span><br/><span><span><span><strong><span>-              SAFS-16963 Remove code in SPAA bulk import that removes/adds constraints</span></strong></span></span></span><br/><span><span><span><strong><span>-              SAFS-16861 SPAA: Agentless SDD scans that don't have Scan Document Metadata checked fails to imports Matches and Match hits</span></strong></span></span></span><br/><span><span><span>-              SAFS-16954 Deleted Subsites cause scans to hang infinitely</span></span></span><br/><span><span><span>-              SAFS-16952 Deleted Files are throwing a File not found error (but still marked as deleted in t2 and t1)</span></span></span><br/><span><span><span>-              SAFS-16988 SPAA Support Hierarchical Deletion of Users</span></span></span><br/><span><span><span>-              SAFS-17004 SPAA: Hierarchical Resource Deletions is not working</span></span></span><br/><span><span><span>-              SAFS-17001 SPAA: New scoping logic causes misleading results in the AIC</span></span></span><br/><span><span><span>-              SAFS-16774 Agent Database Sync</span></span></span><br/><span><span><span>-              SAFS-16999 SPAA - Remove UI Agent Setting "Use default Service Principal Name when agent service use local machine credentials"</span></span></span><br/><span><span><span>-              SAFS-17065 36955 - Add percent completed in job log for SharePoint scans</span></span></span><br/><span><span><span>-              SAFS-17121 SPAA: Refactor SQLite Storage assembly to remove unused conditional compilation directives</span></span></span><br/><span><span><span>-              SAFS-17134 SPAA Performance Improvement: Cache SP SC, Site &amp; List objects for thread reuse in agent query assembly</span></span></span><br/><span><span><span>-              SAFS-17188 SPAA: Add appropriate indexes and use prepared statements in SQLite queries to increase performance</span></span></span><br/><span><span><span>-              SAFS-17143 SPAA Performance Improvement: Update progress reporting to not query database</span></span></span><br/><span><span><span>-              SAFS-17142 SPAA Performance Improvement: Update progress reporting to run once a minute instead of every 10 seconds</span></span></span><br/><span><span><span>-              SAFS-17216 SPAA: Subsequent scans start at 100% completed (status message)</span></span></span><br/><span><span><span>-              SAFS-17119 Enhance SPAA DC to support scoped scans which do not query the SPO Admin center</span></span></span><br/><span><span><span>-              SAFS-17244 Improved SharePoint scoping - allow inclusion/exclusions of URLs down to files</span></span></span><br/><span><span><span>-              SAFS-16951 38203 - SPAA Import error: Unable to perform Bulk Import due to duplicate key row (Duplicate SID error)</span></span></span><br/><span><span><span>-              SAFS-17284 SPAA Scoping - Fix URL escapes in scoping options</span></span></span><br/><span><span><span>-              SAFS-17289 SPAA: New file-level scan scoping does not properly exclude files</span></span></span><br/><span><span><span>-              SAFS-17225 SPAA: Migrating from 8.2 to 9.0+ does not upgrade scoping options.</span></span></span><br/><span><span><span>-              SAFS-17394 SPAC scans failing: Failed to get Trustee ID: SQL logic error cannot start a transaction within a transaction"</span></span></span><br/><span><span><span>-              SAFS-17397 Upgrades within SA versions cause null pointer error</span></span></span><br/><span><span><span>-              SAFS-17398 SPAA: Old scoping options not respected unless walk thru the DC wizard.</span></span></span><br/><span><span><span>-              SAFS-17297 SPAA: 9.0 Performance Regression (agent improvements)</span></span></span><br/><span><span><span>-              SAFS-17442 SPAA Performance: File content being retrieved when not required</span></span></span><br/><span><span><span>-              SAFS-17479 SPAA Groups returning inconsistent TrusteeType values</span></span></span><br/><span><span><span>-              SAFS-17498 SPAA - Add re-authentication capability in the event that a 500 error is thrown to get a new session token</span></span></span><br/><span><span><span>-              SAFS-17534 Add debug logging for HTTP responses during SPO scans.</span></span></span><br/><span><span><span>-              SAFS-17465 Improve SPAA's Logging: Short circuit logging</span></span></span><br/><span><span><span>-              SAFS-17343 Improve SPAA's logging - logs are getting too big in customer environments.</span></span></span><br/><span><span><span>-              SAFS-17447 SPAA: Performance - Combine sharing and sharing users queries in local mode scans</span></span></span><br/><span><span><span>-              SAFS-17529 39586 - On-Prem SP ConnectTo Issues</span></span></span><br/><span><span><span>-              SAFS-17631 Test SPAC with new ActivityTypes.dll in 9.0 and 10.0</span></span></span><br/><span><span><span>-              SAFS-17573 SPAA: Scans hang indefinitely, only showing "Checkpoint" messages in logs</span></span></span><br/><span><span><span>-              SAFS-16792 Enhance SPAA to use 'exponential back-off' to avoid SharePoint Online throttling</span></span></span><br/><br/><span><span><span><b>Comments:</b></span></span></span><br/><span><span><span><b><span><span><span>THIS HOTFIX HAS A PREREQUISITE OF HOTFIX <u>SA_9.0_018</u>. PLEASE APPLY THAT HOTFIX PRIOR TO APPLYING THIS ONE. SEE KB FOR THAT HOTFIX FOR MORE DETAILS</span></span></span></b></span></span></span><br/><span><span><span><strong><span>Instructions:</span></strong></span></span></span> 
<ol><li>
<span><span><span><b><span><span>Unblock the hotfix zip file in the windows property dialog, if an unblock button exists there. </span></span></b></span></span></span>
</li><li>
<span><span><span>Close all instances of StealthAUDIT (check task manager under processes for all users)</span></span></span>
</li><li>
<span><span><span><strong><span>Update all DC files in your %SAInstallDir%DC folder</span></strong></span></span></span>
</li><li>
<span><span><span><strong><span>Update all PrivateAssemblies in your %SAInstallDir%PrivateAssemblies folder.</span></strong></span></span></span>
</li><li><span><span><span><strong><span>Update all Agent files in your %SAInstallDir%Agent folder</span></strong></span></span></span></li></ol><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <span><span><span><b><span><span><span>THIS HOTFIX HAS A PREREQUISITE OF HOTFIX <u>SA_9.0_018</u>. PLEASE APPLY THAT HOTFIX PRIOR TO APPLYING THIS ONE. SEE KB FOR THAT HOTFIX FOR MORE DETAILS</span></span></span></b></span></span></span><br/><span><span><span><strong><span>Instructions:</span></strong></span></span></span> 
</p><ol><li>
<span><span><span><b><span><span>Unblock the hotfix zip file in the windows property dialog, if an unblock button exists there. </span></span></b></span></span></span>
</li><li>
<span><span><span>Close all instances of StealthAUDIT (check task manager under processes for all users)</span></span></span>
</li><li>
<span><span><span><strong><span>Update all DC files in your %SAInstallDir%DC folder</span></strong></span></span></span>
</li><li>
<span><span><span><strong><span>Update all PrivateAssemblies in your %SAInstallDir%PrivateAssemblies folder.</span></strong></span></span></span>
</li><li><span><span><span><strong><span>Update all Agent files in your %SAInstallDir%Agent folder</span></strong></span></span></span></li></ol><a href="https://downloads.stealthbits.com/access/files/SAHotFixes/9.0/SA_9.0_030.zip" target="_blank">https://downloads.stealthbits.com/access/files/SAHotFixes/9.0/SA_9.0_030.zip</a><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - SPAA - Activity;SA - DC - SPAA - Permissions;SA - DC - SPAA - Sensitive Data<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 9.0<br/><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SAFS-16792, SAFS-17667<br/><strong><span class="wysiwyg-font-size-large">Resolved In:</span></strong> SPAA build			9.0.0.822<br/><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 2551<br/></p></div>
</article></body></html>