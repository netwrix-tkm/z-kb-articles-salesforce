<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Hotfix: SA_8.0_099</title><meta name="label" content="skb"/><meta name="label" content="employees_v"/><meta name="KnowledgeArticleId" content="kA04u0000000ISbCAM"/><meta name="Id" content="ka04u000000HcneAAC"/><meta name="LastPublishedDate" content="2022-02-01T18:24:15.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:07:12.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:24:15.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="6670"/><meta name="ArticleNumber" content="000006670"/><meta name="description" content="360012326291"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> FSAA | Folders not marked as deleted</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <strong><span>Summary:  FSAA | Folders not marked as deleted</span></strong><br/><strong><span>Before Fix: Deleted Resources discovered in FSAC scans will cause them to be come not marked as deleted in Tier 1. </span></strong><br/><strong><span>After fix: Add hidden XML option to always use FSAA for marking resources as deleted. See Comments for more details.</span></strong><br/><strong><span>Submitted by</span></strong><br/>Michael Burrofato<br/><strong><span>Affected Versions:</span></strong><br/> 8.0<br/><strong><span>Affected Module:</span></strong><br/>SA - DC - FSAA<br/> <br/><strong><span>Dev Ticket:</span></strong> 
</p><ul><li><span>SAFS-806</span></li></ul><strong><span>Resolved in Version:</span></strong> 
<ul><li>DCFSAA.dll                                 8.0.852
</li><li>FSAASrv.dll                                 8.0.852</li></ul><b>Other dependencies included:</b> 
<ul><li>StealthAUDITRPC.exe             8.0.96
</li><li>StealthAUDITRPCClient.dll     8.0.96
</li><li>FSAAConfig.xml
</li><li>SATagParser.dll                        8.0.13</li></ul><strong><span>KB Type: </span></strong><br/>               Hotfix<br/> <br/><strong><span>YouTrack/Escalations</span></strong><br/> <br/><strong><span>-              SAFS-806/Escalation </span></strong><span><span><span><span>8057, 7822, 29158, 29216</span></span></span></span><br/> <br/><strong><span>Customers</span></strong><br/><strong><span>-              Westfield Insurance Companies (Ohio Farmers)</span></strong><br/><strong><span>-              ANZ</span></strong><br/><strong><span>-              HPS Investment Partners</span></strong><br/><strong><span>-              Meggitt SA</span></strong><br/> <br/><strong><span>Cumulative List of fixes included since Service Pack:</span></strong><br/> <br/>-              SAFS-1582  9969 - FSAA | Timeout while compressing SQLites on proxy<br/>-              SAFS-2324  Investigate FSAA functionality when there is lack of access to IPC$<br/>-              SAFS-2359 16217 - Error Getting Activity Count from TBL_FSAC_ActivityEvents: Overflow while converting variant of type (OleStr) into type (Integer)<br/>-              SAFS-2442 - DFS Scan: Error during processing: cannot DETACH database within transaction[0x0001] DETACH DATABASE Struc<br/>-              SAFS-2411  16651 - FS_Migration Finishes with Success but doesn't Add USN Column to Activity Tier 2<br/>-              SAFS-2364  12262 - FSAA | Do not overwrite trace.log files<br/>-              SAFS-2515  FSAC: Scan is throwing an error "Buffer too small'"<br/>-              SAFS-2490  17161 - FSAC collection stuck in loop<br/>-              SAFS-2518  FSAC: Not returning full data when parsing huge zipped file<br/>-              SAFS-2574  FSAA: FSAC scan parses local sa console logs instead of windows cluster node<br/>-              SAFS-2571  FSAC: Scan should show percentage value as a scan status.<br/>-              SAFS-2626 : Cache was not properly handling files/folders with same names in same parent folder (can happen from deletion/recreation)<br/>-              SAFS-2559: 17476 - FSAC eM is not valid integer error<br/>-              SAFS-2739: 19535 - Update FSAC to collect log files without BOMs<br/>-              SAFS-2767 NFS scans aren't picking up files<br/>-              SAFS-2743 DFS listing wrong active link<br/>-              SAFS-2628 18381 - Server Scan file doesn't upload to the console.<br/>-              SAFS-2777 20796 - FSAA | Error when checking for active sessions on proxy<br/>-              SAFS-2837 19948 - DFS: Unique Key violation<br/>-              SAFS-2698 19491 - FSAA not traversing mounted volumes<br/>-              SAFS-2922 Update FSAAConfig.xml to properly handle list permissions<br/>-              SAFS-2736 20328 - FSAC System scan does not collect all events<br/>-              SAFS-2809 20970 - INSERT statement conflicted with the FOREIGN KEY constraint "FK_SA_FSAC_ActivityEvents_New_PathID"<br/>-              SAFS-2205 13113 - Detect and throw an error when an invalid share (e.g., one with a backslash) is detected<br/>-              SAFS-2329 16097 - FSAA | DFS Uses NTDomainName instead of FQDN<br/>-              SAFS-3020 FSAC: Offset value not resetting when scanning a new log for same day<br/>-              SAFS-2762 SDD | Enhance to retain LastAccessTime<br/>-              SAFS-3003 FSAA: Utilize Restore privileges when preserving LAT<br/>-              SAFS-2986 21818 - Migration OOM / Duplicate Column GatesProxyID<br/>-              SAFS-3026 22073 - FSAA | FKCV Errors After Applying Hotfix<br/>-              SAFS-14532 Make "Force preservation" option hidden by default<br/>-              SAFS-14541 Remove Description in FSAAConfig.xml<br/>-              SMPC-3911 Update SEEK Components to accept all configuration settings<br/>-              SAFS-14573 22741 - FSAA Migration Query 7.2 to 8.0 Duplicate Column Error<br/>-              SAFS-2705 15281 - FSAA unspecified error<br/><strong><span>-              SAFS-3056 Add automatic procdump functionality for FSAA applet</span></strong><br/><strong><span>-              SAFS-14593 Update bulk import to not delete Activity and DLPEX tier 2 dbs.</span></strong><br/><strong><span>-              SAFS-14598 22741 - FSAA Migration Query 7.2 to 8.0 Could not convert variant of type (Null) into type (Integer)</span></strong><br/><strong><span>-              SAFS-2707 19757 - FSAC Bulk Import Rollback Due to Unspecified Error</span></strong><br/><strong><span>-              SAFS-14566 Update FSAA to pass parameters to SDD</span></strong><br/><strong><span>-              SAFS-14672 FSAC Access Violation on scans</span></strong><br/><strong><span>-              SAFS-14694 23344 - TFSAAAppletObjectProcessor.GetScanDatabaseFromExecHostWithRetry "Error downloading scan database from exec host</span></strong><br/><strong><span>-              SAFS-14702 22116 - Do Not Delete Activity Data Automatically (7.2 and 8.0 Implementation)</span></strong><br/><strong><span>-              SAFS-14688 Applet log level of "None" sends all log messages to StealthAUDITRPC.exe trace log file</span></strong><br/><strong><span>-              SAFS-2771 20689 - Error during storing DailyActivity: '' is not a valid integer value</span></strong><br/><strong><span>-              SAFS-14656 23094 - Strip trailing spaces from shares' landing folders</span></strong><br/><strong><span>-              SAFS-2957 21750 - FSAA | Skip IPC$ check in applet mode</span></strong><br/><strong><span>-              SAFS-14607 22956/23113 - Waiting for Parser Queue to be Empty</span></strong><br/><strong><span>-              SAFS-14809 Automatic procdump functionality in FSAA applet can cause access violations after scan completes</span></strong><br/><strong><span>-              SAFS-14597 Add RPC_IF_ALLOW_CALLBACKS_WITH_NO_AUTH and auth callback even if not using secure RPC to permit working with RestrictRemoteClients=1</span></strong><br/><strong><span>-              SAFS-14803 FSAC: Add option of maximum size of activity to scan at once</span></strong><br/><strong><span>-              SAFS-14800 23738 - SDD Scoping to folders: Added a warning log message if the ScanResourceFilter option is using the unsupported target "Resource"</span></strong><br/><strong><span>-              SAFS-2692 19369/19531 - FSAA | Shares Marked as Deleted When Access to Enumerate Shares is Revoked</span></strong><br/><strong><span>-              SAFS-14824 20963 - FSAA Failed to Copy Tier 2: Prop DB was being compressed during non-permission scans</span></strong><br/><strong><span>-              SAFS-14888 24391 - Foreign Key Constraint Violation</span></strong><br/><strong><span>-              SAFS-14791 Change FSAA/FSAC to create SQLite temporary files in FSAA folder</span></strong><br/><strong><span>-              SAFS-14485 18434: FSAC Support milliseconds in event timestamps</span></strong><br/><strong><span>-              SAFS-14996 24391 - Foreign Key Constraint Violation</span></strong><br/><strong><span>-              SAFS-14993 24957 - Migration Error for Hosts that aren't in Tier 1</span></strong><br/><strong><span>-              SAFS-15107 24391 - Primary Key Constraint Violation</span></strong><br/><strong><span>-              SAFS-15094 25530 - Metadata information corrupted</span></strong><br/> <br/><strong><span>Fixes since last hotfix:</span></strong><br/><strong><span>-              SAFS-15136 25760 - FSAA | Make Delete Host query more fault tolerant</span></strong><br/><strong><span>-              SAFS-15217 26234 -FSAA | Remove RPC dependency for data deletion query</span></strong><br/><strong><span>-              SAFS-15270 Remove Host Query: Delete StrucMap prior to removing data in tier 1.</span></strong><br/><strong><span>-              SAFS-15274 Update Host Removal query to rename host to a fixed size</span></strong><br/><strong><span>-              SAFS-1643 11296 - Improve error logging for FSAA Proxy scanning</span></strong><br/><strong><span>-              SAFS-15295 Building DLP Patterns Takes Too Long</span></strong><br/><strong><span>-              SAFS-15388 FSAA/SDD: Performance bug limits scan performance</span></strong><br/><strong><span>-              SAFS-15353 27010 - FSAA | Error "Invalid discretionary access control list on security descriptor" when security descriptor has no DACL</span></strong><br/><strong><span>-              SAFS-806 FSAA | Folders not marked as deleted</span></strong><br/> <br/> <br/> <br/> <br/><b>Comments:</b><br/><strong><span><span>THIS HOTFIX REQUIRES AT LEAST HOTFIX SDD_8.0_006 TO BE INSTALLED IF USING SDD.</span></span></strong><br/><a href="https://na55.salesforce.com/articles/General/Hotfix-SDD-8-0-006" target="_blank">https://na55.salesforce.com/articles/General/Hotfix-SDD-8-0-006</a><br/><strong><span>The following fix requires the Job XML for ALL FSAA scans and bulk import jobs (permissions, activity, and Sensitive Data) to be manually modified. See screenshot below for the syntax required.</span></strong><br/><img alt="User-added image" src="kA04u0000000ISbCAM_167b0e62-784b-4024-b68e-8596be5a9dd9.png" width="500" height="169"/><br/><br/> <br/><b><u><span>ADDITIONAL STEPS IF YOU HAVE DELETED RESOURCES NOT MARKED AS DELETED IN TIER 1</span></u></b> 
<ol><li>Drop the contents located in the FSAA folder of this hotfix into the FSAA folder of your local SA Console.
</li><li>Open an elevated command prompt and change directory to FSAA folder.</li></ol><span><span><span><span>1) To update all tier2 files: </span></span></span></span><span><span><span>FSAAUpdateDeletedUSN</span></span></span><span><span><span>.</span></span></span><span><span><span>exe </span></span></span><span><span><span>-</span></span></span><span><span><span>a</span></span></span><br/><span><span><span><span>2) To update a single host: </span></span></span></span><span><span><span>FSAAUpdateDeletedUSN</span></span></span><span><span><span>.</span></span></span><span><span><span>exe </span></span></span><span><span><span/></span></span> 
<ol><li>Run FSAA permission bulk import against the affected hosts.</li></ol><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> </p><ol><li>Unblock the hotfix zip file in the windows property dialog, if an unblock button exists there. 
</li><li>Close all instances of StealthAUDIT (check task manager under processes for all users)
</li><li>
<strong><span>Update all DC files in your %SAInstallDir%DC folder</span></strong>
</li><li>
<strong><span>Update all PrivateAssemblies in your %SAInstallDir%PrivateAssemblies folder.</span></strong>
</li><li><strong><span>Launch StealthAUDIT. Run the 'Update Proxy Service' query under the Maintenance tab in the FSAA data collector against your proxy servers (if running proxy service).</span></strong></li></ol>
<div>  
<div class="table-wrap"><table count-columns="1" cellspacing="0" cellpadding="0" width="64" border="0"><tbody><tr height="77"><td colspan="1" rowspan="1" height="77" width="64"><a href="https://downloads.stealthbits.com/access/files/SAHotFixes/8.0/SA_8.0_099.zip" target="_blank">https://downloads.stealthbits.com/access/files/SAHotFixes/8.0/SA_8.0_099.zip</a></td></tr></tbody></table></div>
</div><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - FSAA - Activity;SA - DC - FSAA - DFS;SA - DC - FSAA - Permissions<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 8.0<br/><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SAFS-806<br/><strong><span class="wysiwyg-font-size-large">Resolved In:</span></strong> -	DCFSAA.dll			8.0.852
-	FSAASrv.dll			8.0.852

Other dependencies included:
-	StealthAUDITRPC.exe	8.0.96
-	StealthAUDITRPCClient.dll	8.0.96
-	FSAAConfig.xml
-	SATagParser.dll		8.0.13<br/><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 2175<br/></p></div>
</article></body></html>