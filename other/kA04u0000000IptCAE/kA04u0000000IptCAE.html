<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>StealthAUDIT Weak Password - Error "fkatana" Key being added</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000IptCAE"/><meta name="Id" content="ka04u000000HcwiAAC"/><meta name="LastPublishedDate" content="2022-02-01T18:33:27.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:11:50.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:33:27.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7196"/><meta name="ArticleNumber" content="000007196"/><meta name="description" content="360008408371"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> While running StealthAUDIT Version 8.1 Weak Password report I came across the following error. "System. Exception: Item has already been added. Key in dictionary: 'fkatana' Key being added: 'fkatana'"</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> "System. Exception: Item has already been added. Key in dictionary:  'fkatana' Key being added:  'fkatana'" when running Weak Passwords report in StealthAUDIT for AD Solution Set.</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> The issue is usually related to one or more settings within local group policy settings on the StealthAUDIT Console Server.</p>
<ul><li>
<strong>Impersonate a client after authentication</strong> - enabling this policy and adding the service account to this policy may resolve the issue. (path: <em>Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment</em>)
<ul><li><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/impersonate-a-client-after-authentication" target="_blank">https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/impersonate-a-client-after-authentication</a></li><li><span><a href="https://www.stigviewer.com/stig/windows_10/2016-06-24/finding/V-63889" target="_blank">https://www.stigviewer.com/stig/windows_10/2016-06-24/finding/V-63889</a></span></li></ul>
</li></ul>
<p> </p>
<ul><li>
<strong>Network access: Do not allow storage of passwords and credentials for network authentication</strong> - disabling this policy may resolve the issue (path:  <em>Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options</em>)
<ul><li><a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-access-do-not-allow-storage-of-passwords-and-credentials-for-network-authentication" target="_blank">https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-access-do-not-allow-storage-of-passwords-and-credentials-for-network-authentication</a></li></ul>
</li></ul>
<p> <strong>Additional Notes:</strong></p>
<ul><li>Ensure any GPO Policies pushed down from the AD Domain include this setting. Otherwise when you next run the job, the Domain GPO might have overwritten the local policy</li><li>Adding the service account directly to the policy was required in testing (Administrators were added, and service account was an Administrator). Logging off and logging back on to refresh the token may have helped with that.</li><li>No reboot was required in testing</li></ul>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - Solution Set - Active Directory<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 8.1+<br/><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 2111</p></div>
</article></body></html>