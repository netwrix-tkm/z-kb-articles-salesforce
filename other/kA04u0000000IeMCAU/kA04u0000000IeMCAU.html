<?xml version="1.0" encoding="UTF-8"?>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Hotfix: SA_8.1_064</title>
    <meta name="label" content="employees_v" />
    <meta name="label" content="skb" />
    <meta name="KnowledgeArticleId" content="kA04u0000000IeMCAU" />
    <meta name="Id" content="ka04u000000HcsJAAS" />
    <meta name="LastPublishedDate" content="2022-02-01T18:27:01.000+0000" />
    <meta name="LastModifiedDate" content="2023-05-08T10:09:22.000+0000" />
    <meta name="FirstPublishedDate" content="2022-02-01T18:27:01.000+0000" />
    <meta name="Language" content="en_US" />
    <meta name="UrlName" content="6856" />
    <meta name="ArticleNumber" content="000006856" />
    <meta name="description" content="360012217852" />
  </head>
  <body>
    <article class="kb-articles">
      <div class="Content__c">
        <p>
          <strong><span class="wysiwyg-font-size-large">Summary:</span></strong> AD_UserRights Job
          not properly handling single quote in NTAccountName
        </p>
        <p>
          <strong><span class="wysiwyg-font-size-large">Issue:</span></strong>
          <strong><span>Behavior Before Fix: </span></strong><br />Warning encountered while running
          AD_UserRIghts job.  The warning was seen when NTAccountName had single quote in it.<br /><strong
            ><span
              >WARNING    ACTIVEDIRECTORY    TSASQL.ExecuteSQL    "An error occurred trying execute
              this SQL: INSERT INTO #permissions( [EntryType] ,[EntryPrincipalName]
              ,[EntryPermission] ,[EntryInheritedFrom] ,[EntryApplyTo] ,[EntryPropertyName]
              ,[EntryObjectSID] ) VALUES ( 'Allow' ,'NSLIJHS\MO'Shea' ,'Send As' ,'' ,'This object
              and all child objects' ,NULL ,'S-1-5-21-1338325200-504760778-2079600828-181889' );,
              the error was: Incorrect syntax near 'Shea'"</span
            ></strong
          ><br /><strong><span>Behavior After Fix: </span></strong><br /><strong
            ><span>No warnings when running AD_UserRights</span></strong
          ><br /><strong><span>Submitted by: </span></strong><br />Justin Giemza<br /><strong
            ><span>Affected Versions:</span></strong
          ><br />8.1+<br /><strong><span>Affected Module:</span></strong
          ><br />SA - DC - Active Directory<br /><strong><span>Dev Ticket:</span></strong
          ><br /><strong
            ><span
              >SAT-3419 26073 - AD_UserRights Job not properly handling single quote in
              NTAccountName</span
            ></strong
          ><br /><strong><span>Resolved in Version:</span></strong
          ><br />DCActiveDirectory.dll v8.1.116<br /><strong><span>KB Type: </span></strong
          ><br />Hotfix<br /> 
        </p>
        <p>
          <strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> 1. Unblock the
          hotfix zip file in the windows property dialog, if an unblock button exists there.<br />2.
          Close all instances of StealthAUDIT (check task manager under processes for all users)<br />3.
          Exit StealthAUDIT console<br />4. Copy and replace files from the DC folder in this
          hotfix, to the DC Folder in SA Install Dir<br /><br /> 
        </p>
        <div class="table-wrap">
          <table count-columns="1" cellspacing="0" cellpadding="0" width="64" border="0">
            <tbody>
              <tr height="38">
                <td colspan="1" rowspan="1" height="38" width="64">
                  <a
                    href="https://downloads.stealthbits.com/access/files/SAHotFixes/8.1/SA_8.1_064.zip"
                    target="_blank"
                    >https://downloads.stealthbits.com/access/files/SAHotFixes/8.1/SA_8.1_064.zip</a
                  >
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <p>
          <strong><span class="wysiwyg-font-size-large">Product:</span></strong>
          StealthAUDIT<br /><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA
          - DC - Active Directory<br /><strong
            ><span class="wysiwyg-font-size-large">Versions:</span></strong
          >
          8.1<br /><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong>
          SAT-3419<br /><strong><span class="wysiwyg-font-size-large">Resolved In:</span></strong>
          DCActiveDirectory.dll v8.1.116<br /><strong
            ><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong
          >
          1997<br />
        </p>
      </div>
    </article>
  </body>
</html>
