<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>SharePoint SDD scans not detecting sensitive data</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000IrBCAU"/><meta name="Id" content="ka04u000000Hcx8AAC"/><meta name="LastPublishedDate" content="2022-02-01T18:35:54.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:12:02.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:35:54.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7236"/><meta name="ArticleNumber" content="000007236"/><meta name="description" content="360008408371"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> If an SPAA scan was run prior to an SPSEEK scan the DC will skip processing the content of potentially sensitive files due to the T2 still containing the last modified timestamp data from the SPAA scan.</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> When running a scan with the SPAA DC a last modified timestamp is pulled from the files metadata and stored in T2. This is how we are able to scan differentially and avoid scanning the same files twice when there hasn't been any changes to them effectively causing scans to take longer than necessary. The problem is when an SPAA scan is run before an SPSEEK scan we will skip processing the content of files for sensitive data based on the existing last modified date in T2. There will be messages in the logs similar to these:<br/><img src="kA04u0000000IrBCAU_d0446c16-aa92-47ab-ab97-3a78064d2b0e.png" alt="User-added image" width="500" height="62"/><br/> <br/><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> The way to address this issue is quite simple, the data collected during the SPAA scan needs to be dropped before running a subsequent SPSEEK scan in order for the DC to not skip processing those files.<br/>Steps:</p>
<ol><li>Delete or moveT2s located in <em><span>%SAINSTALLDIR%<span>\</span></span>Program Files (x86)\STEALTHbits\StealthAUDIT\Jobs\SA_CommonData\SharePointHostName </em>
<ol><li>(T2s on the application server for Agent Mode scans found on the drive that<em> the customer installed the agent\Program Files\STEALTHbits\StealthAUDIT\SPAA). </em>
</li></ol>
</li></ol>
<p> </p>
<ol><li>Drop the data in T1
<ol><li>Can be dropped using the Drop Tables analysis tasks found in the 1-SPAA_SystemScans Analysis section.</li></ol>
</li></ol>
<p>Note: Do not run the SPAA_SystemScans job to accomplish this:</p>
<ol><li>Click the 'Select All' button on the analysis page</li><li>Right click on of the tasks and select 'Execute Analyses'. This will execute all 4 of the analysis tasks.</li></ol>
<p><span><span>Note: Remember to deselect the analysis tasks before running subsequent SPAA scans. Also if the goal is to run Sensitive Data scans you should not be running SPAA scans and Imports and should disable those jobs (if in 8.2) or remove the jobs from the group (8.1).</span></span></p>
<p> </p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - SPAA - Permissions;SA - DC - SPAA - Sensitive Data<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> All Versions<br/><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SASP-3903<br/><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 2197</p></div>
</article></body></html>