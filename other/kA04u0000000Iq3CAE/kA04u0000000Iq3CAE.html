<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Categorizing SDD Scan Errors &amp; Warnings</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000Iq3CAE"/><meta name="Id" content="ka04u000000HcwnAAC"/><meta name="LastPublishedDate" content="2022-02-01T18:33:46.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:11:51.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:33:46.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7201"/><meta name="ArticleNumber" content="000007201"/><meta name="description" content="360008408371"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> This article describes how to quickly parse the multitude of error messages resulting from an SDD scan, categorizing each message into a well-known category, with the flexibility to add new categories as "Other" categories are discovered in live environments.</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> When reviewing SDD scan errors, the volume can be overwhelming, especially when most of them are environmental (e.g., Access Denied, File Password Protected, etc.). These views, based on the standard 1-SEEK System Scans job, categorize and aggregate messages into manageable categories</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> To leverage the views per the code in the included documents, they should be added to SMP via SQLScripting Analysis Task. This will help keep track of known errors. Easily add more category criteria to the case statement to allow for more complete coverage by categorizing less common errors. Case statement must be changed in all locations, including the SELECT and GROUP BY portions of the SQL statements.<br/> <br/>Drop these analysis tasks into the SEEK System Scan job (or any job) to categorize each error and warning thrown, and produce summary statistics. Tasks are included below in SQL Script, and then Analysis Task form. You can paste each XML analysis task directly into the "Analysis" node in the job.<br/><br/><em>SQL versions</em><br/> </p>
<pre class="ckeditor_codeblock"> <strong>Count and Categorize Latest Messages</strong>  IF OBJECT_ID('SA_1-SEEK_System_Scans_DLPMsgCategoriesLatest', 'v') IS NOT NULL DROP VIEW [SA_1-SEEK_System_Scans_DLPMsgCategoriesLatest]  GO  CREATE VIEW [SA_1-SEEK_System_Scans_DLPMsgCategoriesLatest] AS  SELECT        HOST ,      CASE WHEN Message like '%Unsupported File Type'+CHAR(13)+CHAR(10) then 'Unsupported File Type'        WHEN Message like '%File cutoff'+CHAR(13)+CHAR(10) THEN 'File Cuttoff'        WHEN Message like '%Slow File'+CHAR(13)+CHAR(10) THEN 'Slow File'        WHEN MEssage like '%Access Denied'+CHAR(13)+CHAR(10) THEN 'Access Denied'        WHEN MEssage like '%Locked Open'+CHAR(13)+CHAR(10) THEN 'Locked Open'        WHEN Message like '%Password Protected'+CHAR(13)+CHAR(10) THEN 'Password Protected'        WHEN Message like '%Scan Canceled%' OR Message Like '%Folder Scan aborted%' then 'Abort'        WHEN Message like '%Mismatched Extension'+CHAR(13)+CHAR(10) THEN 'Mismatched Extension'        WHEN Message like '%File Scan Timeout'+CHAR(13)+CHAR(10) THEN 'File Scan Timeout'        WHEN Message like 'Error % Error code(1232)%' THEN 'Likely DFS Error'        WHEN Message like '%System.OutOfMemoryException%' THEN 'Out of Memory'        ELSE 'OTHER - '+ Message END as MsgCategory ,      Count(*) as MessageCount from SA_Messages WHERE JobName like '1-SEEK System Scans' and TableName='DLP' and  JobRunTimeKey=(select max(JobRunTimeKey) from [SA_1-SEEK_System_Scans_DLP]) GROUP BY Host, CASE WHEN Message like '%Unsupported File Type'+CHAR(13)+CHAR(10) then 'Unsupported File Type'        WHEN Message like '%File cutoff'+CHAR(13)+CHAR(10) THEN 'File Cuttoff'        WHEN Message like '%Slow File'+CHAR(13)+CHAR(10) THEN 'Slow File'        WHEN MEssage like '%Access Denied'+CHAR(13)+CHAR(10) THEN 'Access Denied'        WHEN MEssage like '%Locked Open'+CHAR(13)+CHAR(10) THEN 'Locked Open'        WHEN Message like '%Password Protected'+CHAR(13)+CHAR(10) THEN 'Password Protected'        WHEN Message like '%Scan Canceled%' OR Message Like '%Folder Scan aborted%' then 'Abort'        WHEN Message like '%Mismatched Extension'+CHAR(13)+CHAR(10) THEN 'Mismatched Extension'        WHEN Message like '%File Scan Timeout'+CHAR(13)+CHAR(10) THEN 'File Scan Timeout'        WHEN Message like 'Error % Error code(1232)%' THEN 'Likely DFS Error'        WHEN Message like '%System.OutOfMemoryException%' THEN 'Out of Memory'        ELSE 'OTHER - '+ Message END   <strong>Count and categorize messages from all runs (if history is disabled, will be identical to "Latest" </strong> IF OBJECT_ID('SA_1-SEEK_System_Scans_DLPMsgCategories', 'v') IS NOT NULL DROP VIEW [SA_1-SEEK_System_Scans_DLPMsgCategories]  GO  CREATE VIEW [SA_1-SEEK_System_Scans_DLPMsgCategories] AS  SELECT        HOST ,      CASE WHEN Message like '%Unsupported File Type'+CHAR(13)+CHAR(10) then 'Unsupported File Type'        WHEN Message like '%File cutoff'+CHAR(13)+CHAR(10) THEN 'File Cuttoff'        WHEN Message like '%Slow File'+CHAR(13)+CHAR(10) THEN 'Slow File'        WHEN MEssage like '%Access Denied'+CHAR(13)+CHAR(10) THEN 'Access Denied'        WHEN MEssage like '%Locked Open'+CHAR(13)+CHAR(10) THEN 'Locked Open'        WHEN Message like '%Password Protected'+CHAR(13)+CHAR(10) THEN 'Password Protected'        WHEN Message like '%Scan Canceled%' OR Message Like '%Folder Scan aborted%' then 'Abort'        WHEN Message like '%Mismatched Extension'+CHAR(13)+CHAR(10) THEN 'Mismatched Extension'        WHEN Message like '%File Scan Timeout'+CHAR(13)+CHAR(10) THEN 'File Scan Timeout'        WHEN Message like 'Error % Error code(1232)%' THEN 'Likely DFS Error'        WHEN Message like '%System.OutOfMemoryException%' THEN 'Out of Memory'        ELSE 'OTHER - '+ Message END as MsgCategory ,      Count(*) as MessageCount ,      JobRunTimeKey from SA_Messages WHERE JobName like '1-SEEK System Scans' and TableName='DLP' GROUP BY Host, JobRunTimeKey, CASE WHEN Message like '%Unsupported File Type'+CHAR(13)+CHAR(10) then 'Unsupported File Type'        WHEN Message like '%File cutoff'+CHAR(13)+CHAR(10) THEN 'File Cuttoff'        WHEN Message like '%Slow File'+CHAR(13)+CHAR(10) THEN 'Slow File'        WHEN MEssage like '%Access Denied'+CHAR(13)+CHAR(10) THEN 'Access Denied'        WHEN MEssage like '%Locked Open'+CHAR(13)+CHAR(10) THEN 'Locked Open'        WHEN Message like '%Password Protected'+CHAR(13)+CHAR(10) THEN 'Password Protected'        WHEN Message like '%Scan Canceled%' OR Message Like '%Folder Scan aborted%' then 'Abort'        WHEN Message like '%Mismatched Extension'+CHAR(13)+CHAR(10) THEN 'Mismatched Extension'        WHEN Message like '%File Scan Timeout'+CHAR(13)+CHAR(10) THEN 'File Scan Timeout'        WHEN Message like 'Error % Error code(1232)%' THEN 'Likely DFS Error'        WHEN Message like '%System.OutOfMemoryException%' THEN 'Out of Memory'        ELSE 'OTHER - '+ Message END   <strong>Categorize All Messages</strong>  IF OBJECT_ID('SA_1-SEEK_System_Scans_DLPMsgsAdvanced', 'v') IS NOT NULL DROP VIEW [SA_1-SEEK_System_Scans_DLPMsgsAdvanced]  GO  CREATE VIEW [SA_1-SEEK_System_Scans_DLPMsgsAdvanced] AS  SELECT        HOST ,      MSG_TYPE ,      CASE WHEN Message like '%Unsupported File Type'+CHAR(13)+CHAR(10) then 'Unsupported File Type'        WHEN Message like '%File cutoff'+CHAR(13)+CHAR(10) THEN 'File Cuttoff'        WHEN Message like '%Slow File'+CHAR(13)+CHAR(10) THEN 'Slow File'        WHEN MEssage like '%Access Denied'+CHAR(13)+CHAR(10) THEN 'Access Denied'        WHEN MEssage like '%Locked Open'+CHAR(13)+CHAR(10) THEN 'Locked Open'        WHEN Message like '%Password Protected'+CHAR(13)+CHAR(10) THEN 'Password Protected'        WHEN Message like '%Scan Canceled%' OR Message Like '%Folder Scan aborted%' then 'Abort'        WHEN Message like '%Mismatched Extension'+CHAR(13)+CHAR(10) THEN 'Mismatched Extension'        WHEN Message like '%File Scan Timeout'+CHAR(13)+CHAR(10) THEN 'File Scan Timeout'        WHEN Message like 'Error % Error code(1232)%' THEN 'Likely DFS Error'        WHEN Message like '%System.OutOfMemoryException%' THEN 'Out of Memory'        ELSE 'OTHER - '+ Message END as MsgCategory ,      Message from SA_Messages WHERE JobName like '1-SEEK System Scans' and TableName='DLP'</pre>
<p><br/><em>Analysis Task versions</em><br/> </p>
<pre class="ckeditor_codeblock"> <strong>Count and Categorize Latest Messages</strong>                                                     {998E4EEF-1CD8-40E8-80B8-D494B67564DA}                 Count and Categorize Latest Messages                 SA_1-SEEK_System_Scans_DLPMsgCategoriesLatest                 {8B79A966-DD14-4c8c-9597-A26FBD68B15F}                                  2                 TRUE                                                  FALSE                                 FALSE                                                                                                                                                                       FALSE                                                                                                                                    SA_1-SEEK_System_Scans_DLPMsgCategoriesLatest                                                                   IF OBJECT_ID('SA_1-SEEK_System_Scans_DLPMsgCategoriesLatest', 'v') IS NOT NULL DROP VIEW [SA_1-SEEK_System_Scans_DLPMsgCategoriesLatest]  GO  CREATE VIEW [SA_1-SEEK_System_Scans_DLPMsgCategoriesLatest] AS  SELECT                 HOST ,               CASE WHEN Message like '%Unsupported File Type'+CHAR(13)+CHAR(10) then 'Unsupported File Type'                 WHEN Message like '%File cutoff'+CHAR(13)+CHAR(10) THEN 'File Cuttoff'                 WHEN Message like '%Slow File'+CHAR(13)+CHAR(10) THEN 'Slow File'                 WHEN MEssage like '%Access Denied'+CHAR(13)+CHAR(10) THEN 'Access Denied'                 WHEN MEssage like '%Locked Open'+CHAR(13)+CHAR(10) THEN 'Locked Open'                 WHEN Message like '%Password Protected'+CHAR(13)+CHAR(10) THEN 'Password Protected'                 WHEN Message like '%Scan Canceled%' OR Message Like '%Folder Scan aborted%' then 'Abort'                 WHEN Message like '%Mismatched Extension'+CHAR(13)+CHAR(10) THEN 'Mismatched Extension'                 WHEN Message like '%File Scan Timeout'+CHAR(13)+CHAR(10) THEN 'File Scan Timeout'                 WHEN Message like 'Error % Error code(1232)%' THEN 'Likely DFS Error'                 WHEN Message like '%System.OutOfMemoryException%' THEN 'Out of Memory'                 ELSE 'OTHER - '+ Message END as MsgCategory ,               Count(*) as MessageCount from SA_Messages WHERE JobName like '1-SEEK System Scans' and TableName='DLP' and  JobRunTimeKey=(select max(JobRunTimeKey) from [SA_1-SEEK_System_Scans_DLP]) GROUP BY Host, CASE WHEN Message like '%Unsupported File Type'+CHAR(13)+CHAR(10) then 'Unsupported File Type'                 WHEN Message like '%File cutoff'+CHAR(13)+CHAR(10) THEN 'File Cuttoff'                 WHEN Message like '%Slow File'+CHAR(13)+CHAR(10) THEN 'Slow File'                 WHEN MEssage like '%Access Denied'+CHAR(13)+CHAR(10) THEN 'Access Denied'                 WHEN MEssage like '%Locked Open'+CHAR(13)+CHAR(10) THEN 'Locked Open'                 WHEN Message like '%Password Protected'+CHAR(13)+CHAR(10) THEN 'Password Protected'                 WHEN Message like '%Scan Canceled%' OR Message Like '%Folder Scan aborted%' then 'Abort'                 WHEN Message like '%Mismatched Extension'+CHAR(13)+CHAR(10) THEN 'Mismatched Extension'                 WHEN Message like '%File Scan Timeout'+CHAR(13)+CHAR(10) THEN 'File Scan Timeout'                 WHEN Message like 'Error % Error code(1232)%' THEN 'Likely DFS Error'                 WHEN Message like '%System.OutOfMemoryException%' THEN 'Out of Memory'                 ELSE 'OTHER - '+ Message END                                                       <strong>Count and categorize messages from all runs (if history is disabled, will be identical to "Latest"</strong>                                                     {39016BF9-F7BB-49CE-B9BD-38C97247FDC8}                 Count and Categorize Messages from All Runs                 SA_1-SEEK_System_Scans_DLPMsgCategories                 {8B79A966-DD14-4c8c-9597-A26FBD68B15F}                                  3                 TRUE                                                  FALSE                                 FALSE                                                                                                                                                                       FALSE                                                                                                                                    SA_1-SEEK_System_Scans_DLPMsgCategories                                                                   IF OBJECT_ID('SA_1-SEEK_System_Scans_DLPMsgCategories', 'v') IS NOT NULL DROP VIEW [SA_1-SEEK_System_Scans_DLPMsgCategories]  GO  CREATE VIEW [SA_1-SEEK_System_Scans_DLPMsgCategories] AS  SELECT                 HOST ,               CASE WHEN Message like '%Unsupported File Type'+CHAR(13)+CHAR(10) then 'Unsupported File Type'                 WHEN Message like '%File cutoff'+CHAR(13)+CHAR(10) THEN 'File Cuttoff'                 WHEN Message like '%Slow File'+CHAR(13)+CHAR(10) THEN 'Slow File'                 WHEN MEssage like '%Access Denied'+CHAR(13)+CHAR(10) THEN 'Access Denied'                 WHEN MEssage like '%Locked Open'+CHAR(13)+CHAR(10) THEN 'Locked Open'                 WHEN Message like '%Password Protected'+CHAR(13)+CHAR(10) THEN 'Password Protected'                 WHEN Message like '%Scan Canceled%' OR Message Like '%Folder Scan aborted%' then 'Abort'                 WHEN Message like '%Mismatched Extension'+CHAR(13)+CHAR(10) THEN 'Mismatched Extension'                 WHEN Message like '%File Scan Timeout'+CHAR(13)+CHAR(10) THEN 'File Scan Timeout'                 WHEN Message like 'Error % Error code(1232)%' THEN 'Likely DFS Error'                 WHEN Message like '%System.OutOfMemoryException%' THEN 'Out of Memory'                 ELSE 'OTHER - '+ Message END as MsgCategory ,               Count(*) as MessageCount ,               JobRunTimeKey from SA_Messages WHERE JobName like '1-SEEK System Scans' and TableName='DLP' GROUP BY Host, JobRunTimeKey, CASE WHEN Message like '%Unsupported File Type'+CHAR(13)+CHAR(10) then 'Unsupported File Type'                 WHEN Message like '%File cutoff'+CHAR(13)+CHAR(10) THEN 'File Cuttoff'                 WHEN Message like '%Slow File'+CHAR(13)+CHAR(10) THEN 'Slow File'                 WHEN MEssage like '%Access Denied'+CHAR(13)+CHAR(10) THEN 'Access Denied'                 WHEN MEssage like '%Locked Open'+CHAR(13)+CHAR(10) THEN 'Locked Open'                 WHEN Message like '%Password Protected'+CHAR(13)+CHAR(10) THEN 'Password Protected'                 WHEN Message like '%Scan Canceled%' OR Message Like '%Folder Scan aborted%' then 'Abort'                 WHEN Message like '%Mismatched Extension'+CHAR(13)+CHAR(10) THEN 'Mismatched Extension'                 WHEN Message like '%File Scan Timeout'+CHAR(13)+CHAR(10) THEN 'File Scan Timeout'                 WHEN Message like 'Error % Error code(1232)%' THEN 'Likely DFS Error'                 WHEN Message like '%System.OutOfMemoryException%' THEN 'Out of Memory'                 ELSE 'OTHER - '+ Message END                                                      <strong>Categorize All Messages</strong>                                                     {D7781F0D-88C7-4C81-9FA7-6AA6C1B11204}                 Categorize Messages                 SA_1-SEEK_System_Scans_DLPMsgsAdvanced                 {8B79A966-DD14-4c8c-9597-A26FBD68B15F}                                  4                 TRUE                                                  FALSE                                 FALSE                                                                                                                                                                       FALSE                                                                                                                                    SA_1-SEEK_System_Scans_DLPMsgsAdvanced                                                                   IF OBJECT_ID('SA_1-SEEK_System_Scans_DLPMsgsAdvanced', 'v') IS NOT NULL DROP VIEW [SA_1-SEEK_System_Scans_DLPMsgsAdvanced]  GO  CREATE VIEW [SA_1-SEEK_System_Scans_DLPMsgsAdvanced] AS  SELECT                 HOST ,               MSG_TYPE ,               CASE WHEN Message like '%Unsupported File Type'+CHAR(13)+CHAR(10) then 'Unsupported File Type'                 WHEN Message like '%File cutoff'+CHAR(13)+CHAR(10) THEN 'File Cuttoff'                 WHEN Message like '%Slow File'+CHAR(13)+CHAR(10) THEN 'Slow File'                 WHEN MEssage like '%Access Denied'+CHAR(13)+CHAR(10) THEN 'Access Denied'                 WHEN MEssage like '%Locked Open'+CHAR(13)+CHAR(10) THEN 'Locked Open'                 WHEN Message like '%Password Protected'+CHAR(13)+CHAR(10) THEN 'Password Protected'                 WHEN Message like '%Scan Canceled%' OR Message Like '%Folder Scan aborted%' then 'Abort'                 WHEN Message like '%Mismatched Extension'+CHAR(13)+CHAR(10) THEN 'Mismatched Extension'                 WHEN Message like '%File Scan Timeout'+CHAR(13)+CHAR(10) THEN 'File Scan Timeout'                 WHEN Message like 'Error % Error code(1232)%' THEN 'Likely DFS Error'                 WHEN Message like '%System.OutOfMemoryException%' THEN 'Out of Memory'                 ELSE 'OTHER - '+ Message END as MsgCategory ,               Message from SA_Messages WHERE JobName like '1-SEEK System Scans' and TableName='DLP'                                                     </pre>
<p><br/><br/><br/> <br/><br/> </p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - FSAA - Sensitive Data;SA - Solution Set - File System<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> All versions<br/><strong><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong> 1457</p></div>
</article></body></html>