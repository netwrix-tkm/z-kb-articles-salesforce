<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>How to create an LDAP query to retrieve details of items in the Foreign Security Principals AD container</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000IVACA2"/><meta name="Id" content="ka04u000000HcojAAC"/><meta name="LastPublishedDate" content="2022-02-01T18:23:36.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:07:34.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:23:36.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="6636"/><meta name="ArticleNumber" content="000006636"/><meta name="description" content="360008408371"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Active Directory Inventory and the Active Directory data collector does not collect items from the Foreign Security Principals AD container.  You can collect this information with an LDAP query.</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> Active Directory Inventory and the Active Directory data collector does not collect items from the Foreign Security Principals AD container.  You can collect this information with an LDAP query.</p><p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> <b>StealthAUDIT - How to create an LDAP query to retrieve details of items in the Foreign Security Principals AD container</b><br/>  
</p><ol><li>Create a new job (right click on "Jobs" or the job group you wish to place the new job in, then choose "Create Job".  Give your new job a name.
</li><li>Right click on your job and choose "properties".  Click on the connection tab and be sure the connection profile you see uses an account that will have permission to do LDAP queries.  (It is OK if this connection profile is inherited.)  Adjust to a new connection profile if needed.  Then click "OK".<br/><img alt="User-added image" src=""/>
</li><li>Expand your job and choose Configuration&gt; Hosts.  In the Host Selection section, chose a domain controller machine or "default domain controller" from the list.  Then click the "Save" button on the lower right.  (Click OK when notified that your setting were saved.)<br/><img alt="User-added image" src=""/>
</li><li>In your job, next go to Configuration &gt; Queries<br/><img alt="User-added image" src=""/>
</li><li>On the right side of the screen in the "Query Selection" area, click on "Create Query"<br/><img alt="User-added image" src=""/>
</li><li>In the Query Properties box, choose the "Data Source" tab.  In the "Data Collector" dropdown, choose "LDAP".  Then click the "Configure" button.<br/><img alt="User-added image" src=""/>
</li><li>In the LDAP template form box, type the name of your AD server in the "Connect to the server" area, or leave as .  Then click the "Connect" button. <span>[NOTE: You may wish to  connect to the same AD server you query for the Active Directory Inventory job.]</span><br/><img alt="User-added image" src="" width="500" height="86"/>
</li><li>On the left, under the server, expand your tree and click on "Foreign Security Principals" to highlight it.<br/><img alt="User-added image" src=""/>
</li><li>On the right hand side, click to select the properties you wish to report on.  You can use the normal windows control-click method to select more than one item, as less as the shift-click to collect a range.  (It's OK to select all items if you are unsure which you will need.)  Then select the "select highlighted attributes" button below the attributes list (it has the red down arrow on the icon).  This will put the attributes into the lower right hand box.<br/><img alt="User-added image" src=""/>
</li><li>Click the "include sublevels" button (it looks like a folder with two blue stars on it).  Then click the "OK" button at the bottom right of the LDAP template form box.<br/><img alt="User-added image" src=""/>
</li><li>Click the "OK" button at the bottom of the Query Properties box.<br/><img alt="User-added image" src=""/>
</li><li>You should be ready to run your job now.  Right click on the job name and choose "Run job".
</li><li>After the job is complete, expand the Results and click on the DEFAULT table.  You data should be in the table on the right.<br/><img alt="User-added image" src="" width="500" height="164"/>
</li><li>If desired, create a report to display your results (Configure&gt;Reports).  Have the report reference the table associated with the LDAP query you just made (DEFAULT, in this example).</li></ol> <br/> <br/> <p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - ADInventory;SA - DC - LDAP<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> All<br/><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 2195<br/></p></div>
</article></body></html>