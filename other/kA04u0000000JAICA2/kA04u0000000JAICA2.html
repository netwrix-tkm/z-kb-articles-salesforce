<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Hotfix: SA_9.0_066</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000JAICA2"/><meta name="Id" content="ka04u000000Hd4GAAS"/><meta name="LastPublishedDate" content="2022-02-01T18:49:26.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:15:10.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:49:26.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="7671"/><meta name="ArticleNumber" content="000007671"/><meta name="description" content="360012217872"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> SPAA: Unable to perform SP Bulk Import</p><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> <span><span><span><strong><span>Summary: </span></strong> SPAA: Unable to perform SP Bulk Import</span></span></span><br/><span><span><span><strong><span>Before Fix: </span></strong><span><span><span><span><span>SPAA Bulk Import throws either one of the following errors:</span></span></span></span></span></span></span></span><br/><span><span><span><span><span><span><span><span>"Unable to perform bulk import Error: The given string from the data source cannot be converted to type nvarchar of the specified target column."</span></span></span></span></span></span></span></span><br/><span><span><span><span><span><span><span><span>or</span></span></span></span></span></span></span></span><br/><span><span><span><strong><span>System.Data.SqlClient.SqlException: 'The MERGE statement conflicted with the FOREIGN KEY constraint "FK_SA_SPAA_RolesProxy_RoleId". The conflict occurred in database "sa91", table "dbo.SA_SPAA_Roles".</span></strong></span></span></span><br/><span><span><span><strong><span>The statement has been terminated.'</span></strong></span></span></span><br/><br/><span><span><span><strong><span>After fix: Bulk import issues resolved.</span></strong></span></span></span><br/><span><span><span><strong><span>Submitted by: </span></strong></span></span></span><br/><span><span><span><span><span class="MsoSubtleEmphasis"><span>Michael Burrofato</span></span></span></span></span></span><br/><span><span><span><strong><span>Affected Versions:</span></strong></span></span></span><br/><span><span><span>9.0</span></span></span><br/><span><span><span><strong><span>Affected Module:</span></strong></span></span></span><br/><span><span><span>SA - DC - SPAA</span></span></span><br/><br/><span><span><span><strong><span>Dev Ticket:</span></strong></span></span></span> 
</p><ul><li><span><span><span><span>SAFS-18672</span></span></span></span></li></ul><span><span><span><strong><span>Resolved in Version:</span></strong></span></span></span> 
<ul><li><span><span><span><span class="MsoSubtleEmphasis"><span>SPAA build                                  9.0.0.929</span></span></span></span></span></li></ul><span><span><span><strong><span>KB Type: </span></strong></span></span></span><br/><span><span><span class="MsoSubtleEmphasis"><span>                Hotfix</span></span></span></span><br/><br/><span><span><strong><span>YouTrack/Escalations</span></strong></span></span><br/><br/><span><span><strong><span>-              SAFS-18672/50188</span></strong></span></span><br/><br/><span><span><strong><span>Customers</span></strong></span></span><br/><span><span><strong><span>-              Liberty University</span></strong></span></span><br/><br/><span><span><strong><span>Cumulative List of fixes included since Service Pack:</span></strong></span></span><br/><span><span><span><strong><span>-              SAFS-16926 SP SDD: Limit Stored matches option value is not being saved properly</span></strong></span></span></span><br/><span><span><span><strong><span>-              SAFS-16937 SPAA - Query Config UI doesn't save Agent Identity Settings</span></strong></span></span></span><br/><span><span><span><strong><span>-              SAFS-16964 Fix SPAA DC's 'Force admin' options for scanning SharePoint Online</span></strong></span></span></span><br/><span><span><span><strong><span>-              SAFS-16963 Remove code in SPAA bulk import that removes/adds constraints</span></strong></span></span></span><br/><span><span><span><strong><span>-              SAFS-16861 SPAA: Agentless SDD scans that don't have Scan Document Metadata checked fails to imports Matches and Match hits</span></strong></span></span></span><br/><span><span><span>-              SAFS-16954 Deleted Subsites cause scans to hang infinitely</span></span></span><br/><span><span><span>-              SAFS-16952 Deleted Files are throwing a File not found error (but still marked as deleted in t2 and t1)</span></span></span><br/><span><span><span>-              SAFS-16988 SPAA Support Hierarchical Deletion of Users</span></span></span><br/><span><span><span>-              SAFS-17004 SPAA: Hierarchical Resource Deletions is not working</span></span></span><br/><span><span><span>-              SAFS-17001 SPAA: New scoping logic causes misleading results in the AIC</span></span></span><br/><span><span><span>-              SAFS-16774 Agent Database Sync</span></span></span><br/><span><span><span>-              SAFS-16999 SPAA - Remove UI Agent Setting "Use default Service Principal Name when agent service use local machine credentials"</span></span></span><br/><span><span><span>-              SAFS-17065 36955 - Add percent completed in job log for SharePoint scans</span></span></span><br/><span><span><span>-              SAFS-17121 SPAA: Refactor SQLite Storage assembly to remove unused conditional compilation directives</span></span></span><br/><span><span><span>-              SAFS-17134 SPAA Performance Improvement: Cache SP SC, Site &amp; List objects for thread reuse in agent query assembly</span></span></span><br/><span><span><span>-              SAFS-17188 SPAA: Add appropriate indexes and use prepared statements in SQLite queries to increase performance</span></span></span><br/><span><span><span>-              SAFS-17143 SPAA Performance Improvement: Update progress reporting to not query database</span></span></span><br/><span><span><span>-              SAFS-17142 SPAA Performance Improvement: Update progress reporting to run once a minute instead of every 10 seconds</span></span></span><br/><span><span><span>-              SAFS-17216 SPAA: Subsequent scans start at 100% completed (status message)</span></span></span><br/><span><span><span>-              SAFS-17119 Enhance SPAA DC to support scoped scans which do not query the SPO Admin center</span></span></span><br/><span><span><span>-              SAFS-17244 Improved SharePoint scoping - allow inclusion/exclusions of URLs down to files</span></span></span><br/><span><span><span>-              SAFS-16951 38203 - SPAA Import error: Unable to perform Bulk Import due to duplicate key row (Duplicate SID error)</span></span></span><br/><span><span><span>-              SAFS-17284 SPAA Scoping - Fix URL escapes in scoping options</span></span></span><br/><span><span><span>-              SAFS-17289 SPAA: New file-level scan scoping does not properly exclude files</span></span></span><br/><span><span><span>-              SAFS-17225 SPAA: Migrating from 8.2 to 9.0+ does not upgrade scoping options.</span></span></span><br/><span><span><span>-              SAFS-17394 SPAC scans failing: Failed to get Trustee ID: SQL logic error cannot start a transaction within a transaction"</span></span></span><br/><span><span><span>-              SAFS-17397 Upgrades within SA versions cause null pointer error</span></span></span><br/><span><span><span>-              SAFS-17398 SPAA: Old scoping options not respected unless walk thru the DC wizard.</span></span></span><br/><span><span><span>-              SAFS-17297 SPAA: 9.0 Performance Regression (agent improvements)</span></span></span><br/><span><span><span>-              SAFS-17442 SPAA Performance: File content being retrieved when not required</span></span></span><br/><span><span><span>-              SAFS-17479 SPAA Groups returning inconsistent TrusteeType values</span></span></span><br/><span><span><span>-              SAFS-17498 SPAA - Add re-authentication capability in the event that a 500 error is thrown to get a new session token</span></span></span><br/><span><span><span>-              SAFS-17534 Add debug logging for HTTP responses during SPO scans.</span></span></span><br/><span><span><span>-              SAFS-17465 Improve SPAA's Logging: Short circuit logging</span></span></span><br/><span><span><span>-              SAFS-17343 Improve SPAA's logging - logs are getting too big in customer environments.</span></span></span><br/><span><span><span>-              SAFS-17447 SPAA: Performance - Combine sharing and sharing users queries in local mode scans</span></span></span><br/><span><span><span>-              SAFS-17529 39586 - On-Prem SP ConnectTo Issues</span></span></span><br/><span><span><span>-              SAFS-17631 Test SPAC with new ActivityTypes.dll in 9.0 and 10.0</span></span></span><br/><span><span><span>-              SAFS-17573 SPAA: Scans hang indefinitely, only showing "Checkpoint" messages in logs</span></span></span><br/><span><span><span>-              SAFS-16792 Enhance SPAA to use 'exponential back-off' to avoid SharePoint Online throttling</span></span></span><br/><span><span><span>-              SAFS-17416 SPAA: Do not populate MatchHits if 'Store discovered sensitive data' option is turned off.</span></span></span><br/><span><span><span>-              SAFS-17419 SPAC Scans are missing data and leaving behind Wal and Shm files.</span></span></span><br/><span><span><span>-              SAFS-17739 Address flaws with modern auth scans</span></span></span><br/><span><span><span>-              SAFS-17730 SPAA: Not marking children as deleted if parent DeletedUSN value not equal to current USN</span></span></span><br/><span><span><span>-              SAFS-17904 40347/40574 - Bulk Import Error: Foreign Key Same Table Constraint</span></span></span><br/><span><span><span>-              SAFS-17763 SPAA: Toggling Agent mode scans on/off should change AD/ADI setting (merging)</span></span></span><br/><span><span><span>-              SAFS-17983 SPAA - Forms Based Auth Support Broken</span></span></span><br/><span><span><span>-              SAFS-18098 41463 - SPSEEK - SPO - Scans hang at certain depth and have an issue restarting</span></span></span><br/><span><span><span>-              SAFS-18082 SPAA: Fix local principals being marked as domain principals</span></span></span><br/><span><span><span>-              SAFS-18221 SPAA: Bug found with Web-app policy collection</span></span></span><br/><span><span><span>-              SAFS-18532 SPAA scans are marking web applications as deleted</span></span></span><br/><span><span><span>-              SAFS-18637 SPAA: Add debug logging around SSL connection code</span></span></span><br/><br/><span><span><span><b>Changes since last Hotfix:</b></span></span></span><br/><span><span><span><b>-              </b>SAFS-18788 SPAA: Add more logging around SSL connection</span></span></span><br/><span><span><span>-              SAFS-18672 50188 - Unable to perform SP Bulk Import<br/><br/><b>Comments:</b></span></span></span><br/><span><span><span><b><span><span><span>THIS HOTFIX HAS A PREREQUISITE OF HOTFIX <u>SA_9.0_018</u>. PLEASE APPLY THAT HOTFIX PRIOR TO APPLYING THIS ONE. SEE KB FOR THAT HOTFIX FOR MORE DETAILS</span></span></span></b></span></span></span><br/><br/> <p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> </p><ol><li>
<span><span><span><b><span><span>Unblock the hotfix zip file in the windows property dialog, if an unblock button exists there. </span></span></b></span></span></span>
</li><li>
<span><span><span>Close all instances of StealthAUDIT (check task manager under processes for all users)</span></span></span>
</li><li>
<span><span><span><strong><span>Update all DC files in your %SAInstallDir%DC folder</span></strong></span></span></span>
</li><li>
<span><span><span><strong><span>Update all PrivateAssemblies in your %SAInstallDir%PrivateAssemblies folder.</span></strong></span></span></span>
</li><li>
<span><span><span><strong><span>Update all Agent files in your %SAInstallDir%Agent folder</span></strong></span></span></span>
</li><li><span><span><span><strong><span>If using Agent mode, please install SPAA Agent version 9.0.0.40 or later</span></strong></span></span></span></li></ol><br/><a href="https://downloads.stealthbits.com/access/files/SAHotFixes/9.0/SA_9.0_066.zip" target="_blank">https://downloads.stealthbits.com/access/files/SAHotFixes/9.0/SA_9.0_066.zip</a><p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - SPAA - Activity;SA - DC - SPAA - Permissions<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 9.0<br/><strong><span class="wysiwyg-font-size-large">Dev Ticket:</span></strong> SAFS-18672<br/><strong><span class="wysiwyg-font-size-large">Resolved In:</span></strong> SPAA build			9.0.0.929<br/><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 000002662<br/></p></div>
</article></body></html>