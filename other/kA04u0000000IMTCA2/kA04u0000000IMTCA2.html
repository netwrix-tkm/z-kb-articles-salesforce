<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Troubleshoot Remote PowerShell ExchangePS ActiveSync</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000IMTCA2"/><meta name="Id" content="ka04u000000HclRAAS"/><meta name="LastPublishedDate" content="2022-02-01T18:18:29.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:06:09.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:18:29.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="6500"/><meta name="ArticleNumber" content="000006500"/><meta name="description" content="360008408371"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Summary:</span></strong> This is what needs to be done to troubleshoot ExchangePS ActiveSync Devices not returning all/properly.</p>
<p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> ExchangePS ActiveSync Devices is not returning any/all devices.</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> Please run this and see what it returns. The {CASServer} needs to be replaced with the same Client Access Server they are using in StealthAUDIT. When prompted for credentials, please put in the StealthAUDIT service account. <br/><br/>$JobCredential = get-credential <br/>$relaxed=New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck <br/>$sess=New-PSSession -ConnectionUri 'https://{CASserver}/powershell?serializationLevel=Full' -ConfigurationName 'Microsoft.Exchange' -AllowRedirection -Authentication Negotiate -Credential $JobCredential -SessionOption $relaxed <br/>Import-PSSession $sess <br/><br/>get-exchangeserver | where-object {$_.ServerRole -like '*Mailbox*'} | get-mailbox -resultsize unlimited | get-activesyncdevicestatistics | export-csv c:\ASStats.csv <br/><br/>Then run this: <br/><br/>get-exchangeserver | where-object {$_.ServerRole -like '*Mailbox*'} | get-mailbox -resultsize unlimited | get-activesyncdevice | export-csv c:\ASDevice.csv <br/><br/>and this: <br/><br/>get-exchangeserver | where-object {$_.ServerRole -like '*Mailbox*'} | get-mailbox -resultsize unlimited | get-mobiledevice | export-csv c:\MobileDevice.csv <br/><br/>After that, please run this to validate that we have all the exchange servers in the list. <br/><br/>get-exchangeserver | where-object {$_.ServerRole -like '*Mailbox*'} | export-csv c:\MBServers.csv <br/><br/>Please also grab the PowerShell logs which should be located here: C:\Program Files (x86)\STEALTHbits\StealthAUDIT\PrivateAssemblies <br/><br/>There may be many, so better to wipe out all the logs that are in there, run the StealthAUDIT job and collect those logs.</p>
<p> </p>
<p><strong><span class="wysiwyg-font-size-large">Product:</span></strong> StealthAUDIT<br/><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - ExchangePS<br/><strong><span class="wysiwyg-font-size-large">Versions:</span></strong> 7.0+<br/><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 000001407</p></div>
</article></body></html>