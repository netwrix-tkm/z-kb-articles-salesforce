<?xml version="1.0" encoding="UTF-8"?><html><head><meta charset="utf-8"/><title>Powershell, ExchangePS, or Exchange2k DC return success but no data</title><meta name="label" content="employees_v"/><meta name="label" content="skb"/><meta name="KnowledgeArticleId" content="kA04u0000000IQeCAM"/><meta name="Id" content="ka04u000000Hcn0AAC"/><meta name="LastPublishedDate" content="2022-02-01T18:20:19.000+0000"/><meta name="LastModifiedDate" content="2023-05-08T10:06:54.000+0000"/><meta name="FirstPublishedDate" content="2022-02-01T18:20:19.000+0000"/><meta name="Language" content="en_US"/><meta name="UrlName" content="6549"/><meta name="ArticleNumber" content="000006549"/><meta name="description" content="360008408371"/></head><body><article class=" kb-articles"><div class="Content__c"><p><strong><span class="wysiwyg-font-size-large">Issue:</span></strong> When running a job or query that is utilizing powershell, on occasion you will get a success but no data is returned.</p>
<p><strong><span class="wysiwyg-font-size-large">Instructions:</span></strong> First thing to try, is to validate in Powershell that the powershell command that is being run returns data outside of StealthAUDIT.  For the data collectors, you can find the powershell command in the job log if StealthAUDIT is set to debug.<br/>If the command returns data in native powershell, ensure that the proper host is set on the job and set a connection profile.<br/>Aside from the job log, you can also look in the powershell logs located on the host being run against.<br/><br/><span><span><strong>Exchange2k\ExchangePS logs(SA Console):</strong> %sainstalldir%\PrivateAssemblies\GUID </span></span><br/><span><span><strong>Powershell Logs (SA Console):</strong> %sainstalldir%\Jobs\SA_CommonData\PowerShell</span></span><br/><span><span><strong>Powershell logs(Remote Host):</strong> C:\Program Files(x86)\STEALTHbits\StealthAUDIT\Applet\Powershell\GUID<br/><br/>For Exchange PS all PowerShell Queries are located here: \\sbitsinc.com\public\Documentation\StealthAUDIT\z_V7.2_specific\Word\ExchangePS Data Collector Actual Powershell Commands.docx<br/>Also see, \\sbitsinc.com\public\Documentation\StealthAUDIT\z_V7.2_specific\Word\STEALTHbits_SMP_DC_ExchangePS_Guide.pdf</span></span><br/><br/><br/>Additional Comments:<br/><br/>If the PowerShell command is being executed remotely and the customer has 6.1+ installed, check to see if .NET 3.5 is installed on the remote host.  SA 6.1 requires .NET 3.5 be installed on the remote host in order to work because of the upgrade for Visual Studio 2010.  SA 6.0 or older does not have this requirement.<br/><br/>If the PowerShell command is being executed remotely and the customer has 7.1+ installed, check to see if .NET 4.5 is installed on the remote host.  SA 7.1 requires .NET 4.5 to be installed on the remote host in order to work.  </p>
<p>If the customer will not install .NET 3.5 on the remote host, try to find a way to run the PowerShell command against the SA Host or another way to gather the data (i.e. ExchangePS - Mailboxes - use Mailbox DC instead which uses MAPI instead of PowerShell )<br/><br/>Exchange 2007 by default does not come with .NET 3.5 (required by 6.1 through 7.0)<br/>Exchange 2010 by default does not come with .NET 4.5 (Required by 7.1 through ....)</p>
<p> </p>
<p><strong><span class="wysiwyg-font-size-large">Module:</span></strong> SA - DC - Exchange2k;SA - DC - ExchangePS;SA - DC - PowerShell<br/><strong><span class="wysiwyg-font-size-large">Salesforce Article ID:</span></strong> 000001088</p></div>
</article></body></html>