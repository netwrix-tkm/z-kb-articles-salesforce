<?xml version="1.0" encoding="UTF-8"?>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Basic SQL Syntax Recommendations</title>
    <meta name="label" content="employees_v" />
    <meta name="label" content="skb" />
    <meta name="KnowledgeArticleId" content="kA04u0000000IcvCAE" />
    <meta name="Id" content="ka04u000000HcrkAAC" />
    <meta name="LastPublishedDate" content="2022-02-01T18:38:00.000+0000" />
    <meta name="LastModifiedDate" content="2023-05-08T10:09:02.000+0000" />
    <meta name="FirstPublishedDate" content="2022-02-01T18:38:00.000+0000" />
    <meta name="Language" content="en_US" />
    <meta name="UrlName" content="7273" />
    <meta name="ArticleNumber" content="000007273" />
    <meta name="description" content="360008408371" />
  </head>
  <body>
    <article class="kb-articles">
      <div class="Content__c">
        <p>
          <strong><span class="wysiwyg-font-size-large">Summary:</span></strong> Basic SQL syntax
          including a conditional table drop
        </p>
        <p>
          <strong><span class="wysiwyg-font-size-large">Issue:</span></strong> if you do a select
          into, it creates the table for you, based on what the resultant data types are.  <br />if
          you're clearing the table every time, that's the easiest way.  <br /><br />the
          alternative.  <br />a insert into x select... will require the destination table to
          already exist, and is how you would insert rows into a table you don't want to drop every
          time.  
        </p>
        <p>
          <strong><span class="wysiwyg-font-size-large">Instructions:</span></strong>
          <br /><br /><strong>SELECT INTO WITH DROP</strong><br />This will clear the destination
          table each time.  <br /><br />if object_id('mytablename','table') is not null<br />drop
          table mytablename<br /><br />select <br /><br />column1, <br />column2<br /><br />into
          mytablename<br />from sourcetablename<br /><br /><strong>INSERT INTO SELECT</strong
          ><br />This will insert rows into the same table each time, without clearing.  <br /><br />if
          object_id('mytablename','table') is null<br />CREATE TABLE mytablename<br />(<br />    [HOST]
          [varchar] (64),<br />    [Stuff] [smallint] NULL,<br />    [Things] [smallint] NULL,<br />    <br />) <br /><br />insert
          into mytablename<br />select <br /><br />column1, <br />column2<br /><br />from
          sourcetablename<br /> 
        </p>
        <p>
          <strong><span class="wysiwyg-font-size-large">Product:</span></strong>
          StealthAUDIT<br /><strong><span class="wysiwyg-font-size-large">Module:</span></strong>
          Database/SQL;SA - Analysis Module - SQLScripting<br /><strong
            ><span class="wysiwyg-font-size-large">Legacy Article ID:</span></strong
          >
          1517
        </p>
      </div>
    </article>
  </body>
</html>
